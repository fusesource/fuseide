<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Quartz2 Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="Quartz-QuartzComponent.html" title="Quartz Component"><link rel="next" href="RabbitMQ-RabbitMQComponent.html" title="RabbitMQ Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="Quartz2-Quartz2Component"></a>Quartz2 Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-URIformat">URI format</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-Options">Options</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-Configuringquartz.propertiesfile">Configuring quartz.properties file</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-EnablingQuartzschedulerinJMX">Enabling Quartz scheduler in JMX</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-StartingtheQuartzscheduler">Starting the Quartz scheduler</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-Clustering">Clustering</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-MessageHeaders">Message Headers</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-UsingCronTriggers">Using Cron Triggers</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-Specifyingtimezone">Specifying time zone</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-UsingQuartzScheduledPollConsumerScheduler">Using QuartzScheduledPollConsumerScheduler</a></span></dt><dt><span class="section"><a href="Quartz2-Quartz2Component.html#Quartz2-SeeAlso">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.12.0</strong></span></p><p>The <span class="strong"><strong>quartz2:</strong></span> component provides a scheduled delivery of messages using
the <a class="link" href="http://www.quartz-scheduler.org/" target="_top">Quartz Scheduler 2.x</a>. 
 Each endpoint represents a different timer (in Quartz terms, a Trigger
and JobDetail).</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-quartz2<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p><span class="strong"><strong>NOTE:</strong></span> Quartz 2.x API is not compatible with Quartz 1.x. If you need to
remain on old Quartz 1.x, please
 use the old <a class="link" href="quartz.html" target="_top">Quartz</a> component instead.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">quartz2:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//timerName?options</em>
quartz2:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//groupName/timerName?options</em>
quartz2:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//groupName/timerName?cron=expression</em>
quartz2:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//timerName?cron=expression</em></pre><p>The component uses either a <code class="literal">CronTrigger</code> or a <code class="literal">SimpleTrigger</code>. If no
cron expression is provided, the component uses a simple trigger. If no
<code class="literal">groupName</code> is provided, the quartz component uses the <code class="literal">Camel</code> group
name.</p><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-Options"></a>Options</h2></div></div></div><p>The Quartz2 component supports 9 options which are listed below.</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="11%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>autoStartScheduler</p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether or not the scheduler should be auto started. This options is default true</p></td></tr><tr><td align="left" valign="top"><p>startDelayedSeconds</p></td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>Seconds to wait before starting the quartz scheduler.</p></td></tr><tr><td align="left" valign="top"><p>prefixJobNameWithEndpointId</p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to prefix the quartz job with the endpoint id. This option is default false.</p></td></tr><tr><td align="left" valign="top"><p>enableJmx</p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to enable Quartz JMX which allows to manage the Quartz scheduler from JMX. This options is default true</p></td></tr><tr><td align="left" valign="top"><p>properties</p></td><td align="left" valign="top"><p><code class="literal">Properties</code></p></td><td align="left" valign="top"><p>Properties to configure the Quartz scheduler.</p></td></tr><tr><td align="left" valign="top"><p>propertiesFile</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>File name of the properties to load from the classpath</p></td></tr><tr><td align="left" valign="top"><p>prefixInstanceName</p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to prefix the Quartz Scheduler instance name with the CamelContext name. This is enabled by default to let each CamelContext use its own Quartz scheduler instance by default. You can set this option to false to reuse Quartz scheduler instances between multiple CamelContext&#8217;s.</p></td></tr><tr><td align="left" valign="top"><p>schedulerFactory</p></td><td align="left" valign="top"><p><code class="literal">SchedulerFactory</code></p></td><td align="left" valign="top"><p>To use the custom SchedulerFactory which is used to create the Scheduler.</p></td></tr><tr><td align="left" valign="top"><p>scheduler</p></td><td align="left" valign="top"><p><code class="literal">Scheduler</code></p></td><td align="left" valign="top"><p>To use the custom configured Quartz scheduler instead of creating a new Scheduler.</p></td></tr></tbody></table></div><p>{% endraw %}</p><p>The Quartz2 component supports 21 endpoint options which are listed below:</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="10%" class="col_2"><col width="11%" class="col_3"><col width="10%" class="col_4"><col width="50%" class="col_5"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Group</th><th align="left" valign="top">Default</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>groupName</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">Camel</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The quartz group name to use. The combination of group name and timer name should be unique.</p></td></tr><tr><td align="left" valign="top"><p>triggerName</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The quartz timer name to use. The combination of group name and timer name should be unique.</p></td></tr><tr><td align="left" valign="top"><p>bridgeErrorHandler</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler which mean any exceptions occurred while the consumer is trying to pickup incoming messages or the likes will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions that will be logged at WARN/ERROR level and ignored.</p></td></tr><tr><td align="left" valign="top"><p>cron</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Specifies a cron expression to define when to trigger.</p></td></tr><tr><td align="left" valign="top"><p>deleteJob</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If set to true then the trigger automatically delete when route stop. Else if set to false it will remain in scheduler. When set to false it will also mean user may reuse pre-configured trigger with camel Uri. Just ensure the names match. Notice you cannot have both deleteJob and pauseJob set to true.</p></td></tr><tr><td align="left" valign="top"><p>durableJob</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether or not the job should remain stored after it is orphaned (no triggers point to it).</p></td></tr><tr><td align="left" valign="top"><p>pauseJob</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If set to true then the trigger automatically pauses when route stop. Else if set to false it will remain in scheduler. When set to false it will also mean user may reuse pre-configured trigger with camel Uri. Just ensure the names match. Notice you cannot have both deleteJob and pauseJob set to true.</p></td></tr><tr><td align="left" valign="top"><p>recoverableJob</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Instructs the scheduler whether or not the job should be re-executed if a 'recovery' or 'fail-over' situation is encountered.</p></td></tr><tr><td align="left" valign="top"><p>stateful</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Uses a Quartz PersistJobDataAfterExecution and DisallowConcurrentExecution instead of the default job.</p></td></tr><tr><td align="left" valign="top"><p>exceptionHandler</p></td><td align="left" valign="top"><p>consumer (advanced)</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">ExceptionHandler</code></p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions that will be logged at WARN/ERROR level and ignored.</p></td></tr><tr><td align="left" valign="top"><p>exchangePattern</p></td><td align="left" valign="top"><p>consumer (advanced)</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">ExchangePattern</code></p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td></tr><tr><td align="left" valign="top"><p>customCalendar</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">Calendar</code></p></td><td align="left" valign="top"><p>Specifies a custom calendar to avoid specific range of date</p></td></tr><tr><td align="left" valign="top"><p>jobParameters</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p>To configure additional options on the job.</p></td></tr><tr><td align="left" valign="top"><p>prefixJobNameWithEndpointId</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether the job name should be prefixed with endpoint id</p></td></tr><tr><td align="left" valign="top"><p>synchronous</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used or Camel is allowed to use asynchronous processing (if supported).</p></td></tr><tr><td align="left" valign="top"><p>triggerParameters</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p>To configure additional options on the trigger.</p></td></tr><tr><td align="left" valign="top"><p>usingFixedCamelContextName</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If it is true JobDataMap uses the CamelContext name directly to reference the CamelContext if it is false JobDataMap uses use the CamelContext management name which could be changed during the deploy time.</p></td></tr><tr><td align="left" valign="top"><p>autoStartScheduler</p></td><td align="left" valign="top"><p>scheduler</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether or not the scheduler should be auto started.</p></td></tr><tr><td align="left" valign="top"><p>fireNow</p></td><td align="left" valign="top"><p>scheduler</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If it is true will fire the trigger when the route is start when using SimpleTrigger.</p></td></tr><tr><td align="left" valign="top"><p>startDelayedSeconds</p></td><td align="left" valign="top"><p>scheduler</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>Seconds to wait before starting the quartz scheduler.</p></td></tr><tr><td align="left" valign="top"><p>triggerStartDelay</p></td><td align="left" valign="top"><p>scheduler</p></td><td align="left" valign="top"><p><code class="literal">500</code></p></td><td align="left" valign="top"><p><code class="literal">long</code></p></td><td align="left" valign="top"><p>In case of scheduler has already started we want the trigger start slightly after current time to ensure endpoint is fully started before the job kicks in.</p></td></tr></tbody></table></div><p>{% endraw %}</p><p>For example, the following routing rule will fire two timer events to
the <code class="literal">mock:results</code> endpoint:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"quartz2://myGroup/myTimerName?trigger.repeatInterval=2&amp;trigger.repeatCount=1"</em></strong>).routeId(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"myRoute"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p>When using <code class="literal">stateful=true</code>, the
<a class="link" href="http://quartz-scheduler.org/api/2.0.0/org/quartz/JobDataMap.html" target="_top">JobDataMap</a>
is re-persisted after every execution of the job, thus preserving state
for the next execution.</p><p>INFO: <span class="strong"><strong>Running in OSGi and having multiple bundles with quartz
routes</strong></span>
If you run in OSGi such as Apache ServiceMix, or Apache Karaf, and have
multiple bundles with Camel routes that start from
<a class="link" href="quartz2.html" target="_top">Quartz2</a> endpoints, then make sure if you assign an <code class="literal">id</code>
to the &lt;camelContext&gt; that this id is unique, as this is
required by the <code class="literal">QuartzScheduler</code> in the OSGi container. If you do not
set any <code class="literal">id</code> on &lt;camelContext&gt; then a unique id is auto assigned, and there is no problem.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-Configuringquartz.propertiesfile"></a>Configuring quartz.properties file</h2></div></div></div><p>By default Quartz will look for a <code class="literal">quartz.properties</code> file in the
<code class="literal">org/quartz</code> directory of the classpath. If you are using WAR
deployments this means just drop the quartz.properties in
<code class="literal">WEB-INF/classes/org/quartz</code>.</p><p>However the Camel <a class="link" href="quartz2.html" target="_top">Quartz2</a> component also allows you
to configure properties:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Default</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">properties</code></p></td><td align="left" valign="top"><p><code class="literal">null</code></p></td><td align="left" valign="top"><p><code class="literal">Properties</code></p></td><td align="left" valign="top"><p>You can configure a <code class="literal">java.util.Properties</code> instance.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">propertiesFile</code></p></td><td align="left" valign="top"><p><code class="literal">null</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>File name of the properties to load from the classpath</p></td></tr></tbody></table></div><p>To do this you can configure this in Spring XML as follows</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"quartz"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.quartz2.QuartzComponent"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"propertiesFile"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"com/mycompany/myquartz.properties"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-EnablingQuartzschedulerinJMX"></a>Enabling Quartz scheduler in JMX</h2></div></div></div><p>You need to configure the quartz scheduler properties to enable JMX.
 That is typically setting the option
<code class="literal">"org.quartz.scheduler.jmx.export"</code> to a <code class="literal">true</code> value in the
configuration file.</p><p>From Camel 2.13 onwards Camel will automatic set this option to true,
unless explicit disabled.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-StartingtheQuartzscheduler"></a>Starting the Quartz scheduler</h2></div></div></div><p>The <a class="link" href="quartz2.html" target="_top">Quartz2</a> component offers an option to let the
Quartz scheduler be started delayed, or not auto started at all.</p><p>This is an example:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"quartz2"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.quartz2.QuartzComponent"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"startDelayedSeconds"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"5"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-Clustering"></a>Clustering</h2></div></div></div><p>If you use Quartz in clustered mode, e.g. the <code class="literal">JobStore</code> is clustered.
Then the <a class="link" href="quartz2.html" target="_top">Quartz2</a> component will <span class="strong"><strong>not</strong></span> pause/remove
triggers when a node is being stopped/shutdown. This allows the trigger
to keep running on the other nodes in the cluster.</p><p><span class="strong"><strong>Note</strong></span>: When running in clustered node no checking is done to ensure
unique job name/group for endpoints.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-MessageHeaders"></a>Message Headers</h2></div></div></div><p>Camel adds the getters from the Quartz Execution Context as header
values. The following headers are added:
 <code class="literal">calendar</code>, <code class="literal">fireTime</code>, <code class="literal">jobDetail</code>, <code class="literal">jobInstance</code>, <code class="literal">jobRuntTime</code>,
<code class="literal">mergedJobDataMap</code>, <code class="literal">nextFireTime</code>, <code class="literal">previousFireTime</code>, <code class="literal">refireCount</code>,
<code class="literal">result</code>, <code class="literal">scheduledFireTime</code>, <code class="literal">scheduler</code>, <code class="literal">trigger</code>, <code class="literal">triggerName</code>,
<code class="literal">triggerGroup</code>.</p><p>The <code class="literal">fireTime</code> header contains the <code class="literal">java.util.Date</code> of when the exchange
was fired.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-UsingCronTriggers"></a>Using Cron Triggers</h2></div></div></div><p>Quartz supports
<a class="link" href="http://www.quartz-scheduler.org/documentation/quartz-2.x/tutorials/crontrigger" target="_top">Cron-like
expressions</a> for specifying timers in a handy format. You can use these
expressions in the <code class="literal">cron</code> URI parameter; though to preserve valid URI
encoding we allow + to be used instead of spaces.</p><p>For example, the following will fire a message every five minutes
starting at 12pm (noon) to 6pm on weekdays:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"quartz2://myGroup/myTimerName?cron=0+0/5+12-18+?+*+MON-FRI"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"activemq:Totally.Rocks"</em></strong>);</pre><p>which is equivalent to using the cron expression</p><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>/<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">5</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">12</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">18</span> ? * MON-FRI</pre><p>The following table shows the URI character encodings we use to preserve
valid URI syntax:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="50%" class="col_1"><col width="50%" class="col_2"></colgroup><thead><tr><th align="left" valign="top">URI Character</th><th align="left" valign="top">Cron character</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">+</code></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Space</em></span></p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-Specifyingtimezone"></a>Specifying time zone</h2></div></div></div><p>The Quartz Scheduler allows you to configure time zone per trigger. For
example to use a timezone of your country, then you can do as follows:</p><pre class="programlisting">quartz2:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//groupName/timerName?cron=0+0/5+12-18+?+*+MON-FRI&amp;trigger.timeZone=Europe/Stockholm</em></pre><p>The timeZone value is the values accepted by <code class="literal">java.util.TimeZone</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-UsingQuartzScheduledPollConsumerScheduler"></a>Using QuartzScheduledPollConsumerScheduler</h2></div></div></div><p>The <a class="link" href="quartz2.html" target="_top">Quartz2</a> component provides a
<a class="link" href="polling-consumer.html" target="_top">Polling Consumer</a> scheduler which allows to
use cron based scheduling for <a class="link" href="polling-consumer.html" target="_top">Polling
Consumer</a> such as the <a class="link" href="file2.html" target="_top">File</a> and <a class="link" href="ftp2.html" target="_top">FTP</a>
consumers.</p><p>For example to use a cron based expression to poll for files every 2nd
second, then a Camel route can be define simply as:</p><pre class="programlisting">    from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:inbox?scheduler=quartz2&amp;scheduler.cron=0/2+*+*+*+*+?"</em></strong>)
       .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"bean:process"</em></strong>);</pre><p>Notice we define the <code class="literal">scheduler=quartz2</code> to instruct Camel to use the
<a class="link" href="quartz2.html" target="_top">Quartz2</a> based scheduler. Then we use <code class="literal">scheduler.xxx</code>
options to configure the scheduler. The <a class="link" href="quartz2.html" target="_top">Quartz2</a>
scheduler requires the cron option to be set.</p><p>The following options is supported:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="10%" class="col_3"><col width="70%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Default</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">quartzScheduler</code></p></td><td align="left" valign="top"><p><code class="literal">null</code></p></td><td align="left" valign="top"><p><code class="literal">org.quartz.Scheduler</code></p></td><td align="left" valign="top"><p>To use a custom Quartz scheduler. If none configure then the shared
scheduler from the <a class="link" href="quartz2.html" target="_top">Quartz2</a> component is used.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cron</code></p></td><td align="left" valign="top"><p><code class="literal">null</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Mandatory</strong></span>: To define the cron expression for triggering the polls.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">triggerId</code></p></td><td align="left" valign="top"><p><code class="literal">null</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>To specify the trigger id. If none provided then an UUID is generated
and used.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">triggerGroup</code></p></td><td align="left" valign="top"><p><code class="literal">QuartzScheduledPollConsumerScheduler</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>To specify the trigger group.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeZone</code></p></td><td align="left" valign="top"><p><code class="literal">Default</code></p></td><td align="left" valign="top"><p><code class="literal">TimeZone</code></p></td><td align="left" valign="top"><p>The time zone to use for the CRON trigger.</p></td></tr></tbody></table></div><p><span class="strong"><strong>Important:</strong></span> Remember configuring these options from the endpoint
<a class="link" href="uris.html" target="_top">URIs</a> must be prefixed with <code class="literal">scheduler.</code>.
For example to configure the trigger id and group:</p><pre class="programlisting">    from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:inbox?scheduler=quartz2&amp;scheduler.cron=0/2+*+*+*+*+?&amp;scheduler.triggerId=myId&amp;scheduler.triggerGroup=myGroup"</em></strong>)
       .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"bean:process"</em></strong>);</pre><p>There is also a CRON scheduler in <a class="link" href="spring.html" target="_top">Spring</a>, so you can
use the following as well:</p><pre class="programlisting">    from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:inbox?scheduler=spring&amp;scheduler.cron=0/2+*+*+*+*+?"</em></strong>)
       .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"bean:process"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quartz2-SeeAlso"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="configuring-camel.html" target="_top">Configuring Camel</a></li><li class="listitem"><a class="link" href="component.html" target="_top">Component</a></li><li class="listitem"><a class="link" href="endpoint.html" target="_top">Endpoint</a></li><li class="listitem"><a class="link" href="getting-started.html" target="_top">Getting Started</a></li><li class="listitem"><a class="link" href="quartz.html" target="_top">Quartz</a></li><li class="listitem"><a class="link" href="timer.html" target="_top">Timer</a></li></ul></div></div></div></body></html>
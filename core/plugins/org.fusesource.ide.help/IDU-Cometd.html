<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Cometd</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="CM-SMS-Options.html" title="Options"><link rel="next" href="IDU-Consul.html" title="Consul"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-Cometd"></a>Cometd</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_CometdComponent"></a>Cometd Component</h2></div></div></div><p>The <span class="bold"><strong>cometd:</strong></span> component is a transport for working with
            the <a class="link" href="http://www.mortbay.org/jetty" target="_top">jetty</a> implementation of the
                <a class="link" href="http://docs.codehaus.org/display/JETTY/Cometd+%28aka+Bayeux%29" target="_top">cometd/bayeux protocol</a>. Using this component in combination with the dojo
            toolkit library it's possible to push Apache Camel messages directly into the browser using
            an AJAX based mechanism.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">cometd://host:port/channelName[?options]</pre><p>The <span class="bold"><strong>channelName</strong></span> represents a topic that can be
            subscribed to by the Apache Camel endpoints.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_Examples"></a>Examples</h2></div></div></div><pre class="programlisting">cometd://localhost:8080/service/mychannel
cometds://localhost:8443/service/mychannel</pre><p>where <code class="literal">cometds:</code> represents an SSL configured endpoint.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_Options"></a>Options</h2></div></div></div><table id="d0e64547"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">resourceBase</code>
        </td>
        <td></td>
        <td> The root directory for the web resources or classpath. Use the protocol file: or classpath: depending if you want that the component loads the resource from file system or classpath. Classpath is required for OSGI deployment where the resources are packaged in the jar </td>
      </tr><tr>
        <td><code class="literal">baseResource</code>
        </td>
        <td></td>
        <td><span class="bold"><strong>Camel 2.7:</strong></span> The root directory for the web resources or classpath. Use the protocol file: or classpath: depending if you want that the component loads the resource from file system or classpath. Classpath is required for OSGI deployment where the resources are packaged in the jar </td>
      </tr><tr>
        <td><code class="literal">timeout</code>
        </td>
        <td><code class="literal">240000</code>
        </td>
        <td> The server side poll timeout in milliseconds. This is how long the server will
                    hold a reconnect request before responding. </td>
      </tr><tr>
        <td><code class="literal">interval</code>
        </td>
        <td><code class="literal">0</code>
        </td>
        <td> The client side poll timeout in milliseconds. How long a client will wait
                    between reconnects</td>
      </tr><tr>
        <td><code class="literal">maxInterval</code>
        </td>
        <td><code class="literal">30000</code>
        </td>
        <td> The max client side poll timeout in milliseconds. A client will be removed if a
                    connection is not received in this time. </td>
      </tr><tr>
        <td><code class="literal">multiFrameInterval</code>
        </td>
        <td><code class="literal">1500</code>
        </td>
        <td> The client side poll timeout, if multiple connections are detected from the
                    same browser. </td>
      </tr><tr>
        <td><code class="literal">jsonCommented</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td> If <code class="literal">true</code>, the server will accept JSON wrapped in a comment
                    and will generate JSON wrapped in a comment. This is a defence against Ajax
                    Hijacking. </td>
      </tr><tr>
        <td><code class="literal">logLevel</code>
        </td>
        <td><code class="literal">1</code>
        </td>
        <td><code class="literal">0</code>=none, <code class="literal">1</code>=info,
                    <code class="literal">2</code>=debug. </td>
      </tr><tr>
        <td>
                    <code class="code">sslContextParameters</code>
                </td>
        <td></td>
          <td><span class="bold"><strong>Camel 2.9:</strong></span> Reference to a <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.&nbsp;This reference overrides any configured SSLContextParameters at the component level.&nbsp;See <a href="IDU-HTTP.html#IDU-HTTP_HSH_UsingtheJSSEConfigurationUtility" class="olink">Using the JSSE Configuration Utility</a>. </td>
      </tr><tr>
        <td><code class="literal">crossOriginFilterOn</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.10:</strong></span> If <code class="literal">true</code>, the server will support for cross-domain filtering </td>
      </tr><tr>
        <td><code class="literal">allowedOrigins</code>
        </td>
        <td><code class="literal">*</code>
        </td>
        <td><span class="bold"><strong>Camel 2.10:</strong></span> The origins domain that support to cross, if the <code class="literal">crosssOriginFilterOn</code> is <code class="literal">true</code>
        </td>
      </tr><tr>
        <td><code class="literal">filterPath</code>
        </td>
        <td></td>
        <td><span class="bold"><strong>Camel 2.10:</strong></span> The filterPath will be used by the CrossOriginFilter, if the <code class="literal">crosssOriginFilterOn</code> is <code class="literal">true</code>
        </td>
      </tr><tr>
        <td><code class="literal">disconnectLocalSession</code>
        </td>
        <td><code class="literal">false</code>
                </td>
        <td><span class="bold"><strong>Camel 2.10.5/2.11.1: (Producer only)</strong></span>: Whether to disconnect local sessions after publishing a message to its channel. Disconnecting local session is needed as they are not swept by default by CometD, and therefore you can run out of memory.</td>
      </tr></table><p>You can append query options to the URI in the following format,
                <code class="literal">?option=value&amp;option=value&amp;...</code>
    </p><p>Here is some examples of how to pass the parameters.</p><p>For file (when the Webapp resources are located in the Web Application directory) <code class="code">cometd://localhost:8080?resourceBase=file./webapp</code>.
For classpath (when the web resources are packaged inside the Webapp folder) <code class="code">cometd://localhost:8080?resourceBase=classpath:webapp</code>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_Authentication"></a>Authentication</h2></div></div></div><p><span class="bold"><strong>Available as of Camel 2.8</strong></span>
    </p><p>You can configure custom <code class="literal">SecurityPolicy</code> and
        <code class="literal">Extension</code>'s to the <code class="literal">CometdComponent</code> which allows you to
      use authentication as <a class="link" href="http://cometd.org/documentation/howtos/authentication" target="_top">documented here</a>
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_SettingupSSLforCometdComponent"></a>Setting up SSL for Cometd Component</h2></div></div></div><p></p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_UsingtheJSSEConfigurationUtility"></a>Using the JSSE Configuration Utility</h2></div></div></div><p>As of Camel 2.9, the Cometd component supports SSL/TLS configuration through the <a href="IDU-HTTP.html#IDU-HTTP_HSH_UsingtheJSSEConfigurationUtility" class="olink">Camel JSSE Configuration Utility</a>. This utility greatly decreases the
      amount of component specific code you need to write and is configurable at the endpoint and
      component levels. The following examples demonstrate how to use the utility with the Cometd
      component. You need to configure SSL on the <code class="code">CometdComponent</code> class.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_Programmaticconfigurationofthecomponent"></a>Programmatic configuration of the component</h2></div></div></div><p></p><pre class="programlisting">
KeyStoreParameters ksp = new KeyStoreParameters();
ksp.setResource("/users/home/server/keystore.jks");
ksp.setPassword("keystorePassword");

KeyManagersParameters kmp = new KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword("keyPassword");

TrustManagersParameters tmp = new TrustManagersParameters();
tmp.setKeyStore(ksp);

SSLContextParameters scp = new SSLContextParameters();
scp.setKeyManagers(kmp);
scp.setTrustManagers(tmp);

CometdComponent commetdComponent = getContext().getComponent("cometds", CometdComponent.class);
commetdComponent.setSslContextParameters(scp);
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Cometd_HSH_SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</h2></div></div></div><p></p><pre class="programlisting">
...
  &lt;camel:sslContextParameters
      id="sslContextParameters"&gt;
    &lt;camel:keyManagers
        keyPassword="keyPassword"&gt;
      &lt;camel:keyStore
          resource="/users/home/server/keystore.jks"
          password="keystorePassword"/&gt;
    &lt;/camel:keyManagers&gt;
    &lt;camel:trustManagers&gt;
      &lt;camel:keyStore
          resource="/users/home/server/keystore.jks"
          password="keystorePassword"/&gt;
    &lt;/camel:keyManagers&gt;
  &lt;/camel:sslContextParameters&gt;

  &lt;bean id="cometd" class="org. apache. camel. component.cometd.CometdComponent"&gt;
    &lt;property name="sslContextParameters" ref="sslContextParameters"/&gt;
  &lt;/bean&gt;
  ...
  &lt;to uri="cometds://127.0.0.1:443/service/test?baseResource=file:./target/test-classes/webapp&amp;timeout=240000&amp;interval=0&amp;maxInterval=30000&amp;multiFrameInterval=1500&amp;jsonCommented=true&amp;logLevel=2&amp;sslContextParameters=#sslContextParameters"/&gt;...
</pre></div></div></body></html>
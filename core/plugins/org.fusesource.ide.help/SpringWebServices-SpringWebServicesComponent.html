<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Spring Web Services Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="SpringSecurity-SpringSecurity.html" title="Spring Security Component"><link rel="next" href="SQLComponent-SQLComponent.html" title="SQL Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="SpringWebServices-SpringWebServicesComponent"></a>Spring Web Services Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-URIformat">URI format</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Options">Options</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Messageheaders">Message headers</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Accessingwebservices">Accessing web services</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Exposingwebservices">Exposing web services</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-POJO-unmarshalling">POJO (un)marshalling</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-SeeAlso">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.6</strong></span></p><p>The <span class="strong"><strong>spring-ws:</strong></span> component allows you to integrate with
<a class="link" href="http://static.springsource.org/spring-ws/sites/1.5/" target="_top">Spring Web
Services</a>. It offers both <span class="emphasis"><em>client</em></span>-side support, for accessing web
services, and <span class="emphasis"><em>server</em></span>-side support for creating your own contract-first
web services.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-spring-ws<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p>INFO:*Dependencies*
As of Camel 2.8 this component ships with Spring-WS 2.0.x which (like
the rest of Camel) requires Spring 3.0.x.
Earlier Camel versions shipped Spring-WS 1.5.9 which is compatible with
Spring 2.5.x and 3.0.x. In order to run earlier versions of
<code class="literal">camel-spring-ws</code> on Spring 2.5.x you need to add the <code class="literal">spring-webmvc</code>
module from Spring 2.5.x. In order to run Spring-WS 1.5.9 on Spring
3.0.x you need to exclude the OXM module from Spring 3.0.x as this
module is also included in Spring-WS 1.5.9 (see
<a class="link" href="http://stackoverflow.com/questions/3313314/can-spring-ws-1-5-be-used-with-spring-3" target="_top">this
post</a>)</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-URIformat"></a>URI format</h2></div></div></div><p>The URI scheme for this component is as follows</p><pre class="programlisting">spring-ws:[mapping-type:]address[?options]</pre><p>To expose a web service <span class="strong"><strong>mapping-type</strong></span> needs to be set to any of the
following:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="90%" class="col_2"></colgroup><thead><tr><th align="left" valign="top">Mapping type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">rootqname</code></p></td><td align="left" valign="top"><p>Offers the option to map web service requests based on the qualified
name of the root element contained in the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">soapaction</code></p></td><td align="left" valign="top"><p>Used to map web service requests based on the SOAP action specified in
the header of the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>In order to map web service requests that target a specific URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">xpathresult</code></p></td><td align="left" valign="top"><p>Used to map web service requests based on the evaluation of an XPath
<code class="literal">expression</code> against the incoming message. The result of the evaluation
should match the XPath result specified in the endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">beanname</code></p></td><td align="left" valign="top"><p>Allows you to reference an
<code class="literal">org.apache.camel.component.spring.ws.bean.CamelEndpointDispatcher</code>
object in order to integrate with existing (legacy)
<a class="link" href="http://static.springsource.org/spring-ws/sites/1.5/reference/html/server.html#server-endpoint-mapping" target="_top">endpoint
mappings</a> like <code class="literal">PayloadRootQNameEndpointMapping</code>,
<code class="literal">SoapActionEndpointMapping</code>, etc</p></td></tr></tbody></table></div><p>As a consumer the <span class="strong"><strong>address</strong></span> should contain a value relevant to the
specified mapping-type (e.g. a SOAP action, XPath expression). As a
producer the address should be set to the URI of the web service your
calling upon.</p><p>You can append query <span class="strong"><strong>options</strong></span> to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-Options"></a>Options</h2></div></div></div><p>The Spring WebService component has no options.</p><p>The Spring WebService component supports 25 endpoint options which are listed below:</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="10%" class="col_2"><col width="11%" class="col_3"><col width="10%" class="col_4"><col width="50%" class="col_5"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Group</th><th align="left" valign="top">Default</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>type</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">EndpointMappingType</code></p></td><td align="left" valign="top"><p>Endpoint mapping type if endpoint mapping is used. rootqname - Offers the option to map web service requests based on the qualified name of the root element contained in the message. soapaction - Used to map web service requests based on the SOAP action specified in the header of the message. uri - In order to map web service requests that target a specific URI. xpathresult - Used to map web service requests based on the evaluation of an XPath expression against the incoming message. The result of the evaluation should match the XPath result specified in the endpoint URI. beanname - Allows you to reference an org.apache.camel.component.spring.ws.bean.CamelEndpointDispatcher object in order to integrate with existing (legacy) endpoint mappings like PayloadRootQNameEndpointMapping SoapActionEndpointMapping etc</p></td></tr><tr><td align="left" valign="top"><p>lookupKey</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Endpoint mapping key if endpoint mapping is used</p></td></tr><tr><td align="left" valign="top"><p>webServiceEndpointUri</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The default Web Service endpoint uri to use for the producer.</p></td></tr><tr><td align="left" valign="top"><p>messageFilter</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">MessageFilter</code></p></td><td align="left" valign="top"><p>Option to provide a custom MessageFilter. For example when you want to process your headers or attachments by your own.</p></td></tr><tr><td align="left" valign="top"><p>bridgeErrorHandler</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler which mean any exceptions occurred while the consumer is trying to pickup incoming messages or the likes will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions that will be logged at WARN/ERROR level and ignored.</p></td></tr><tr><td align="left" valign="top"><p>endpointDispatcher</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">CamelEndpointDispatcher</code></p></td><td align="left" valign="top"><p>Spring org.springframework.ws.server.endpoint.MessageEndpoint for dispatching messages received by Spring-WS to a Camel endpoint to integrate with existing (legacy) endpoint mappings like PayloadRootQNameEndpointMapping SoapActionEndpointMapping etc.</p></td></tr><tr><td align="left" valign="top"><p>endpointMapping</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">CamelSpringWSEndpointMapping</code></p></td><td align="left" valign="top"><p>Reference to an instance of org.apache.camel.component.spring.ws.bean.CamelEndpointMapping in the Registry/ApplicationContext. Only one bean is required in the registry to serve all Camel/Spring-WS endpoints. This bean is auto-discovered by the MessageDispatcher and used to map requests to Camel endpoints based on characteristics specified on the endpoint (like root QName SOAP action etc)</p></td></tr><tr><td align="left" valign="top"><p>expression</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The XPath expression to use when option type=xpathresult. Then this option is required to be configured.</p></td></tr><tr><td align="left" valign="top"><p>sslContextParameters</p></td><td align="left" valign="top"><p>consumer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">SSLContextParameters</code></p></td><td align="left" valign="top"><p>To configure security using SSLContextParameters</p></td></tr><tr><td align="left" valign="top"><p>exceptionHandler</p></td><td align="left" valign="top"><p>consumer (advanced)</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">ExceptionHandler</code></p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions that will be logged at WARN/ERROR level and ignored.</p></td></tr><tr><td align="left" valign="top"><p>exchangePattern</p></td><td align="left" valign="top"><p>consumer (advanced)</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">ExchangePattern</code></p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td></tr><tr><td align="left" valign="top"><p>allowResponseAttachmentOverride</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Option to override soap response attachments in in/out exchange with attachments from the actual service layer. If the invoked service appends or rewrites the soap attachments this option when set to true allows the modified soap attachments to be overwritten in in/out message attachments</p></td></tr><tr><td align="left" valign="top"><p>allowResponseHeaderOverride</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Option to override soap response header in in/out exchange with header info from the actual service layer. If the invoked service appends or rewrites the soap header this option when set to true allows the modified soap header to be overwritten in in/out message headers</p></td></tr><tr><td align="left" valign="top"><p>faultAction</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p>Signifies the value for the faultAction response WS-Addressing Fault Action header that is provided by the method.</p></td></tr><tr><td align="left" valign="top"><p>faultTo</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p>Signifies the value for the faultAction response WS-Addressing FaultTo header that is provided by the method.</p></td></tr><tr><td align="left" valign="top"><p>messageFactory</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">WebServiceMessageFactory</code></p></td><td align="left" valign="top"><p>Option to provide a custom WebServiceMessageFactory. For example when you want Apache Axiom to handle web service messages instead of SAAJ.</p></td></tr><tr><td align="left" valign="top"><p>messageIdStrategy</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">MessageIdStrategy</code></p></td><td align="left" valign="top"><p>Option to provide a custom MessageIdStrategy to control generation of unique message ids.</p></td></tr><tr><td align="left" valign="top"><p>messageSender</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">WebServiceMessageSender</code></p></td><td align="left" valign="top"><p>Option to provide a custom WebServiceMessageSender. For example to perform authentication or use alternative transports</p></td></tr><tr><td align="left" valign="top"><p>outputAction</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p>Signifies the value for the response WS-Addressing Action header that is provided by the method.</p></td></tr><tr><td align="left" valign="top"><p>replyTo</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p>Signifies the value for the replyTo response WS-Addressing ReplyTo header that is provided by the method.</p></td></tr><tr><td align="left" valign="top"><p>soapAction</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>SOAP action to include inside a SOAP request when accessing remote web services</p></td></tr><tr><td align="left" valign="top"><p>timeout</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>Sets the socket read timeout (in milliseconds) while invoking a webservice using the producer see URLConnection.setReadTimeout() and CommonsHttpMessageSender.setReadTimeout(). This option works when using the built-in message sender implementations: CommonsHttpMessageSender and HttpUrlConnectionMessageSender. One of these implementations will be used by default for HTTP based services unless you customize the Spring WS configuration options supplied to the component. If you are using a non-standard sender it is assumed that you will handle your own timeout configuration. The built-in message sender HttpComponentsMessageSender is considered instead of CommonsHttpMessageSender which has been deprecated see HttpComponentsMessageSender.setReadTimeout().</p></td></tr><tr><td align="left" valign="top"><p>webServiceTemplate</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">WebServiceTemplate</code></p></td><td align="left" valign="top"><p>Option to provide a custom WebServiceTemplate. This allows for full control over client-side web services handling; like adding a custom interceptor or specifying a fault resolver message sender or message factory.</p></td></tr><tr><td align="left" valign="top"><p>wsAddressingAction</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p>WS-Addressing 1.0 action header to include when accessing web services. The To header is set to the address of the web service as specified in the endpoint URI (default Spring-WS behavior).</p></td></tr><tr><td align="left" valign="top"><p>synchronous</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used or Camel is allowed to use asynchronous processing (if supported).</p></td></tr></tbody></table></div><p>{% endraw %}</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-Messageheaders"></a>Message headers</h2></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="10%" class="col_2"><col width="80%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelSpringWebserviceEndpointUri</code></p></td><td align="left" valign="top"><p>String</p></td><td align="left" valign="top"><p>URI of the web service your accessing as a client, overrides <span class="emphasis"><em>address</em></span>
part of the endpoint URI</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelSpringWebserviceSoapAction</code></p></td><td align="left" valign="top"><p>String</p></td><td align="left" valign="top"><p>Header to specify the SOAP action of the message, overrides <code class="literal">soapAction</code>
option if present</p></td></tr><tr><td align="left" valign="top"><p>CamelSpringWebserviceSoapHeader</p></td><td align="left" valign="top"><p>Source</p></td><td align="left" valign="top"><p><span class="strong"><strong>Camel 2.11.1:</strong></span> Use this header to specify/access the SOAP headers of
the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelSpringWebserviceAddressingAction</code></p></td><td align="left" valign="top"><p>URI</p></td><td align="left" valign="top"><p>Use this header to specify the WS-Addressing action of the message,
overrides <code class="literal">wsAddressingAction</code> option if present</p></td></tr><tr><td align="left" valign="top"><p>CamelSpringWebserviceAddressingFaultTo</p></td><td align="left" valign="top"><p>URI</p></td><td align="left" valign="top"><p>Use this header to specify the &nbsp;WS-Addressing FaultTo , overrides
faultTo option if present</p></td></tr><tr><td align="left" valign="top"><p>CamelSpringWebserviceAddressingReplyTo</p></td><td align="left" valign="top"><p>URI</p></td><td align="left" valign="top"><p>Use this header to specify the &nbsp;WS-Addressing ReplyTo , overrides
replyTo option if present</p></td></tr><tr><td align="left" valign="top"><p>CamelSpringWebserviceAddressingOutputAction</p></td><td align="left" valign="top"><p>URI</p></td><td align="left" valign="top"><p>Use this header to specify the WS-Addressing Action , overrides
outputAction option if present</p></td></tr><tr><td align="left" valign="top"><p>CamelSpringWebserviceAddressingFaultAction</p></td><td align="left" valign="top"><p>URI</p></td><td align="left" valign="top"><p>Use this header to specify the WS-Addressing Fault Action , overrides
faultAction option if present</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-Accessingwebservices"></a>Accessing web services</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-SendingSOAPandWS-Addressingactionheaders">Sending SOAP and WS-Addressing action headers</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-UsingSOAPheaders">Using SOAP headers</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Theheaderandattachmentpropagation">The header and attachment propagation</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-HowtouseMTOMattachments">How to use MTOM attachments</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Thecustomheaderandattachmentfiltering">The custom header and attachment filtering</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-UsingacustomMessageSenderandMessageFactory">Using a custom MessageSender and MessageFactory</a></span></dt></dl></div><p>To call a web service at <code class="literal"><a class="link" href="http://foo.com/bar" target="_top">http://foo.com/bar</a></code> simply define a route:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://foo.com/bar"</em></strong>)</pre><p>And sent a message:</p><pre class="programlisting">template.requestBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;foobar xmlns=\"http://foo.com\"&gt;&lt;msg&gt;test message&lt;/msg&gt;&lt;/foobar&gt;"</em></strong>);</pre><p>Remember if it&#8217;s a SOAP service you&#8217;re calling you don&#8217;t have to include
SOAP tags. Spring-WS will perform the XML-to-SOAP marshaling.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-SendingSOAPandWS-Addressingactionheaders"></a>Sending SOAP and WS-Addressing action headers</h3></div></div></div><p>When a remote web service requires a SOAP action or use of the
WS-Addressing standard you define your route as:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>)
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://foo.com/bar?soapAction=http://foo.com&amp;wsAddressingAction=http://bar.com"</em></strong>)</pre><p>Optionally you can override the endpoint options with header values:</p><pre class="programlisting">template.requestBodyAndHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>,
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;foobar xmlns=\"http://foo.com\"&gt;&lt;msg&gt;test message&lt;/msg&gt;&lt;/foobar&gt;"</em></strong>,
SpringWebserviceConstants.SPRING_WS_SOAP_ACTION, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://baz.com"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-UsingSOAPheaders"></a>Using SOAP headers</h3></div></div></div><p><span class="strong"><strong>Available as of Camel 2.11.1</strong></span></p><p>You can provide the SOAP header(s) as a Camel Message header when
sending a message to a spring-ws endpoint, for example given the
following SOAP header in a String</p><pre class="programlisting">String body = ...
String soapHeader = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;h:Header xmlns:h=\"http://www.webserviceX.NET/\"&gt;&lt;h:MessageID&gt;1234567890&lt;/h:MessageID&gt;&lt;h:Nested&gt;&lt;h:NestedID&gt;1111&lt;/h:NestedID&gt;&lt;/h:Nested&gt;&lt;/h:Header&gt;"</em></strong>;</pre><p>We can set the body and header on the Camel Message as follows:</p><pre class="programlisting">exchange.getIn().setBody(body);
exchange.getIn().setHeader(SpringWebserviceConstants.SPRING_WS_SOAP_HEADER, soapHeader);</pre><p>And then send the Exchange to a <code class="literal">spring-ws</code> endpoint to call the Web
Service.</p><p>Likewise the spring-ws consumer will also enrich the Camel Message with
the SOAP header.</p><p>For an example see this
<a class="link" href="https://svn.apache.org/repos/asf/camel/trunk/components/camel-spring-ws/src/test/java/org/apache/camel/component/spring/ws/SoapHeaderTest.java" target="_top">unit
test</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-Theheaderandattachmentpropagation"></a>The header and attachment propagation</h3></div></div></div><p>Spring WS Camel supports propagation of the headers and attachments into
Spring-WS WebServiceMessage response since version <span class="strong"><strong>2.10.3</strong></span>.&nbsp;The
endpoint will use so called "hook" the MessageFilter (default
implementation is provided by BasicMessageFilter) to propagate the
exchange headers and attachments into WebServiceMessage response.&nbsp;Now
you can use</p><pre class="programlisting">exchange.getOut().getHeaders().put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"myCustom"</em></strong>,<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"myHeaderValue"</em></strong>)
exchange.getIn().addAttachment(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"myAttachment"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DataHandler(...))</pre><p>Note: If the exchange header in the pipeline contains text, it generates
Qname(key)=value attribute in the soap header. Recommended is to create
a QName class directly and put into any key into header.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-HowtouseMTOMattachments"></a>How to use MTOM attachments</h3></div></div></div><p>The BasicMessageFilter provides all required information for Apache
Axiom in order to produce MTOM message. If you want to use Apache Camel
Spring WS within Apache Axiom, here is an example:
- Simply define the messageFactory as is bellow and Spring-WS will use
MTOM strategy to populate your SOAP message with optimized attachments.</p><pre class="programlisting">&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"axiomMessageFactory"</em></strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"org.springframework.ws.soap.axiom.AxiomSoapMessageFactory"</em></strong>&gt;
&lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"payloadCaching"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"false"</em></strong> /&gt;
&lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"attachmentCaching"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"true"</em></strong> /&gt;
&lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"attachmentCacheThreshold"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"1024"</em></strong> /&gt;
&lt;/bean&gt;</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Add into your pom.xml the following dependencies</li></ul></div><pre class="programlisting">&lt;dependency&gt;
&lt;groupId&gt;org.apache.ws.commons.axiom&lt;/groupId&gt;
&lt;artifactId&gt;axiom-api&lt;/artifactId&gt;
&lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1.2</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">13</span>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
&lt;groupId&gt;org.apache.ws.commons.axiom&lt;/groupId&gt;
&lt;artifactId&gt;axiom-impl&lt;/artifactId&gt;
&lt;version&gt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1.2</span>.<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">13</span>&lt;/version&gt;
&lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Add your attachment into the pipeline, for example using a Processor
implementation.</li></ul></div><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> Attachement <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">implements</strong> Processor {
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> process(Exchange exchange) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception
{ exchange.getOut().copyFrom(exchange.getIn()); File file = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> File(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"testAttachment.txt"</em></strong>); exchange.getOut().addAttachment(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"test"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DataHandler(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> FileDataSource(file)));  }
}</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Define endpoint (producer) as ussual, for example like this:</li></ul></div><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:send"</em></strong>)
.process(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Attachement())
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://localhost:8089/mySoapService?soapAction=mySoap&amp;messageFactory=axiomMessageFactory"</em></strong>);</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Now, your producer will generate MTOM message with otpmized
attachments.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-Thecustomheaderandattachmentfiltering"></a>The custom header and attachment filtering</h3></div></div></div><p>If you need to provide your custom processing of either headers or
attachments, extend existing BasicMessageFilter and override the
appropriate methods or write a brand new implementation of the
MessageFilter interface.
 To use your custom filter, add this into your spring context:</p><p>You can specify either a global a or a local message filter as
follows:
 a) the global custom filter that provides the global configuration for
all Spring-WS endpoints</p><pre class="programlisting">&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"messageFilter"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"your.domain.myMessageFiler"</em></strong> scope=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"singleton"</em></strong> /&gt;</pre><p>or
 b) the local messageFilter directly on the endpoint as follows:</p><pre class="programlisting">to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://yourdomain.com?messageFilter=#myEndpointSpecificMessageFilter"</em></strong>);</pre><p>For more information see
<a class="link" href="https://issues.apache.org/jira/browse/CAMEL-5724" target="_top">CAMEL-5724</a></p><p>If you want to create your own MessageFilter, consider overriding the
following methods in the default implementation of MessageFilter in
class BasicMessageFilter:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> doProcessSoapHeader(Message inOrOut, SoapMessage soapMessage)
{your code <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">/*no need to call super*/</em> }

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> doProcessSoapAttachements(Message inOrOut, SoapMessage response)
{ your code <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">/*no need to call super*/</em> }</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-UsingacustomMessageSenderandMessageFactory"></a>Using a custom MessageSender and MessageFactory</h3></div></div></div><p>A custom message sender or factory in the registry can be referenced
like this:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>)
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://foo.com/bar?messageFactory=#messageFactory&amp;messageSender=#messageSender"</em></strong>)</pre><p>Spring configuration:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- authenticate using HTTP Basic Authentication --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"messageSender"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.springframework.ws.transport.http.HttpComponentsMessageSender"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"credentials"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.commons.httpclient.UsernamePasswordCredentials"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">index</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"0"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"admin"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">index</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"secret"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/property&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>

<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- force use of Sun SAAJ implementation, http://static.springsource.org/spring-ws/sites/1.5/faq.html#saaj-jboss --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"messageFactory"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.springframework.ws.soap.saaj.SaajSoapMessageFactory"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"messageFactory"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"com.sun.xml.messaging.saaj.soap.ver1_1.SOAPMessageFactory1_1Impl"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/property&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-Exposingwebservices"></a>Exposing web services</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Endpointmappinginroutes">Endpoint mapping in routes</a></span></dt><dt><span class="section"><a href="SpringWebServices-SpringWebServicesComponent.html#SpringWebServices-Alternativeconfiguration">Alternative configuration, using existing endpoint mappings</a></span></dt></dl></div><p>In order to expose a web service using this component you first need to
set-up a
<a class="link" href="http://static.springsource.org/spring-ws/sites/1.5/reference/html/server.html" target="_top">MessageDispatcher</a>
to look for endpoint mappings in a Spring XML file. If you plan on
running inside a servlet container you probably want to use a
<code class="literal">MessageDispatcherServlet</code> configured in <code class="literal">web.xml</code>.</p><p>By default the <code class="literal">MessageDispatcherServlet</code> will look for a Spring XML
named <code class="literal">/WEB-INF/spring-ws-servlet.xml</code>. To use Camel with Spring-WS the
only mandatory bean in that XML file is <code class="literal">CamelEndpointMapping</code>. This
bean allows the <code class="literal">MessageDispatcher</code> to dispatch web service requests to
your routes.</p><p><span class="emphasis"><em>web.xml</em></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;web-app&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;servlet&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;servlet-name&gt;</strong>spring-ws<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/servlet-name&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;servlet-class&gt;</strong>org.springframework.ws.transport.http.MessageDispatcherServlet<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/servlet-class&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;load-on-startup&gt;</strong>1<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/load-on-startup&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/servlet&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;servlet-mapping&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;servlet-name&gt;</strong>spring-ws<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/servlet-name&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;url-pattern&gt;</strong>/*<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/url-pattern&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/servlet-mapping&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/web-app&gt;</strong></pre><p><span class="emphasis"><em>spring-ws-servlet.xml</em></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"endpointMapping"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.spring.ws.bean.CamelEndpointMapping"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"wsdl"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"schema"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.springframework.xml.xsd.SimpleXsdSchema"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xsd"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/WEB-INF/foobar.xsd"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/property&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"portTypeName"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"FooBar"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"locationUri"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"targetNamespace"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://example.com/"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre><p>More information on setting up Spring-WS can be found in
<a class="link" href="http://static.springsource.org/spring-ws/sites/1.5/reference/html/tutorial.html" target="_top">Writing
Contract-First Web Services</a>. Basically paragraph 3.6 "Implementing the
Endpoint" is handled by this component (specifically paragraph 3.6.2
"Routing the Message to the Endpoint" is where <code class="literal">CamelEndpointMapping</code>
comes in). Also don&#8217;t forget to check out the
<a class="link" href="spring-ws-example.html" target="_top">Spring Web Services Example</a> included in the
Camel distribution.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-Endpointmappinginroutes"></a>Endpoint mapping in routes</h3></div></div></div><p>With the XML configuration in-place you can now use Camel&#8217;s DSL to
define what web service requests are handled by your endpoint:</p><p>The following route will receive all web service requests that have a
root element named "GetFoo" within the <code class="literal"><a class="link" href="http://example.com/" target="_top">http://example.com/</a></code> namespace.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:rootqname:{http://example.com/}GetFoo?endpointMapping=#endpointMapping"</em></strong>)
.convertBodyTo(String.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>).to(mock:example)</pre><p>The following route will receive web service requests containing the
<code class="literal"><a class="link" href="http://example.com/GetFoo" target="_top">http://example.com/GetFoo</a></code> SOAP action.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:soapaction:http://example.com/GetFoo?endpointMapping=#endpointMapping"</em></strong>)
.convertBodyTo(String.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>).to(mock:example)</pre><p>The following route will receive all requests sent to
<code class="literal"><a class="link" href="http://example.com/foobar" target="_top">http://example.com/foobar</a></code>.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:uri:http://example.com/foobar?endpointMapping=#endpointMapping"</em></strong>)
.convertBodyTo(String.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>).to(mock:example)</pre><p>The route below will receive requests that contain the element
<code class="literal">&lt;foobar&gt;abc&lt;/foobar&gt;</code> anywhere inside the message (and the default
namespace).</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:xpathresult:abc?expression=//foobar&amp;endpointMapping=#endpointMapping"</em></strong>)
.convertBodyTo(String.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>).to(mock:example)</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="SpringWebServices-Alternativeconfiguration"></a>Alternative configuration, using existing endpoint mappings</h3></div></div></div><p>For every endpoint with mapping-type <code class="literal">beanname</code> one bean of type
<code class="literal">CamelEndpointDispatcher</code> with a corresponding name is required in the
Registry/ApplicationContext. This bean acts as a bridge between the
Camel endpoint and an existing
<a class="link" href="http://static.springsource.org/spring-ws/sites/1.5/reference/html/server.html#server-endpoint-mapping" target="_top">endpoint
mapping</a> like <code class="literal">PayloadRootQNameEndpointMapping</code>.</p><p>NOTE:The use of the <code class="literal">beanname</code> mapping-type is primarily meant for (legacy)
situations where you&#8217;re already using Spring-WS and have endpoint
mappings defined in a Spring XML file. The <code class="literal">beanname</code> mapping-type
allows you to wire your Camel route into an existing endpoint mapping.
When you&#8217;re starting from scratch it&#8217;s recommended to define your
endpoint mappings as Camel URI&#8217;s (as illustrated above with
<code class="literal">endpointMapping</code>) since it requires less configuration and is more
expressive. Alternatively you could use vanilla Spring-WS with the help
of annotations.</p><p>An example of a route using <code class="literal">beanname</code>:</p><pre class="programlisting">&lt;camelContext xmlns=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://camel.apache.org/schema/spring"</em></strong>&gt;
    &lt;route&gt;
        &lt;from uri=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:beanname:QuoteEndpointDispatcher"</em></strong> /&gt;
        &lt;to uri=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:example"</em></strong> /&gt;
    &lt;/route&gt;
&lt;/camelContext&gt;

&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"legacyEndpointMapping"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"org.springframework.ws.server.endpoint.mapping.PayloadRootQNameEndpointMapping"</em></strong>&gt;
    &lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mappings"</em></strong>&gt;
        &lt;props&gt;
            &lt;prop key=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{http://example.com/}GetFuture"</em></strong>&gt;FutureEndpointDispatcher&lt;/prop&gt;
            &lt;prop key=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"{http://example.com/}GetQuote"</em></strong>&gt;QuoteEndpointDispatcher&lt;/prop&gt;
        &lt;/props&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"QuoteEndpointDispatcher"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"org.apache.camel.component.spring.ws.bean.CamelEndpointDispatcher"</em></strong> /&gt;
&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"FutureEndpointDispatcher"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"org.apache.camel.component.spring.ws.bean.CamelEndpointDispatcher"</em></strong> /&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-POJO-unmarshalling"></a>POJO (un)marshalling</h2></div></div></div><p>Camel&#8217;s <a class="link" href="data-format.html" target="_top">pluggable data formats</a> offer support for
pojo/xml marshalling using libraries such as JAXB, XStream, JibX, Castor
and XMLBeans. You can use these data formats in your route to sent and
receive pojo&#8217;s, to and from web services.</p><p>When <span class="emphasis"><em>accessing</em></span> web services you can marshal the request and unmarshal
the response message:</p><pre class="programlisting">JaxbDataFormat jaxb = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> JaxbDataFormat(false);
jaxb.setContextPath(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"com.example.model"</em></strong>);

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:example"</em></strong>).marshal(jaxb).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:http://foo.com/bar"</em></strong>).unmarshal(jaxb);</pre><p>Similarly when <span class="emphasis"><em>providing</em></span> web services, you can unmarshal XML requests
to POJO&#8217;s and marshal the response message back to XML:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"spring-ws:rootqname:{http://example.com/}GetFoo?endpointMapping=#endpointMapping"</em></strong>).unmarshal(jaxb)
.to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:example"</em></strong>).marshal(jaxb);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SpringWebServices-SeeAlso"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="configuring-camel.html" target="_top">Configuring Camel</a></li><li class="listitem"><a class="link" href="component.html" target="_top">Component</a></li><li class="listitem"><a class="link" href="endpoint.html" target="_top">Endpoint</a></li><li class="listitem"><a class="link" href="getting-started.html" target="_top">Getting Started</a></li></ul></div></div></div></body></html>
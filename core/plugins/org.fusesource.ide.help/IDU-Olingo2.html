<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Olingo2</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-Netty4-HTTP.html" title="Netty4-HTTP"><link rel="next" href="IDU-Openshift.html" title="Openshift"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-Olingo2"></a>Olingo2</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Olingo2_HSH_Olingo2Component"></a>Olingo2 Component</h2></div></div></div><p><span class="strong"><strong>Available as of Camel 2.14</strong></span></p><p>The Olingo2 component utilizes <a class="link" href="http://olingo.apache.org/" target="_top">Apache
                Olingo</a> version 2.0 APIs to interact with OData 2.0 and 3.0 compliant
            services. A number of popular commercial and enterprise vendors and products support the
            OData protocol. A sample list of supporting products can be found on the OData <a class="link" href="http://www.odata.org/ecosystem/" target="_top">website</a>.</p><p>The Olingo2 component supports reading feeds, delta feeds, entities, simple and
            complex properties, links, counts, using custom and OData system query parameters. It
            supports updating entities, properties, and association links. It also supports
            submitting queries and change requests as a single OData batch operation.</p><p>The component supports configuring HTTP connection parameters and headers for OData
            service connection. This allows configuring use of SSL, OAuth2.0, etc. as required by
            the target OData service.</p><p>Maven users will need to add the following dependency to their pom.xml for this
            component:</p><div class="informalexample"><pre class="programlisting">	&lt;dependency&gt;
    	&lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    	&lt;artifactId&gt;camel-olingo2&lt;/artifactId&gt;
    	&lt;version&gt;${camel-version}&lt;/version&gt;
	&lt;/dependency&gt;</pre></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-332"></a>URI format</h2></div></div></div><div class="informalexample"><pre class="programlisting">olingo2://endpoint/&lt;resource-path&gt;?[options]</pre></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-333"></a>Olingo2Component</h2></div></div></div><p>The Olingo2 Component can be configured with the options below. These options can
                be provided using the component's bean property <span class="strong"><strong><code class="code">configuration</code></strong></span> of type <span class="strong"><strong><code class="code">org.apache.camel.component.olingo2.Olingo2Configuration</code></strong></span>.</p><table id="d0e137542"><colgroup> </colgroup><thead><tr>
                        <td>
                            <p>Option</p>
                        </td>
                        <td>
                            <p>Type</p>
                        </td>
                        <td>
                            <p>Description</p>
                        </td>
                    </tr></thead><tbody><tr>
                        <td>
                            <p>serviceUri</p>
                        </td>
                        <td>
                            <p>String</p>
                        </td>
                        <td>
                            <p>Target OData service base URI, e.g. <a class="link" href="http://services.odata.org/OData/OData.svc/Products?$orderby=Rating" target="_top">http://services.odata.org/OData/OData.svc</a></p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>contentType</p>
                        </td>
                        <td>
                            <p>String</p>
                        </td>
                        <td>
                            <p>Content-Type header value can be used to specify JSON or XML
                                message format, defaults to <span class="strong"><strong>application/json;charset=utf-8</strong></span></p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>connectTimeout</p>
                        </td>
                        <td>
                            <p>int</p>
                        </td>
                        <td>
                            <p>HTTP connection creation timeout in milliseconds, defaults to
                                30,000 (30 seconds)</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>socketTimeout</p>
                        </td>
                        <td>
                            <p>int</p>
                        </td>
                        <td>
                            <p>HTTP request timeout in milliseconds, defaults to 30,000 (30
                                seconds)</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>httpHeaders</p>
                        </td>
                        <td>
                            <p>java.util.Map&lt;String, String&gt;</p>
                        </td>
                        <td>
                            <p>Custom HTTP headers to inject into every request, this could
                                include OAuth tokens, etc.</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>proxy</p>
                        </td>
                        <td>
                            <p>org.apache.http.HttpHost</p>
                        </td>
                        <td>
                            <p>HTTP proxy server configuration</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>sslContext</p>
                        </td>
                        <td>
                            <p>javax.net.ssl.SSLContext</p>
                        </td>
                        <td>
                            <p>HTTP SSL configuration</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>httpAsyncClientBuilder</p>
                        </td>
                        <td>
                            <p>org.apache.http.impl.nio.client.HttpAsyncClientBuilder</p>
                        </td>
                        <td>
                            <p>Custom HTTP async client builder for more complex HTTP client
                                configuration, overrides connectionTimeout, socketTimeout, proxy and
                                sslContext. Note that a socketTimeout <span class="strong"><strong>MUST</strong></span> be specified in the builder, otherwise OData
                                requests could block indefinitely</p>
                        </td>
                    </tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-334"></a>Producer Endpoints</h2></div></div></div><p>Producer endpoints can use endpoint names and options listed next. Producer
                endpoints can also use a special option <span class="strong"><strong><code class="code">inBody</code></strong></span> that in turn should contain the name of the
                endpoint option whose value will be contained in the Camel Exchange In message. The
                    <span class="strong"><strong>inBody</strong></span> option defaults to <span class="strong"><strong>data</strong></span> for endpoints that take that option.</p><p>Any of the endpoint options can be provided in either the endpoint URI, or
                dynamically in a message header. The message header name must be of the format
                    <span class="strong"><strong><code class="code">CamelOlingo2.&lt;option&gt;</code></strong></span>.
                Note that the <span class="strong"><strong><code class="code">inBody</code></strong></span> option
                overrides message header, i.e. the endpoint option <span class="strong"><strong><code class="code">inBody=option</code></strong></span> would override a <span class="strong"><strong><code class="code">CamelOlingo2.option</code></strong></span> header. In addition,
                query parameters can be specified</p><p>Note that the resourcePath option can either in specified in the URI as a part of
                the URI path, as an endpoint option ?resourcePath=&lt;resource-path&gt; or as a
                header value CamelOlingo2.resourcePath. The OData entity key predicate can either be
                a part of the resource path, e.g. <span class="italics">Manufacturers('1')</span>, where <span class="italics">'</span><span class="italics">1'</span> is the key predicate, or be
                specified separately with resource path <span class="italics">Manufacturers</span> and keyPredicate option <span class="italics">'1'</span>.</p><table id="d0e137783"><colgroup> </colgroup><thead><tr>
                        <td>
                            <p>Endpoint</p>
                        </td>
                        <td>
                            <p>Options</p>
                        </td>
                        <td>
                            <p>HTTP Method</p>
                        </td>
                        <td>
                            <p>Result Body Type</p>
                        </td>
                    </tr></thead><tbody><tr>
                        <td>
                            <p>batch</p>
                        </td>
                        <td>
                            <p>data</p>
                        </td>
                        <td>
                            <code class="code">POST with multipart/mixed batch request</code>
                        </td>
                        <td>
                            <code class="code">java.util.List&amp;lt;org.apache.camel.component.olingo2.api.batch.Olingo2BatchResponse&gt;</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>create</p>
                        </td>
                        <td>
                            <p>data, resourcePath</p>
                        </td>
                        <td>
                            <code class="code">POST</code>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.ep.entry.ODataEntry for new entries</code>
                            <code class="code">org.apache.olingo.odata2.api.commons.HttpStatusCodes for other OData resources</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>delete</p>
                        </td>
                        <td>
                            <p>resourcePath</p>
                        </td>
                        <td>
                            <code class="code">DELETE</code>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.commons.HttpStatusCodes</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>merge</p>
                        </td>
                        <td>
                            <p>data, resourcePath</p>
                        </td>
                        <td>
                            <code class="code">MERGE</code>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.commons.HttpStatusCodes</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>patch</p>
                        </td>
                        <td>
                            <p>data, resourcePath</p>
                        </td>
                        <td>
                            <code class="code">PATCH</code>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.commons.HttpStatusCodes</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>read</p>
                        </td>
                        <td>
                            <p>queryParams, resourcePath</p>
                        </td>
                        <td>
                            <code class="code">GET</code>
                        </td>
                        <td>
                            <code class="code">Depends on OData resource being queried as described next</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>update</p>
                        </td>
                        <td>
                            <p>data, resourcePath</p>
                        </td>
                        <td>
                            <code class="code">PUT</code>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.commons.HttpStatusCodes</code>
                        </td>
                    </tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-335"></a>OData Resource Type Mapping</h2></div></div></div><p>The result of <span class="strong"><strong>read</strong></span> endpoint and data type of
                    <span class="strong"><strong>data</strong></span> option depends on the OData resource
                being queried, created or modified.</p><table id="d0e138010"><colgroup> </colgroup><thead><tr>
                        <td>
                            <p>OData Resource Type</p>
                        </td>
                        <td>
                            <p>Resource URI from resourcePath and keyPredicate</p>
                        </td>
                        <td>
                            <p>In or Out Body Type</p>
                        </td>
                    </tr></thead><tbody><tr>
                        <td>
                            <p>Entity data model</p>
                        </td>
                        <td>
                            <p>$metadata</p>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.edm.Edm</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Service document</p>
                        </td>
                        <td>
                            <p>/</p>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.servicedocument.ServiceDocument</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>OData feed</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;</p>
                        </td>
                        <td>
                            <code class="code">org.apache.olingo.odata2.api.ep.feed.ODataFeed</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>OData entry</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;)</p>
                        </td>
                        <td>
                        <code class="code">org.apache.olingo.odata2.api.ep.entry.ODataEntry</code>
                        for <span class="emphasis"><em>Out</em></span> body (response),
                            <code class="code">java.util.Map&amp;lt;String, Object&gt;</code>,  for
                            <span class="emphasis"><em>In</em></span> body (request).</td>
                    </tr><tr>
                        <td>
                            <p>Simple property</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;)/&lt;simple-property&gt;</p>
                        </td>
                        <td>
                            <code class="code">Appropriate Java data type as described by &lt;link xl:href="http://olingo.apache.org/javadoc/odata2/index.html?org/apache/olingo/odata2/api/edm/class-use/EdmProperty.html" &gt;Olingo EdmProperty&lt;/link&gt;</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Simple property value</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;)/&lt;simple-property&gt;/$value</p>
                        </td>
                        <td>
                            <code class="code">Appropriate Java data type as described by &lt;link xl:href="http://olingo.apache.org/javadoc/odata2/index.html?org/apache/olingo/odata2/api/edm/class-use/EdmProperty.html" &gt;Olingo EdmProperty&lt;/link&gt;</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Complex property</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;)/&lt;complex-property&gt;</p>
                        </td>
                        <td>
                            <code class="code">java.util.Map&amp;lt;String, Object&gt;</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Zero or one association link</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;/$link/&lt;one-to-one-entity-set-property&gt;</p>
                        </td>
                        <td>
                            <code class="code">String for response</code>
                            <code class="code">java.util.Map&amp;lt;String, Object&gt; with key property names and values for request</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Zero or many association links</p>
                        </td>
                        <td>
                            <p>&lt;entity-set&gt;(&lt;key-predicate&gt;/$link/&lt;one-to-many-entity-set-property&gt;</p>
                        </td>
                        <td>
                            <code class="code">java.util.List&amp;lt;String&gt; for response</code>
                            <code class="code">java.util.List&amp;lt;java.util.Map&amp;lt;String, Object&gt;&gt; containing list of key property names and values for request</code>
                        </td>
                    </tr><tr>
                        <td>
                            <p>Count</p>
                        </td>
                        <td>
                            <p>&lt;resource-uri&gt;/$count</p>
                        </td>
                        <td>
                            <code class="code">java.lang.Long</code>
                        </td>
                    </tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-336"></a>URI Options</h2></div></div></div><p>If a value is not provided for <span class="strong"><strong>queryParams</strong></span>
                either in the endpoint URI or in a message header, it will be assumed to be
                    <span class="strong"><strong><code class="code">null</code></strong></span>. Note that the <span class="strong"><strong><code class="code">null</code></strong></span> value will only be used if other
                options do not satisfy matching endpoints.</p><table id="d0e138266"><colgroup> </colgroup><thead><tr>
                        <td>
                            <p>Name</p>
                        </td>
                        <td>
                            <p>Type</p>
                        </td>
                        <td>
                            <p>Description</p>
                        </td>
                    </tr></thead><tbody><tr>
                        <td>
                            <p>data</p>
                        </td>
                        <td>
                            <code class="code">Object</code>
                        </td>
                        <td>
                            <p>Data with appropriate type used to create or modify the OData
                                resource</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>keyPredicate</p>
                        </td>
                        <td>
                            <code class="code">String</code>
                        </td>
                        <td>
                            <p>Key predicate to create a parameterized OData resource endpoint.
                                Useful for create/update operations where the key predicate value is
                                dynamically provided in a header</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>queryParams</p>
                        </td>
                        <td>
                            <code class="code">java.util.Map&amp;lt;String, String&gt;</code>
                        </td>
                        <td>
                            <p>OData system options and custom query options. For more
                                information see <a class="link" href="http://www.odata.org/documentation/odata-version-2-0/uri-conventions" target="_top">OData 2.0 URI Conventions</a></p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>resourcePath</p>
                        </td>
                        <td>
                            <code class="code">String</code>
                        </td>
                        <td>
                            <p>OData resource path, may or may not contain key predicate</p>
                        </td>
                    </tr><tr>
                        <td>
                            <p>*</p>
                        </td>
                        <td>
                            <code class="code">String</code>
                        </td>
                        <td>
                            <p>Any other URI option is treated as a query parameter and added to
                                query parameter map, overwriting entries in a <span class="strong"><strong>queryParams</strong></span> option, if also
                                specified</p>
                        </td>
                    </tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-337"></a>Consumer Endpoints</h2></div></div></div><p>Only the <span class="strong"><strong>read</strong></span> endpoint can be used as a
                consumer endpoint. Consumer endpoints can use <a class="link" href="http://camel.apache.org/polling-consumer.html#PollingConsumer-ScheduledPollConsumerOptions" target="_top">Scheduled Poll Consumer Options</a> with a <span class="strong"><strong><code class="code">consumer.</code></strong></span> prefix to schedule endpoint invocation.
                By default consumer endpoints that return an array or collection will generate one
                exchange per element, and their routes will be executed once for each exchange. This
                behavior can be disabled by setting the endpoint property <span class="strong"><strong>consumer.splitResult=false</strong></span>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-338"></a>Message Headers</h2></div></div></div><p>Any URI option can be provided in a message header for producer endpoints with a
                    <span class="strong"><strong><code class="code">CamelOlingo2.</code></strong></span> prefix.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-339"></a>Message Body</h2></div></div></div><p>All result message bodies utilize objects provided by the underlying <a class="link" href="http://olingo.apache.org/javadoc/odata2/index.html" target="_top">Apache Olingo
                    2.0 API</a> used by the Olingo2Component. Producer endpoints can specify the
                option name for incoming message body in the <span class="strong"><strong><code class="code">inBody</code></strong></span> endpoint URI parameter. For endpoints that
                return an array or collection, a consumer endpoint will map every element to
                distinct messages, unless <span class="strong"><strong>consumer.splitResult</strong></span> is
                set to <span class="strong"><strong>false</strong></span>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-340"></a>Use cases</h2></div></div></div><p>The following route reads top 5 entries from the Manufacturer feed ordered by
                ascending Name property.</p><pre class="programlisting">from("direct:...")
    .setHeader("CamelOlingo2.$top","5")
    .to("olingo2://read/Manufacturers?orderBy=Name%20asc");</pre><p>The following route reads Manufacturer entry using the key property value in
                incoming <span class="strong"><strong>id</strong></span> header.</p><pre class="programlisting">from("direct:...")
    .setHeader("CamelOlingo2.keyPredicate", header("id"))
    .to("olingo2://read/Manufacturers");</pre><p>The following route creates Manufacturer entry using the <span class="strong"><strong>java.util.Map&lt;String, Object&gt;</strong></span> in body message.</p><pre class="programlisting">from("direct:...")
    .to("olingo2://create/Manufacturers");</pre><p>The following route polls Manufacturer <a class="link" href="https://olingo.apache.org/doc/odata2/tutorials/deltaClient.html" target="_top">delta
                    feed</a> every 30 seconds. The bean <span class="strong"><strong>blah</strong></span>
                updates the bean <span class="strong"><strong>paramsBean</strong></span> to add an updated
                    <span class="strong"><strong>!deltatoken</strong></span> property with the value returned
                in the <span class="strong"><strong>ODataDeltaFeed</strong></span> result. Since the initial
                delta token is not known, the consumer endpoint will produce an <span class="strong"><strong>ODataFeed</strong></span> value the first time, and <span class="strong"><strong>ODataDeltaFeed</strong></span> on subsequent polls.</p><pre class="programlisting">from("olingo2://read/Manufacturers?queryParams=#paramsBean&amp;consumer.timeUnit=SECONDS&amp;consumer.delay=30")
    .to("bean:blah");</pre></div></div></body></html>
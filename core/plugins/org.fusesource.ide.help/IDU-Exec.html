<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Exec</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-EventAdmin.html" title="EventAdmin"><link rel="next" href="Fabric.html" title="Fabric Component"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-Exec"></a>Exec</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_Execcomponent"></a>Exec component</h2></div></div></div><p><span class="bold"><strong>Available in Apache Camel 2.3</strong></span>
    </p><p>The <code class="literal">exec</code> component can be used to execute system commands. </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_Dependencies"></a>Dependencies</h2></div></div></div><p>Maven users need to add the following dependency to their <code class="literal">pom.xml</code>
    </p><pre class="programlisting">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
  &lt;artifactId&gt;camel-exec&lt;/artifactId&gt;
  &lt;version&gt;${camel-version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>where <code class="literal">${camel-version}</code> must be replaced by the actual version of Apache Camel
      (2.3.0 or higher). </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">exec://executable[?options]</pre><p>where <code class="literal">executable</code> is the name, or file path, of the system command that
      will be executed. If executable name is used (e.g. <code class="literal">exec:java</code>), the
      executable must in the system path.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_URIoptions"></a>URI options</h2></div></div></div><p></p><p>
      
    </p><table id="d0e74917"><tr>
        <th> Name </th>
        <th> Default value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">args</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td>
          <p> The arguments of the executable. The arguments may be one or many
            whitespace-separated tokens, that can be quoted with <code class="literal">"</code>, e.g.
              <code class="literal">args="arg 1" arg2</code> will use two arguments <code class="literal">arg 1</code>
            and <code class="literal">arg2</code>. To include the quotes use <code class="literal">""</code>, e.g.
              <code class="literal">args=""arg 1"" arg2</code> will use the arguments <code class="literal">"arg
              1"</code> and <code class="literal">arg2</code>.</p>
        </td>
      </tr><tr>
        <td><code class="literal">workingDir</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td>The directory in which the command should be executed. If <code class="literal">null</code>, the
          working directory of the current process will be used.</td>
      </tr><tr>
        <td><code class="literal">timeout</code>
        </td>
        <td><code class="literal">Long.MAX_VALUE</code>
        </td>
        <td>The timeout, in milliseconds, after which the executable should be terminated. If
          execution has has not finished within the timeout, the component will send a termination
          request.</td>
      </tr><tr>
        <td><code class="literal">outFile</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td>The name of a file, created by the executable, that should be considered as its output.
          If no <code class="literal">outFile</code> is set, the standard output (stdout) of the executable
          will be considered as output. </td>
      </tr><tr>
        <td><code class="literal">binding</code>
        </td>
        <td> a <code class="literal">DefaultExecBinding</code> instance </td>
        <td> A reference to a <code class="literal">org.apache.commons.exec.ExecBinding</code> in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.</td>
      </tr><tr>
        <td><code class="literal">commandExecutor</code>
        </td>
        <td>a <code class="literal">DefaultCommandExecutor</code> instance </td>
        <td> A reference to a <code class="literal">org.apache.commons.exec.ExecCommandExecutor</code> in the
            <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>, that customizes
          the command execution. The default command executor utilizes the <a class="link" href="http://commons.apache.org/exec/" target="_top">commons-exec library</a>. It adds a
          shutdown hook for every executed command.</td>
      </tr><tr>
        <td><code class="literal">useStderrOnEmptyStdout</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td> A boolean indicating that when <code class="literal">stdout</code> is empty,
          this component will populate the Camel Message Body with <code class="literal">stderr</code>.
          This behavior is disabled (<code class="literal">false</code>) by default. </td>
      </tr></table><p>
      
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_Messageheaders"></a>Message headers</h2></div></div></div><p></p><p>The supported headers are defined in
        <code class="literal">org.apache.camel.component.exec.ExecBinding</code>.
      
    </p><table id="d0e75109"><tr>
        <th>Name</th>
        <th>Type</th>
        <th>Message </th>
        <th>Description</th>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_EXECUTABLE</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td> The name of the system command that will be executed. Overrides the
            <code class="literal">executable</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_ARGS</code>
        </td>
        <td><code class="literal">java.util.List&lt;String&gt;</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td>The arguments of the executable. The arguments are used literally, no quoting is
          applied. Overrides existing <code class="literal">args</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_ARGS</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td><span class="bold"><strong>Camel 2.5:</strong></span> The arguments of the executable as a Single string where each argument is whitespace separated (see <code class="literal">args</code> in URI option). The arguments are used literally, no quoting is applied. Overrides existing <code class="literal">args</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_OUT_FILE</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td>The name of a file, created by the executable, that should be considered as output of
          the executable. Overrides existing <code class="literal">outFile</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_TIMEOUT</code>
        </td>
        <td><code class="literal">long</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td>The timeout, in milliseconds, after which the executable should be terminated. Overrides any
          existing <code class="literal">timeout</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_COMMAND_WORKING_DIR</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td>The directory in which the command should be executed. Overrides any existing
            <code class="literal">workingDir</code> in the URI.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_EXIT_VALUE</code>
        </td>
        <td><code class="literal">int</code>
        </td>
        <td><code class="literal">out</code>
        </td>
        <td>The value of this header is the <span class="emphasis"><em>exit value</em></span> of the executable.
          Non-zero exit values typically indicate abnormal termination. Note that the exit value is
          OS-dependent.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_STDERR</code>
        </td>
        <td><code class="literal">java.io.InputStream</code>
        </td>
        <td><code class="literal">out</code>
        </td>
        <td>The value of this header points to the standard error stream (stderr) of the executable.
          If no stderr is written, the value is <code class="literal">null</code>.</td>
      </tr><tr>
        <td><code class="literal">ExecBinding.EXEC_USE_STDERR_ON_EMPTY_STDOUT</code>
        </td>
        <td><code class="literal">boolean</code>
        </td>
        <td><code class="literal">in</code>
        </td>
        <td> Indicates that when <code class="literal">stdout</code> is empty, this component will populate the
          Camel Message Body with <code class="literal">stderr</code>.
          This behavior is disabled (<code class="literal">false</code>) by default. </td>
      </tr></table><p>
      
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_Messagebody"></a>Message body</h2></div></div></div><p>If the <code class="literal">Exec</code> component receives an <code class="literal">in</code> message body that
      is convertible to <code class="literal">java.io.InputStream</code>, it is used to feed input
      to the executable via its stdin. After execution, <a class="link" href="http://camel.apache.org/exchange.html" target="_top">the message body</a>
      is the result of the execution, that is, an <code class="literal">org.apache.camel.components.exec.ExecResult</code>
      instance containing the stdout, stderr, exit value, and out file. This component supports the following
      <code class="literal">ExecResult</code>      
      <a class="link" href="http://camel.apache.org/type-converter.html" target="_top">type converters</a> for
      convenience:</p><p>
      
    </p><table id="d0e75377"><tr>
        <th>From</th>
        <th>To</th>
      </tr><tr>
        <td><code class="literal">ExecResult</code>
        </td>
        <td><code class="literal">java.io.InputStream</code>
        </td>
      </tr><tr>
        <td><code class="literal">ExecResult</code>
        </td>
        <td><code class="literal">String</code>
        </td>
      </tr><tr>
        <td><code class="literal">ExecResult</code>
        </td>
        <td><code class="literal">byte []</code>
        </td>
      </tr><tr>
        <td><code class="literal">ExecResult</code>
        </td>
        <td><code class="literal">org.w3c.dom.Document</code>
        </td>
      </tr></table><p><span class="phrase"><a name="IDU-Exec_HSH_usage"></a></span>
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_ExecutingwordcountLinux"></a>Executing word count (Linux)</h2></div></div></div><p>The example below executes <code class="literal">wc</code> (word count, Linux) to count the words in
      file <code class="literal">/usr/share/dict/words</code>. The word count (output) is written in the
      standart output stream of <code class="literal">wc</code>.</p><pre class="programlisting">from("direct:exec")
.to("exec:wc?args=--words /usr/share/dict/words")
.process(new Processor() {
     public void process(Exchange exchange) throws Exception {
       // By default, the body is ExecResult instance
       assertIsInstanceOf(ExecResult.class, exchange.getIn().getBody());
       // Use the Camel Exec String type converter to convert the ExecResult to String
       // In this case, the stdout is considered as output
       String wordCountOutput = exchange.getIn().getBody(String.class);
       // do something with the word count
     }
});</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_Executingjava"></a>Executing java</h2></div></div></div><p>The example below executes <code class="literal">java</code> with 2 arguments:
        <code class="literal">-server</code> and <code class="literal">-version</code>, provided that
        <code class="literal">java</code> is in the system path. </p><pre class="programlisting">from("direct:exec")
.to("exec:java?args=-server -version")</pre><p>The example below executes <code class="literal">java</code> in <code class="literal">c:/temp</code> with 3
      arguments: <code class="literal">-server</code>, <code class="literal">-version</code> and the sytem property
        <code class="literal">user.name</code>.</p><pre class="programlisting">from("direct:exec")
.to("exec:c:/program files/jdk/bin/java?args=-server -version -Duser.name=Camel&amp;workingDir=c:/temp")</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_ExecutingAntscripts"></a>Executing Ant scripts</h2></div></div></div><p>The following example executes <a class="link" href="http://ant.apache.org/" target="_top">Apache Ant</a>
      (Windows only) with the build file <code class="literal">CamelExecBuildFile.xml</code>, provided that
        <code class="literal">ant.bat</code> is in the system path, and that
        <code class="literal">CamelExecBuildFile.xml</code> is in the current directory.</p><pre class="programlisting">from("direct:exec")
.to("exec:ant.bat?args=-f CamelExecBuildFile.xml")</pre><p>In the next example, the <code class="literal">ant.bat</code> command redirects its output to
      <code class="literal">CamelExecOutFile.txt</code> with <code class="literal">-l</code>.
      The file <code class="literal">CamelExecOutFile.txt</code> is used as the out file with
      <code class="literal">outFile=CamelExecOutFile.txt</code>. The example assumes that
      <code class="literal">ant.bat</code> is in the system path, and that
      <code class="literal">CamelExecBuildFile.xml</code> is in the current directory.</p><pre class="programlisting">from("direct:exec")
.to("exec:ant.bat?args=-f CamelExecBuildFile.xml -l CamelExecOutFile.txt&amp;outFile=CamelExecOutFile.txt")
.process(new Processor() {
     public void process(Exchange exchange) throws Exception {
        InputStream outFile = exchange.getIn().getBody(InputStream.class);
        assertIsInstanceOf(InputStream.class, outFile);
        // do something with the out file here
     }
  });</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Exec_HSH_ExecutingechoWindows"></a>Executing echo (Windows)</h2></div></div></div><p>Commands such as <code class="literal">echo</code> and <code class="literal">dir</code> can be executed only with the command interpreter of the operating system. This example shows how to execute such a command - <code class="literal">echo</code> - in Windows.</p><pre class="programlisting">from("direct:exec").to("exec:cmd?args=/C echo echoString")</pre></div></div></body></html>
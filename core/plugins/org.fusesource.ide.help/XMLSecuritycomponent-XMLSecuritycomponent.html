<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>XML Security component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="XmlRpc-XmlRpcComponent.html" title="XmlRpc Component"><link rel="next" href="XMPP-XMPPComponent.html" title="XMPP Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="XMLSecuritycomponent-XMLSecuritycomponent"></a>XML Security component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-XMLSignatureWrappingModes">XML Signature Wrapping Modes</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-URIFormat">URI Format</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-BasicExample">Basic Example</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-ComponentOptions">Component Options</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-EndpointOptions">Endpoint Options</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-DetachedXMLSignaturesasSiblingsoftheSignedElements">Detached XML Signatures as Siblings of the Signed Elements</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-XAdES-BESEPESfortheSignerEndpoint">XAdES-BES/EPES for the Signer Endpoint</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-SeeAlso">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.12.0</strong></span></p><p>With this Apache Camel component, you can generate and validate XML
signatures as described in the W3C standard
<a class="link" href="http://www.w3.org/TR/xmldsig-core/" target="_top">XML Signature Syntax and Processing</a>
or as described in the successor
<a class="link" href="http://www.w3.org/TR/xmldsig-core1/" target="_top">version 1.1</a>. For XML Encryption
support, please refer to the XML Security <a class="link" href="data-format.html" target="_top">Data
Format</a>.</p><p>You can find an introduction to XML signature
<a class="link" href="http://www.oracle.com/technetwork/articles/javase/dig-signatures-141823.html" target="_top">here</a>.
The implementation of the component is based on
<a class="link" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/xmldsig/overview.html" target="_top">JSR
105</a>, the Java API corresponding to the W3C standard and supports the
Apache Santuario and the JDK provider for JSR 105. The implementation
will first try to use the Apache Santuario provider; if it does not find
the Santuario provider, it will use the JDK provider. Further, the
implementation is DOM based.</p><p>Since Camel 2.15.0 we also provide support for <span class="strong"><strong>XAdES-BES/EPES</strong></span> for the
signer endpoint; see subsection "XAdES-BES/EPES for the Signer
Endpoint".</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-xmlsecurity<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-XMLSignatureWrappingModes"></a>XML Signature Wrapping Modes</h2></div></div></div><p>XML Signature differs between enveloped, enveloping, and detached XML
signature. In the
<a class="link" href="http://www.w3.org/TR/xmldsig-core1/#def-SignatureEnveloped" target="_top">enveloped</a>
XML signature case, the XML Signature is wrapped by the signed XML
Document; which means that the XML signature element is a child element
of a parent element, which belongs to the signed XML Document. In the
<a class="link" href="http://www.w3.org/TR/xmldsig-core1/#def-SignatureEnveloping" target="_top">enveloping</a>
XML signature case, the XML Signature contains the signed content. All
other cases are called
<a class="link" href="http://www.w3.org/TR/xmldsig-core1/#def-SignatureDetached" target="_top">detached</a> XML
signatures. A certain form of detached XML signature is supported since
<span class="strong"><strong>2.14.0</strong></span>.</p><p>In the <span class="strong"><strong>enveloped XML signature</strong></span> case, the supported generated XML
signature has the following structure (Variables are surrounded by <code class="literal">[]</code>).</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;[parent</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element]&gt;</span>
   <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">...</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;!--</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Signature</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">is</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">added</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">as</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">last</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">child</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">of</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">the</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">parent</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element--&gt;</span>
   <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;Signature</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"generated_unique_signature_id"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
       <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignedInfo&gt;</strong>
             <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">""</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
                   (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform&gt;</strong>)* <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- By default "http://www.w3.org/2006/12/xml-c14n11" is added to the transforms --&gt;</em>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
             <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>
             (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#[keyinfo_Id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
                   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
             <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>)?
             <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further references possible, see option 'properties' below --&gt;</em>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/SignedInfo&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignatureValue&gt;</strong>
      (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;KeyInfo</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[keyinfo_id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>)?
      <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- Object elements possible, see option 'properties' below --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Signature&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/[parent element]&gt;</strong></pre><p>In the <span class="strong"><strong>enveloping XML signature</strong></span> case, the supported generated XML
signature has the structure:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Signature</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"generated_unique_signature_id"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignedInfo&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#generated_unique_object_id"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[optional_type_value]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
               (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform&gt;</strong>)* <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- By default "http://www.w3.org/2006/12/xml-c14n11" is added to the transforms --&gt;</em>
               <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
               <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>
         (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#[keyinfo_id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
               <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
               <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
               <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>)?
          <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further references possible, see option 'properties' below  --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/SignedInfo&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignatureValue&gt;</strong>
  (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;KeyInfo</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[keyinfo_id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>)?
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Object</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"generated_unique_object_id"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong> <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- The Object element contains the in-message body; the object ID can either be generated or set by the option parameter "contentObjectId" --&gt;</em>
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- Further Object elements possible, see option 'properties' below --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Signature&gt;</strong></pre><p>As of 2.14.0 <span class="strong"><strong>detached XML signatures</strong></span> with the following structure
are supported (see also sub-chapter XML Signatures as Siblings of Signed
Elements):</p><pre class="programlisting">(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;[signed</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element]</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[id_value]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- signed element must have an attribute of type ID --&gt;</em>
      ...

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/[signed element]&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;other</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">sibling/&gt;*&nbsp;</span>
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;!--</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">between</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">the</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">signed</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">and</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">the</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">corresponding</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">signature</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element,</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">there</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">can</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">be</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">other</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">siblings.</span>
 <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Signature</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">element</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">is</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">added</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">as</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">last</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">sibling.</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">--&gt;</span>
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;Signature</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"generated_unique_ID"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignedInfo&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;CanonicalizationMethod&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignatureMethod&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#[id_value]"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[optional_type_value]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
      <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- reference URI contains the ID attribute value of the signed element --&gt;</em>
            (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform&gt;</strong>)* <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- By default "http://www.w3.org/2006/12/xml-c14n11" is added to the transforms --&gt;</em>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>
      (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#[generated_keyinfo_Id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Transform</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestMethod&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;DigestValue&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Reference&gt;</strong>)?
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/SignedInfo&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignatureValue&gt;</strong>
   (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;KeyInfo</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"[generated_keyinfo_id]"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>)?
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Signature&gt;</strong>)+</pre><p>&nbsp;</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-URIFormat"></a>URI Format</h2></div></div></div><p>The camel component consists of two endpoints which have the following
URI format:</p><pre class="screen">xmlsecurity:sign:name[?options]
xmlsecurity:verify:name[?options]</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">With the signer endpoint, you can generate a XML signature for the
body of the in-message which can be either a XML document or a plain
text. The enveloped, enveloping, or detached (as of 12.14) &nbsp;XML
signature(s) will be set to the body of the out-message.</li><li class="listitem">With the verifier endpoint, you can validate an enveloped or
enveloping XML signature or even several detached (as of 2.14.0) XML
signatures contained in the body of the in-message; if the validation is
successful, then the original content is extracted from the XML
signature and set to the body of the out-message.</li><li class="listitem">The <code class="literal">name</code> part in the URI can be chosen by the user to distinguish
between different signer/verifier endpoints within the camel context.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-BasicExample"></a>Basic Example</h2></div></div></div><p>The following example shows the basic usage of the component.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:enveloping"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlsecurity:sign://enveloping?keyAccessor=#accessor"</em></strong>,
                             <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlsecurity:verify://enveloping?keySelector=#selector"</em></strong>,
                             <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>)</pre><p>In Spring XML:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:enveloping"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xmlsecurity:sign://enveloping?keyAccessor=#accessor"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xmlsecurity:verify://enveloping?keySelector=#selector"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong></pre><p>For the signing process, a private key is necessary. You specify a key
accessor bean which provides this private key. For the validation, the
corresponding public key is necessary; you specify a key selector bean
which provides this public key.</p><p>The key accessor bean must implement the
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-xmlsecurity/src/main/java/org/apache/camel/component/xmlsecurity/api/KeyAccessor.java" target="_top"><code class="literal">KeyAccessor</code></a>
interface. The package <code class="literal">org.apache.camel.component.xmlsecurity.api</code>
contains the default implementation class
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-xmlsecurity/src/main/java/org/apache/camel/component/xmlsecurity/api/DefaultKeyAccessor.java" target="_top"><code class="literal">DefaultKeyAccessor</code></a>
which reads the private key from a Java keystore.</p><p>The key selector bean must implement the
<a class="link" href="http://docs.oracle.com/javase/6/docs/api/javax/xml/crypto/KeySelector.html" target="_top"><code class="literal">javax.xml.crypto.KeySelector</code></a>
interface. The package <code class="literal">org.apache.camel.component.xmlsecurity.api</code>
contains the default implementation class
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-xmlsecurity/src/main/java/org/apache/camel/component/xmlsecurity/api/DefaultKeySelector.java" target="_top"><code class="literal">DefaultKeySelector</code></a>
which reads the public key from a keystore.</p><p>In the example, the default signature algorithm
<code class="literal"><a class="link" href="http://www.w3.org/2000/09/xmldsig#rsa-sha1" target="_top">http://www.w3.org/2000/09/xmldsig#rsa-sha1</a></code> is used. You can set the
signature algorithm of your choice by the option <code class="literal">signatureAlgorithm</code>
(see below). The signer endpoint creates an <span class="emphasis"><em>enveloping</em></span> XML signature.
If you want to create an <span class="emphasis"><em>enveloped</em></span> XML signature then you must specify
the parent element of the Signature element; see option
<code class="literal">parentLocalName</code> for more details.</p><p>For creating <span class="emphasis"><em>detached</em></span> XML signatures, see sub-chapter "Detached XML
Signatures as Siblings of the Signed Elements".</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-ComponentOptions"></a>Component Options</h2></div></div></div><p>The XML Security component supports 2 options which are listed below.</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="11%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>signerConfiguration</p></td><td align="left" valign="top"><p><code class="literal">XmlSignerConfiguration</code></p></td><td align="left" valign="top"><p>To use a shared XmlSignerConfiguration configuration to use as base for configuring endpoints.</p></td></tr><tr><td align="left" valign="top"><p>verifierConfiguration</p></td><td align="left" valign="top"><p><code class="literal">XmlVerifierConfiguration</code></p></td><td align="left" valign="top"><p>To use a shared XmlVerifierConfiguration configuration to use as base for configuring endpoints.</p></td></tr></tbody></table></div><p>{% endraw %}</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-EndpointOptions"></a>Endpoint Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-OutputNodeDeterminationinEnvelopingXMLSignatureCase">Output Node Determination in Enveloping XML Signature Case</a></span></dt></dl></div><p>The XML Security component supports 37 endpoint options which are listed below:</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="10%" class="col_2"><col width="11%" class="col_3"><col width="10%" class="col_4"><col width="50%" class="col_5"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Group</th><th align="left" valign="top">Default</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>command</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">XmlCommand</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> Whether to sign or verify.</p></td></tr><tr><td align="left" valign="top"><p>name</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The name part in the URI can be chosen by the user to distinguish between different signer/verifier endpoints within the camel context.</p></td></tr><tr><td align="left" valign="top"><p>baseUri</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>You can set a base URI which is used in the URI dereferencing. Relative URIs are then concatenated with the base URI.</p></td></tr><tr><td align="left" valign="top"><p>clearHeaders</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Determines if the XML signature specific headers be cleared after signing and verification. Defaults to true.</p></td></tr><tr><td align="left" valign="top"><p>cryptoContextProperties</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p>Sets the crypto context properties. See link XMLCryptoContextsetProperty(String Object). Possible properties are defined in XMLSignContext an XMLValidateContext (see Supported Properties). The following properties are set by default to the value link BooleanTRUE for the XML validation. If you want to switch these features off you must set the property value to link BooleanFALSE. org.jcp.xml.dsig.validateManifests javax.xml.crypto.dsig.cacheReference</p></td></tr><tr><td align="left" valign="top"><p>disallowDoctypeDecl</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Disallows that the incoming XML document contains DTD DOCTYPE declaration. The default value is link BooleanTRUE.</p></td></tr><tr><td align="left" valign="top"><p>omitXmlDeclaration</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Indicator whether the XML declaration in the outgoing message body should be omitted. Default value is false. Can be overwritten by the header link XmlSignatureConstantsHEADER_OMIT_XML_DECLARATION.</p></td></tr><tr><td align="left" valign="top"><p>outputXmlEncoding</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The character encoding of the resulting signed XML document. If null then the encoding of the original XML document is used.</p></td></tr><tr><td align="left" valign="top"><p>schemaResourceUri</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Classpath to the XML Schema. Must be specified in the detached XML Signature case for determining the ID attributes might be set in the enveloped and enveloping case. If set then the XML document is validated with the specified XML schema. The schema resource URI can be overwritten by the header link XmlSignatureConstantsHEADER_SCHEMA_RESOURCE_URI.</p></td></tr><tr><td align="left" valign="top"><p>synchronous</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used or Camel is allowed to use asynchronous processing (if supported).</p></td></tr><tr><td align="left" valign="top"><p>uriDereferencer</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URIDereferencer</code></p></td><td align="left" valign="top"><p>If you want to restrict the remote access via reference URIs you can set an own dereferencer. Optional parameter. If not set the provider default dereferencer is used which can resolve URI fragments HTTP file and XPpointer URIs. Attention: The implementation is provider dependent!</p></td></tr><tr><td align="left" valign="top"><p>addKeyInfoReference</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>In order to protect the KeyInfo element from tampering you can add a reference to the signed info element so that it is protected via the signature value. The default value is true. Only relevant when a KeyInfo is returned by KeyAccessor. and link KeyInfogetId() is not null.</p></td></tr><tr><td align="left" valign="top"><p>canonicalizationMethod</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal"><a class="link" href="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" target="_top">http://www.w3.org/TR/2001/REC-xml-c14n-20010315</a></code></p></td><td align="left" valign="top"><p><code class="literal">AlgorithmMethod</code></p></td><td align="left" valign="top"><p>Canonicalization method used to canonicalize the SignedInfo element before the digest is calculated. You can use the helper methods XmlSignatureHelper.getCanonicalizationMethod(String algorithm) or getCanonicalizationMethod(String algorithm List inclusiveNamespacePrefixes) to create a canonicalization method.</p></td></tr><tr><td align="left" valign="top"><p>contentObjectId</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Sets the content object Id attribute value. By default a UUID is generated. If you set the null value then a new UUID will be generated. Only used in the enveloping case.</p></td></tr><tr><td align="left" valign="top"><p>contentReferenceType</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Type of the content reference. The default value is null. This value can be overwritten by the header link XmlSignatureConstantsHEADER_CONTENT_REFERENCE_TYPE.</p></td></tr><tr><td align="left" valign="top"><p>contentReferenceUri</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Reference URI for the content to be signed. Only used in the enveloped case. If the reference URI contains an ID attribute value then the resource schema URI ( link setSchemaResourceUri(String)) must also be set because the schema validator will then find out which attributes are ID attributes. Will be ignored in the enveloping or detached case.</p></td></tr><tr><td align="left" valign="top"><p>digestAlgorithm</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Digest algorithm URI. Optional parameter. This digest algorithm is used for calculating the digest of the input message. If this digest algorithm is not specified then the digest algorithm is calculated from the signature algorithm. Example: <a class="link" href="http://www.w3.org/2001/04/xmlencsha256" target="_top">http://www.w3.org/2001/04/xmlencsha256</a></p></td></tr><tr><td align="left" valign="top"><p>keyAccessor</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">KeyAccessor</code></p></td><td align="left" valign="top"><p>For the signing process a private key is necessary. You specify a key accessor bean which provides this private key. The key accessor bean must implement the KeyAccessor interface. The package org.apache.camel.component.xmlsecurity.api contains the default implementation class DefaultKeyAccessor which reads the private key from a Java keystore.</p></td></tr><tr><td align="left" valign="top"><p>parentLocalName</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Local name of the parent element to which the XML signature element will be added. Only relevant for enveloped XML signature. Alternatively you can also use link setParentXpath(XPathFilterParameterSpec). Default value is null. The value must be null for enveloping and detached XML signature. This parameter or the parameter link setParentXpath(XPathFilterParameterSpec) for enveloped signature and the parameter link setXpathsToIdAttributes(List) for detached signature must not be set in the same configuration. If the parameters parentXpath and parentLocalName are specified in the same configuration then an exception is thrown.</p></td></tr><tr><td align="left" valign="top"><p>parentNamespace</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Namespace of the parent element to which the XML signature element will be added.</p></td></tr><tr><td align="left" valign="top"><p>parentXpath</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">XPathFilterParameterSpec</code></p></td><td align="left" valign="top"><p>Sets the XPath to find the parent node in the enveloped case. Either you specify the parent node via this method or the local name and namespace of the parent with the methods link setParentLocalName(String) and link setParentNamespace(String). Default value is null. The value must be null for enveloping and detached XML signature. If the parameters parentXpath and parentLocalName are specified in the same configuration then an exception is thrown.</p></td></tr><tr><td align="left" valign="top"><p>plainText</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Indicator whether the message body contains plain text. The default value is false indicating that the message body contains XML. The value can be overwritten by the header link XmlSignatureConstantsHEADER_MESSAGE_IS_PLAIN_TEXT.</p></td></tr><tr><td align="left" valign="top"><p>plainTextEncoding</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal">UTF-8</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Encoding of the plain text. Only relevant if the message body is plain text (see parameter link plainText. Default value is UTF-8.</p></td></tr><tr><td align="left" valign="top"><p>prefixForXmlSignatureNamespace</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal">ds</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Namespace prefix for the XML signature namespace <a class="link" href="http://www.w3.org/2000/09/xmldsig" target="_top">http://www.w3.org/2000/09/xmldsig</a>. Default value is ds. If null or an empty value is set then no prefix is used for the XML signature namespace. See best practice <a class="link" href="http://www.w3.org/TR/xmldsig-bestpractices/signing-xml-" target="_top">http://www.w3.org/TR/xmldsig-bestpractices/signing-xml-</a> without-namespaces</p></td></tr><tr><td align="left" valign="top"><p>properties</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">XmlSignatureProperties</code></p></td><td align="left" valign="top"><p>For adding additional References and Objects to the XML signature which contain additional properties you can provide a bean which implements the XmlSignatureProperties interface.</p></td></tr><tr><td align="left" valign="top"><p>signatureAlgorithm</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top"><p><code class="literal"><a class="link" href="http://www.w3.org/2000/09/xmldsig#rsa-sha1" target="_top">http://www.w3.org/2000/09/xmldsig#rsa-sha1</a></code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Signature algorithm. Default value is <a class="link" href="http://www.w3.org/2000/09/xmldsigrsa-sha1" target="_top">http://www.w3.org/2000/09/xmldsigrsa-sha1</a>.</p></td></tr><tr><td align="left" valign="top"><p>signatureId</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Sets the signature Id. If this parameter is not set (null value) then a unique ID is generated for the signature ID (default). If this parameter is set to (empty string) then no Id attribute is created in the signature element.</p></td></tr><tr><td align="left" valign="top"><p>transformMethods</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">List</code></p></td><td align="left" valign="top"><p>Transforms which are executed on the message body before the digest is calculated. By default C14n is added and in the case of enveloped signature (see option parentLocalName) also <a class="link" href="http://www.w3.org/2000/09/xmldsigenveloped-signature" target="_top">http://www.w3.org/2000/09/xmldsigenveloped-signature</a> is added at position 0 of the list. Use methods in XmlSignatureHelper to create the transform methods.</p></td></tr><tr><td align="left" valign="top"><p>xpathsToIdAttributes</p></td><td align="left" valign="top"><p>sign</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">List</code></p></td><td align="left" valign="top"><p>Define the elements which are signed in the detached case via XPATH expressions to ID attributes (attributes of type ID). For each element found via the XPATH expression a detached signature is created whose reference URI contains the corresponding attribute value (preceded by ''). The signature becomes the last sibling of the signed element. Elements with deeper hierarchy level are signed first. You can also set the XPATH list dynamically via the header link XmlSignatureConstantsHEADER_XPATHS_TO_ID_ATTRIBUTES. The parameter link setParentLocalName(String) or link setParentXpath(XPathFilterParameterSpec) for enveloped signature and this parameter for detached signature must not be set in the same configuration.</p></td></tr><tr><td align="left" valign="top"><p>keySelector</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">KeySelector</code></p></td><td align="left" valign="top"><p>Provides the key for validating the XML signature.</p></td></tr><tr><td align="left" valign="top"><p>outputNodeSearch</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Sets the output node search value for determining the node from the XML signature document which shall be set to the output message body. The class of the value depends on the type of the output node search. The output node search is forwarded to XmlSignature2Message.</p></td></tr><tr><td align="left" valign="top"><p>outputNodeSearchType</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top"><p><code class="literal">Default</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Determines the search type for determining the output node which is serialized into the output message bodyF. See link setOutputNodeSearch(Object). The supported default search types you can find in DefaultXmlSignature2Message.</p></td></tr><tr><td align="left" valign="top"><p>removeSignatureElements</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Indicator whether the XML signature elements (elements with local name Signature and namesapce <a class="link" href="http://www.w3.org/2000/09/xmldsig" target="_top">http://www.w3.org/2000/09/xmldsig</a>) shall be removed from the document set to the output message. Normally this is only necessary if the XML signature is enveloped. The default value is link BooleanFALSE. This parameter is forwarded to XmlSignature2Message. This indicator has no effect if the output node search is of type link DefaultXmlSignature2MessageOUTPUT_NODE_SEARCH_TYPE_DEFAULT.F</p></td></tr><tr><td align="left" valign="top"><p>secureValidation</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Enables secure validation. If true then secure validation is enabled.</p></td></tr><tr><td align="left" valign="top"><p>validationFailedHandler</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">ValidationFailedHandler</code></p></td><td align="left" valign="top"><p>Handles the different validation failed situations. The default implementation throws specific exceptions for the different situations (All exceptions have the package name org.apache.camel.component.xmlsecurity.api and are a sub-class of XmlSignatureInvalidException. If the signature value validation fails a XmlSignatureInvalidValueException is thrown. If a reference validation fails a XmlSignatureInvalidContentHashException is thrown. For more detailed information see the JavaDoc.</p></td></tr><tr><td align="left" valign="top"><p>xmlSignature2Message</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">XmlSignature2Message</code></p></td><td align="left" valign="top"><p>Bean which maps the XML signature to the output-message after the validation. How this mapping should be done can be configured by the options outputNodeSearchType outputNodeSearch and removeSignatureElements. The default implementation offers three possibilities which are related to the three output node search types Default ElementName and XPath. The default implementation determines a node which is then serialized and set to the body of the output message If the search type is ElementName then the output node (which must be in this case an element) is determined by the local name and namespace defined in the search value (see option outputNodeSearch). If the search type is XPath then the output node is determined by the XPath specified in the search value (in this case the output node can be of type Element TextNode or Document). If the output node search type is Default then the following rules apply: In the enveloped XML signature case (there is a reference with URI= and transform <a class="link" href="http://www.w3.org/2000/09/xmldsigenveloped-signature" target="_top">http://www.w3.org/2000/09/xmldsigenveloped-signature</a>) the incoming XML document without the Signature element is set to the output message body. In the non-enveloped XML signature case the message body is determined from a referenced Object; this is explained in more detail in chapter Output Node Determination in Enveloping XML Signature Case.</p></td></tr><tr><td align="left" valign="top"><p>xmlSignatureChecker</p></td><td align="left" valign="top"><p>verify</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">XmlSignatureChecker</code></p></td><td align="left" valign="top"><p>This interface allows the application to check the XML signature before the validation is executed. This step is recommended in <a class="link" href="http://www.w3.org/TR/xmldsig-bestpractices/check-what-is-signed" target="_top">http://www.w3.org/TR/xmldsig-bestpractices/check-what-is-signed</a></p></td></tr></tbody></table></div><p>{% endraw %}</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="XMLSecuritycomponent-OutputNodeDeterminationinEnvelopingXMLSignatureCase"></a>Output Node Determination in Enveloping XML Signature Case</h3></div></div></div><p>After the validation the node is extracted from the XML signature
document which is finally returned to the output-message body. In the
enveloping XML signature case, the default implementation
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-xmlsecurity/src/main/java/org/apache/camel/component/xmlsecurity/api/DefaultXmlSignature2Message.java" target="_top"><code class="literal">DefaultXmlSignature2Message</code></a>
of
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-xmlsecurity/src/main/java/org/apache/camel/component/xmlsecurity/api/XmlSignature2Message.java" target="_top"><code class="literal">XmlSignature2Message</code></a>
does this for the node search type <code class="literal">Default</code> in the following way (see
option <code class="literal">xmlSignature2Message</code>):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">First an object reference is determined:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">Only same document references are taken into account (URI must start
with <code class="literal">#</code>)</li><li class="listitem">Also indirect same document references to an object via manifest are
taken into account.</li><li class="listitem">The resulting number of object references must be 1.</li></ul></div></li><li class="listitem">Then, the object is dereferenced and the object must only contain one
XML element. This element is returned as output node.</li></ul></div><p>This does mean that the enveloping XML signature must have either the
structure:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Signature&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignedInfo&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#object"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
         <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further references possible but they must not point to an Object or Manifest containing an object reference --&gt;</em>
         ...
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/SignedInfo&gt;</strong>

      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Object</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"object"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
           <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- contains one XML element which is extracted to the message body --&gt;</em>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Object&gt;</strong>
      <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further object elements possible which are not referenced--&gt;</em>
      ...
      (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;KeyInfo&gt;</strong>)?
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Signature&gt;</strong></pre><p>or the structure:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Signature&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;SignedInfo&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#manifest"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
         <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further references  are possible but they must not point to an Object or other manifest containing an object reference --&gt;</em>
         ...
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/SignedInfo&gt;</strong>

      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Object &gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Manifest</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"manifest"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">#object</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Manifest&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Objet&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;Object</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"object"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
          <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- contains the DOM node which is extracted to the message body --&gt;</em>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Object&gt;</strong>
       <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- further object elements possible which are not referenced --&gt;</em>
      ...
      (<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;KeyInfo&gt;</strong>)?
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/Signature&gt;</strong></pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-DetachedXMLSignaturesasSiblingsoftheSignedElements"></a>Detached XML Signatures as Siblings of the Signed Elements</h2></div></div></div><p><span class="strong"><strong>Since 2.14.0</strong></span></p><p>You can create detached signatures where the signature is a sibling of
the signed element. The following example contains two detached
signatures. The first signature is for the element <code class="literal">C</code> and the second
signature is for element <code class="literal">A</code>. The signatures are <span class="emphasis"><em>nested</em></span>; the second
signature is for the element <code class="literal">A</code> which also contains the first signature.</p><p><span class="strong"><strong>Example Detached XML Signatures</strong></span></p><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;root&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;A</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ID</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"IDforA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;B&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;C</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ID</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"IDforC"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;D&gt;</strong>dvalue<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/D&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/C&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:Signature</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns:ds</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#"</span>
                <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"_6bf13099-0568-4d76-8649-faf5dcb313c0"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignedInfo&gt;</strong>
                    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:CanonicalizationMethod</strong>
                        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
                    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignatureMethod</strong>
                        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#rsa-sha1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
                    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#IDforC"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                        ...
                    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:Reference&gt;</strong>
                <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:SignedInfo&gt;</strong>
                <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignatureValue&gt;</strong>aUDFmiG71<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:SignatureValue&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:Signature&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/B&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/A&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:Signature</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns:ds</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#"</span><span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"_6b02fb8a-30df-42c6-ba25-76eba02c8214"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignedInfo&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:CanonicalizationMethod</strong>
                <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignatureMethod</strong>
                <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Algorithm</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#rsa-sha1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:Reference</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">URI</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"#IDforA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                ...
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:Reference&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:SignedInfo&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;ds:SignatureValue&gt;</strong>q3tvRoGgc8cMUqUSzP6C21zb7tt04riPnDuk=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:SignatureValue&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/ds:Signature&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;root&gt;</strong></pre><p>The example shows that you can sign several elements and that for each
element a signature is created as sibling. The elements to be signed
must have an attribute of type ID. The ID type of the attribute must be
defined in the XML schema (see option&nbsp;<code class="literal">schemaResourceUri</code>).&nbsp;You
specify a list of XPATH expressions pointing to attributes of type ID
(see option <code class="literal">xpathsToIdAttributes</code>). These attributes determine the
elements to be signed. The elements are signed by the same key given by
the <code class="literal">keyAccessor</code> bean. Elements with higher (i.e. deeper) hierarchy level
are signed first. In the example, the element <code class="literal">C</code> is signed before the
element <code class="literal">A</code>.</p><p><span class="strong"><strong>Java DSL Example</strong></span></p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:detached"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlsecurity:sign://detached?keyAccessor=#keyAccessorBeant&amp;xpathsToIdAttributes=#xpathsToIdAttributesBean&amp;schemaResourceUri=Test.xsd"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlsecurity:verify://detached?keySelector=#keySelectorBean&amp;schemaResourceUri=org/apache/camel/component/xmlsecurity/Test.xsd"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Spring Example</strong></span></p><pre class="programlisting">  &nbsp;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xpathsToIdAttributesBean"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.util.ArrayList"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.util.Collection"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;list&gt;</strong>
              <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong>
                  <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.xmlsecurity.api.XmlSignatureHelper"</span>
                  <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">factory-method</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"getXpathFilter"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.lang.String"</span>
                      <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/ns:root/a/@ID"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
                  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg&gt;</strong>
                      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;map</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">key-type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.lang.String"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value-type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.lang.String"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
                          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;entry</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">key</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"ns"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://test"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
                      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/map&gt;</strong>
                  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constructor-arg&gt;</strong>
              <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/list&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constructor-arg&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
 <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:detached"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xmlsecurity:sign://detached?keyAccessor=#keyAccessorBean&amp;amp;xpathsToIdAttributes=#xpathsToIdAttributesBean&amp;amp;schemaResourceUri=Test.xsd"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xmlsecurity:verify://detached?keySelector=#keySelectorBean&amp;amp;schemaResourceUri=Test.xsd"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-XAdES-BESEPESfortheSignerEndpoint"></a>XAdES-BES/EPES for the Signer Endpoint</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-Headers">Headers</a></span></dt><dt><span class="section"><a href="XMLSecuritycomponent-XMLSecuritycomponent.html#XMLSecuritycomponent-LimitationswithregardtoXAdESversion1.4.2">Limitations with regard to XAdES version 1.4.2</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.15.0</strong></span>&nbsp;</p><p><a class="link" href="http://www.etsi.org/deliver/etsi_ts/101900_101999/101903/01.04.02_60/ts_101903v010402p.pdf" target="_top">XML
Advanced Electronic Signatures (XAdES)</a> defines extensions to XML
Signature. This standard was defined by the
<a class="link" href="http://www.etsi.org/" target="_top">European Telecommunication Standards Institute</a> and
allows you to create signatures which are compliant to the
<a class="link" href="http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=OJ:L:2000:013:0012:0020:EN:PDF" target="_top">European
Union Directive (1999/93/EC) on a Community framework for electronic
signatures</a>. XAdES defines different sets of signature properties which
are called signature forms. We support the signature forms <span class="strong"><strong>Basic
Electronic Signature</strong></span> (XAdES-BES) and <span class="strong"><strong>Explicit Policy Based Electronic
Signature</strong></span> (XAdES-EPES) for the Signer Endpoint. The forms
<span class="strong"><strong>Electronic&nbsp;</strong></span><span class="strong"><strong>Signature with Validation Data</strong></span>&nbsp;XAdES-T and XAdES-C
are not supported.</p><p>We support the following properties of the XAdES-EPES form ("?" denotes
zero or one occurrence):</p><p><span class="strong"><strong>Supported XAdES-EPES Properties</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;QualifyingProperties</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">Target&gt;</span>
    <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;SignedProperties&gt;</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;SignedSignatureProperties&gt;</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(SigningTime)?</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(SigningCertificate)?</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(SignaturePolicyIdentifier)</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(SignatureProductionPlace)?</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(SignerRole)?</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;/SignedSignatureProperties&gt;</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;SignedDataObjectProperties&gt;</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(DataObjectFormat)?</span>
            <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">(CommitmentTypeIndication)?</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;/SignedDataObjectProperties&gt;</span>
    <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;/SignedProperties&gt;</span>
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">&lt;/QualifyingProperties&gt;</span></pre><p>The properties of the XAdES-BES form are the same except that
the&nbsp;<code class="literal">SignaturePolicyIdentifier</code> property is not part of XAdES-BES.&nbsp;</p><p>You can configure the XAdES-BES/EPES properties via the
bean&nbsp;<code class="literal">org.apache.camel.component.xmlsecurity.api.XAdESSignatureProperties</code>
or&nbsp;<code class="literal">org.apache.camel.component.xmlsecurity.api.DefaultXAdESSignatureProperties. XAdESSignatureProperties</code>&nbsp;does
support all properties mentioned above except
the&nbsp;<code class="literal">SigningCertificate</code> property. To get
the&nbsp;<code class="literal">SigningCertificate</code> property, you must overwrite either the
method&nbsp;<code class="literal">XAdESSignatureProperties.getSigningCertificate()</code> or <code class="literal">XAdESSignatureProperties.getSigningCertificateChain()</code>.&nbsp;The
class&nbsp;<code class="literal">DefaultXAdESSignatureProperties</code>&nbsp;overwrites the
method&nbsp;<code class="literal">getSigningCertificate()</code>&nbsp;and allows you to specify the signing
certificate via a keystore and alias. The following example shows all
parameters you can specify. If you do not need certain parameters you
can just omit them.</p><p><span class="strong"><strong>XAdES-BES/EPES Example in Java DSL</strong></span></p><pre class="programlisting">&nbsp;Keystore keystore = ... <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// load a keystore</em>
DefaultKeyAccessor accessor = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultKeyAccessor();
accessor.setKeyStore(keystore);
accessor.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"password"</em></strong>);
accessor.setAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"cert_alias"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signer key alias</em>
&nbsp;
DefaultXAdESSignatureProperties props = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultXAdESSignatureProperties();
props.setNamespace(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://uri.etsi.org/01903/v1.3.2#"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// sets the namespace for the XAdES elements; the namspace is related to the XAdES version, default value is "http://uri.etsi.org/01903/v1.3.2#", other possible values are "http://uri.etsi.org/01903/v1.1.1#" and "http://uri.etsi.org/01903/v1.2.2#"</em>
props.setPrefix(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"etsi"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// sets the prefix for the XAdES elements, default value is "etsi"</em>
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signing certificate</em>
props.setKeystore(keystore));
props.setAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"cert_alias"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// specify the alias of the signing certificate in the keystore = signer key alias</em>
props.setDigestAlgorithmForSigningCertificate(DigestMethod.SHA256); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// possible values for the algorithm are "http://www.w3.org/2000/09/xmldsig#sha1", "http://www.w3.org/2001/04/xmlenc#sha256", "http://www.w3.org/2001/04/xmldsig-more#sha384", "http://www.w3.org/2001/04/xmlenc#sha512", default value is "http://www.w3.org/2001/04/xmlenc#sha256"</em>
props.setSigningCertificateURIs(Collections.singletonList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://certuri"</em></strong>));
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signing time</em>
props.setAddSigningTime(true);
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// policy</em>
props.setSignaturePolicy(XAdESSignatureProperties.SIG_POLICY_EXPLICIT_ID);
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// also the values XAdESSignatureProperties.SIG_POLICY_NONE ("None"), and XAdESSignatureProperties.SIG_POLICY_IMPLIED ("Implied")are possible, default value is XAdESSignatureProperties.SIG_POLICY_EXPLICIT_ID ("ExplicitId")</em>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// For "None" and "Implied" you must not specify any further policy parameters</em>
props.setSigPolicyId(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"urn:oid:1.2.840.113549.1.9.16.6.1"</em></strong>);
props.setSigPolicyIdQualifier(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"OIDAsURN"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//allowed values are empty string, "OIDAsURI", "OIDAsURN"; default value is empty string</em>
props.setSigPolicyIdDescription(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"invoice version 3.1"</em></strong>);
props.setSignaturePolicyDigestAlgorithm(DigestMethod.SHA256);<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// possible values for the algorithm are "http://www.w3.org/2000/09/xmldsig#sha1", http://www.w3.org/2001/04/xmlenc#sha256", "http://www.w3.org/2001/04/xmldsig-more#sha384", "http://www.w3.org/2001/04/xmlenc#sha512", default value is http://www.w3.org/2001/04/xmlenc#sha256"</em>
props.setSignaturePolicyDigestValue(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Ohixl6upD6av8N7pEvDABhEL6hM="</em></strong>);
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// you can add  qualifiers for the signature policy either by specifying text or an XML fragment with the root element "SigPolicyQualifier"</em>
props.setSigPolicyQualifiers(Arrays
    .asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;SigPolicyQualifier xmlns=\"http://uri.etsi.org/01903/v1.3.2#\"&gt;&lt;SPURI&gt;http://test.com/sig.policy.pdf&lt;/SPURI&gt;&lt;SPUserNotice&gt;&lt;ExplicitText&gt;display text&lt;/ExplicitText&gt;"</em></strong>
            + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;/SPUserNotice&gt;&lt;/SigPolicyQualifier&gt;"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"category B"</em></strong> }));
props.setSigPolicyIdDocumentationReferences(Arrays.asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/policy.doc.ref1.txt"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/policy.doc.ref2.txt"</em></strong> }));
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// production place</em>
props.setSignatureProductionPlaceCity(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Munich"</em></strong>);
props.setSignatureProductionPlaceCountryName(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Germany"</em></strong>);
props.setSignatureProductionPlacePostalCode(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"80331"</em></strong>);
props.setSignatureProductionPlaceStateOrProvince(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Bavaria"</em></strong>);
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//role</em>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// you can add claimed roles either by specifying text or an XML fragment with the root element "ClaimedRole"</em>
props.setSignerClaimedRoles(Arrays.asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"test"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;a:ClaimedRole xmlns:a=\"http://uri.etsi.org/01903/v1.3.2#\"&gt;&lt;TestRole&gt;TestRole&lt;/TestRole&gt;&lt;/a:ClaimedRole&gt;"</em></strong> }));
props.setSignerCertifiedRoles(Collections.singletonList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> XAdESEncapsulatedPKIData(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Ahixl6upD6av8N7pEvDABhEL6hM="</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://uri.etsi.org/01903/v1.2.2#DER"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"IdCertifiedRole"</em></strong>)));
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// data object format</em>
props.setDataObjectFormatDescription(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"invoice"</em></strong>);
props.setDataObjectFormatMimeType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"text/xml"</em></strong>);
props.setDataObjectFormatIdentifier(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"urn:oid:1.2.840.113549.1.9.16.6.2"</em></strong>);
props.setDataObjectFormatIdentifierQualifier(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"OIDAsURN"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//allowed values are empty string, "OIDAsURI", "OIDAsURN"; default value is empty string</em>
props.setDataObjectFormatIdentifierDescription(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"identifier desc"</em></strong>);
props.setDataObjectFormatIdentifierDocumentationReferences(Arrays.asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/dataobject.format.doc.ref1.txt"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/dataobject.format.doc.ref2.txt"</em></strong> }));
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//commitment</em>
props.setCommitmentTypeId(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"urn:oid:1.2.840.113549.1.9.16.6.4"</em></strong>);
props.setCommitmentTypeIdQualifier(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"OIDAsURN"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//allowed values are empty string, "OIDAsURI", "OIDAsURN"; default value is empty string</em>
props.setCommitmentTypeIdDescription(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"description for commitment type ID"</em></strong>);
props.setCommitmentTypeIdDocumentationReferences(Arrays.asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/commitment.ref1.txt"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://test.com/commitment.ref2.txt"</em></strong> }));
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// you can specify a commitment type qualifier either by simple text or an XML fragment with root element "CommitmentTypeQualifier"</em>
props.setCommitmentTypeQualifiers(Arrays.asList(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> String[] {<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"commitment qualifier"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&lt;c:CommitmentTypeQualifier xmlns:c=\"http://uri.etsi.org/01903/v1.3.2#\"&gt;&lt;C&gt;c&lt;/C&gt;&lt;/c:CommitmentTypeQualifier&gt;"</em></strong> }));
&nbsp;
beanRegistry.bind(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlSignatureProperties"</em></strong>,props);
beanRegistry.bind(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyAccessorDefault"</em></strong>,keyAccessor);
&nbsp;
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// you must reference the properties bean in the "xmlsecurity" URI</em>
from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:xades"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xmlsecurity:sign://xades?keyAccessor=#keyAccessorDefault&amp;properties=#xmlSignatureProperties"</em></strong>)
             .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>XAdES-BES/EPES Example in Spring XML</strong></span></p><pre class="programlisting">...
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:xades"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xmlsecurity:sign://xades?keyAccessor=#accessorRsa&amp;amp;properties=#xadesProperties"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
...
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xadesProperties"</span>
    <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.xmlsecurity.api.XAdESSignatureProperties"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- For more properties see the the previous Java DSL example.&nbsp;
         If you want to have a signing certificate then use the bean class DefaultXAdESSignatureProperties (see the previous Java DSL example). --&gt;</em>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signaturePolicy"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"ExplicitId"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sigPolicyId"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.test.com/policy.pdf"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sigPolicyIdDescription"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"factura"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signaturePolicyDigestAlgorithm"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://www.w3.org/2000/09/xmldsig#sha1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signaturePolicyDigestValue"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"Ohixl6upD6av8N7pEvDABhEL1hM="</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signerClaimedRoles"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signerClaimedRoles_XMLSigner"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"dataObjectFormatDescription"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"Factura electr&oacute;nica"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"dataObjectFormatMimeType"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"text/xml"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"java.util.ArrayList"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signerClaimedRoles_XMLSigner"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constructor-arg&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;list&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;value&gt;</strong>Emisor<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;value&gt;</strong>&amp;lt;ClaimedRole
                xmlns=&amp;quot;http://uri.etsi.org/01903/v1.3.2#&amp;quot;&amp;gt;&amp;lt;test
                xmlns=&amp;quot;http://test.com/&amp;quot;&amp;gt;test&amp;lt;/test&amp;gt;&amp;lt;/ClaimedRole&amp;gt;<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/list&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constructor-arg&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="XMLSecuritycomponent-Headers"></a>Headers</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="16%" class="col_1"><col width="17%" class="col_2"><col width="67%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Header</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESQualifyingPropertiesId</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>for the 'Id'
attribute value of <code class="literal">QualifyingProperties</code> element</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESSignedDataObjectPropertiesId</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>for the
'Id' attribute value of <code class="literal">SignedDataObjectProperties</code> element</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESSignedSignaturePropertiesId</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>for the
'Id' attribute value of&nbsp;<code class="literal">SignedSignatureProperties</code> element</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESDataObjectFormatEncoding</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>for the value
of the Encoding element of the <code class="literal">DataObjectFormat</code> element</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESNamespace</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>&nbsp;overwrites the XAdES
namespace parameter value</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">CamelXmlSignatureXAdESPrefix</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>overwrites the XAdES prefix
parameter value</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="XMLSecuritycomponent-LimitationswithregardtoXAdESversion1.4.2"></a>Limitations with regard to XAdES version 1.4.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">No support for signature form XAdES-T and XAdES-C</li><li class="listitem">Only signer part implemented. Verifier part currently not available.</li><li class="listitem">No support&nbsp;for the <code class="literal">QualifyingPropertiesReference</code> element (see
section 6.3.2 of spec).</li><li class="listitem">No support for the <code class="literal">Transforms</code> element contained in
the&nbsp;<code class="literal">SignaturePolicyId</code> element contained in
the&nbsp;<code class="literal">SignaturePolicyIdentifier element</code></li><li class="listitem">No support of the <code class="literal">CounterSignature</code> element &#8594; no support for
the&nbsp;<code class="literal">UnsignedProperties</code> element</li><li class="listitem">At most one <code class="literal">DataObjectFormat</code> element. More than one
<code class="literal">DataObjectFormat</code> element makes no sense because we have only one data
object which is signed (this is the incoming message body to the XML
signer endpoint).</li><li class="listitem">At most one <code class="literal">CommitmentTypeIndication</code> element. More than one
<code class="literal">CommitmentTypeIndication</code> element makes no sense &nbsp;because we have only
one data object which is signed (this is the incoming message body to
the XML signer endpoint).</li><li class="listitem">A <code class="literal">CommitmentTypeIndication</code> element contains always the
<code class="literal">AllSignedDataObjects</code> element. The <code class="literal">ObjectReference</code> element within
<code class="literal">CommitmentTypeIndication</code> element is not supported.</li><li class="listitem">The <code class="literal">AllDataObjectsTimeStamp</code> element is not supported</li><li class="listitem">The <code class="literal">IndividualDataObjectsTimeStamp</code> element is not supported</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="XMLSecuritycomponent-SeeAlso"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="http://www.w3.org/TR/xmldsig-bestpractices/" target="_top">Best Practices</a></li></ul></div></div></div></body></html>
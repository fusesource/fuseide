<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>HTTP4</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-HTTP.html" title="HTTP"><link rel="next" href="IDU-iBATIS.html" title="iBATIS"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-HTTP4"></a>HTTP4</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HTTP4Component"></a>HTTP4 Component</h2></div></div></div><p><span class="bold"><strong>Available as of Camel 2.3</strong></span>
    </p><p>The <span class="bold"><strong>http4:</strong></span> component provides HTTP-based <span class="phrase">endpoints</span> for calling external
            HTTP resources (as a client to call external servers using HTTP).</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code> for this component:</p><pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-http4&lt;/artifactId&gt;
    &lt;version&gt;x.x.x&lt;/version&gt;
    &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: camel-http4 vs camel-http"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">camel-http4 vs camel-http</th></tr><tr><td align="left" valign="top"><p>Camel-http4 uses Apache HttpClient 4.x while camel-http uses Apache HttpClient
                3.x.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e103734"></a>Camel on EAP deployment</h2></div></div></div><p>This component is supported by the Camel on EAP (Wildfly Camel) framework, which
            offers a simplified deployment model on the Red Hat JBoss Enterprise Application Platform (JBoss EAP) container.
 </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">http4:hostname[:port][/resourceUri][?options]</pre><p>Will by default use port 80 for HTTP and 443 for HTTPS.</p><p>You can append query options to the URI in the following format, <code class="literal">?option=value&amp;option=value&amp;...</code>
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: camel-http4 vs camel-jetty"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">camel-http4 vs camel-jetty</th></tr><tr><td align="left" valign="top"><p>You can only produce to endpoints generated by the HTTP4 component. Therefore it should never be used as input into your Camel Routes. To bind/expose an HTTP endpoint via a HTTP server as input to a Camel route, use the <a href="IDU-Jetty.html" class="olink">Jetty Component</a> instead.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HttpComponentOptions"></a>HttpComponent Options</h2></div></div></div><p>

    </p><table id="d0e103768"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">maxTotalConnections</code>
        </td>
        <td><code class="literal">200</code>
        </td>
        <td> The maximum number of connections. </td>
      </tr><tr>
        <td><code class="literal">connectionsPerRoute</code>
        </td>
        <td><code class="literal">20</code>
        </td>
        <td> The maximum number of connections per route. </td>
      </tr><tr>
        <td><code class="literal">cookieStore</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.2/2.12.0:</strong></span> To use a custom <code class="literal">org.apache.http.client.CookieStore</code>. By default the <code class="literal">org.apache.http.impl.client.BasicCookieStore</code> is used which is an in-memory only cookie store. Notice if <code class="literal">bridgeEndpoint=true</code> then the cookie store is forced to be a noop cookie store as cookies shouldn't be stored as we are just bridging (eg acting as a proxy). </td>
      </tr><tr>
        <td><code class="literal">httpClientConfigurer</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Reference to a <code class="literal">org.apache.camel.component.http.HttpClientConfigurer</code> in the Registry. </td>
      </tr><tr>
        <td><code class="literal">clientConnectionManager</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> To use a custom <code class="literal">org.apache.http.conn.ClientConnectionManager</code>. </td>
      </tr><tr>
        <td><code class="literal">httpBinding</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> To use a custom <code class="literal">org.apache.camel.component.http.HttpBinding</code>. </td>
      </tr><tr>
        <td><code class="literal">httpContext</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> <span class="bold"><strong>Camel 2.9.2:</strong></span> To use a custom <code class="literal">org.apache.http.protocol.HttpContext</code> when executing requests. </td>
      </tr><tr>
        <td><code class="literal">sslContextParameters</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> <span class="bold"><strong>Camel 2.8:</strong></span> To use a custom
            <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code>. See <a class="xref" href="IDU-HTTP4.html#IDU-HTTP4_HSH_UsingtheJSSEConfigurationUtility" title="Using the JSSE Configuration Utility">Using the JSSE Configuration Utility</a> </td>
      </tr><tr>
        <td><code class="literal">x509HostnameVerifier</code>
        </td>
        <td><code class="literal">BrowserCompatHostnameVerifier</code>
        </td>
        <td> <span class="bold"><strong>Camel 2.7:</strong></span> You can refer to a different <code class="literal">org.apache.http.conn.ssl.X509HostnameVerifier</code> instance in the Registry such as <code class="literal">org.apache.http.conn.ssl.StrictHostnameVerifier</code> or <code class="literal">org.apache.http.conn.ssl.AllowAllHostnameVerifier</code>. </td>
      </tr><tr>
        <td><code class="literal">connectionTimeToLive</code>
        </td>
        <td><code class="literal">-1</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.0:</strong></span> The time for connection to live, the time unit is millisecond, the default value is always keep alive. </td>
      </tr><tr>
                <td><code class="literal">allowJavaSerializedObject</code></td>
                <td><code class="literal">false</code>
                </td>
                <td>
                    <p><span class="bold"><strong>Camel 2.16.1/2.15.5:</strong></span> Whether to allow
                        java serialization when a request uses
                            <code class="code">context-type=application/x-java-serialized-object</code>. This
                        option is turned off by default. <span class="bold"><strong>Warning:</strong></span>
                        If you enable this option, then be aware that Java will deserialize the
                        incoming data from the request to Java, and that can be a potential security
                        risk.</p>
                </td>
            </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HttpEndpointOptions"></a>HttpEndpoint Options</h2></div></div></div><p>

    </p><table id="d0e104011"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">throwExceptionOnFailure</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td> Option to disable throwing the <code class="literal">HttpOperationFailedException</code> in case of failed responses from the remote server. This allows you to get all responses regardless of the HTTP status code. </td>
      </tr><tr>
        <td><code class="literal">bridgeEndpoint</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td> If true, HttpProducer will ignore the Exchange.HTTP_URI header, and use the endpoint's URI for request. You may also set the <span class="bold"><strong>throwExcpetionOnFailure</strong></span> to be false to let the HttpProducer send all fault responses back. Also if set to true HttpProducer and CamelServlet will skip the gzip processing if the content-encoding is "gzip". </td>
      </tr><tr>
        <td><code class="literal">clearExpiredCookies</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.2/2.12.0:</strong></span> Whether to clear expired cookies before sending the HTTP request. This ensures the cookies store does not keep growing by adding new cookies which is newer removed when they are expired. </td>
      </tr><tr>
        <td><code class="literal">cookieStore</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.2/2.12.0:</strong></span> To use a custom <code class="literal">org.apache.http.client.CookieStore</code>. By default the <code class="literal">org.apache.http.impl.client.BasicCookieStore</code> is used which is an in-memory only cookie store. Notice if <code class="literal">bridgeEndpoint=true</code> then the cookie store is forced to be a noop cookie store as cookies shouldn't be stored as we are just bridging (eg acting as a proxy). </td>
      </tr><tr>
        <td><code class="literal">disableStreamCache</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td> DefaultHttpBinding will copy the request input stream into a stream cache and put it
                    into the message body if this option is false to support multiple reads,
                    otherwise DefaultHttpBinding will set the request input stream directly in the
                    message body. <span class="bold"><strong>Camel 2.17:</strong></span> this option is now
                    also supported by the producer to allow using the response stream directly
                    instead of stream caching as by default.</td>
      </tr><tr>
        <td><code class="literal">headerFilterStrategy</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> <span class="bold"><strong>Camel 2.10.4:</strong></span> Reference to a instance of <code class="literal">org.apache.camel.spi.HeaderFilterStrategy</code> in the Registry.&nbsp;t will be used to apply the custom headerFilterStrategy on the new create HttpEndpoint. </td>
      </tr><tr>
        <td><code class="literal">httpBindingRef</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> <span class="bold"><strong>Deprecated and will be removed in Camel 3.0:</strong></span> Reference to a <code class="literal">org.apache.camel.component.http.HttpBinding</code> in the Registry. Use the <code class="literal">httpBinding</code> option instead. </td>
      </tr><tr>
        <td><code class="literal">httpBinding</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> To use a custom <code class="literal">org.apache.camel.component.http.HttpBinding</code>. </td>
      </tr><tr>
        <td><code class="literal">httpClientConfigurer</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Reference to a <code class="literal">org.apache.camel.component.http.HttpClientConfigurer</code> in the Registry. </td>
      </tr><tr>
        <td><code class="literal">httpContext</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>Camel 2.9.2:</strong></span> To use a custom <code class="literal">org.apache.http.protocol.HttpContext</code> when executing requests. </td>
      </tr><tr>
        <td><code class="literal">httpClient.XXX</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><p>Setting options on the <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/BasicHttpParams.html" target="_top">BasicHttpParams</a>. For instance
                            <code class="literal">httpClient.soTimeout=5000</code> will set the
                            <code class="literal">SO_TIMEOUT</code> to 5 seconds. Look on the setter methods
                        of the following parameter beans for a complete reference: <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/auth/params/AuthParamBean.html" target="_top">AuthParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/params/ClientParamBean.html" target="_top">ClientParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/params/ConnConnectionParamBean.html" target="_top">ConnConnectionParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/params/ConnRouteParamBean.html" target="_top">ConnRouteParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/cookie/params/CookieSpecParamBean.html" target="_top">CookieSpecParamBean</a>, <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/HttpConnectionParamBean.html" target="_top">HttpConnectionParamBean</a> and <a class="link" href="http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/params/HttpProtocolParamBean.html" target="_top">HttpProtocolParamBean</a></p>
            <p><span class="strong"><strong>Since Camel 2.13.0: </strong></span>
                        <code class="code">httpClient</code> is changed to configure the <a class="link" href="https://hc.apache.org/httpcomponents-client-4.3.x/httpclient/apidocs/org/apache/http/impl/client/HttpClientBuilder.html" target="_top">HttpClientBuilder</a> and <a class="link" href="https://hc.apache.org/httpcomponents-client-4.3.x/httpclient/apidocs/org/apache/http/client/config/RequestConfig.Builder.html" target="_top">RequestConfig.Builder</a>, please check out API document for a
                        complete reference. For example, use
                            <code class="code">httpClient.socketTimeout=5000</code> to set the socket timeout to
                        5 seconds.</p>
                </td>
      </tr><tr>
        <td><code class="literal">clientConnectionManager</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> To use a custom <code class="literal">org.apache.http.conn.ClientConnectionManager</code>. </td>
      </tr><tr>
        <td><code class="literal">transferException</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td> If enabled and an <a class="link" href="Exchange" target="_top">Exchange</a> failed processing on the
                    consumer side, and if the caused <code class="literal">Exception</code> was send back
                    serialized in the response as a
                        <code class="literal">application/x-java-serialized-object</code> content type (for
                    example using <a href="IDU-Jetty.html" class="olink">Jetty</a> or <a href="IDU-SERVLET.html" class="olink">SERVLET</a> Camel components). On the producer
                    side the exception will be deserialized and thrown as is, instead of the
                        <code class="literal">HttpOperationFailedException</code>. The caused exception is
                    required to be serialized. </td>
      </tr><tr>
        <td><code class="literal">sslContextParameters</code>
        </td>
        <td><code class="literal">null</code>
        </td>
          <td><span class="bold"><strong>Camel 2.11.1:</strong></span> Reference to a <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> in the Registry.  <span class="bold"><strong>Important:</strong></span> Only one instance of <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> is supported per HttpComponent. If you need to use 2 or more different instances, you need to define a new HttpComponent per instance you need. See further below for more details. See <a class="xref" href="IDU-HTTP4.html#IDU-HTTP4_HSH_UsingtheJSSEConfigurationUtility" title="Using the JSSE Configuration Utility">Using the JSSE Configuration Utility</a>. </td>
      </tr><tr>
        <td><code class="literal">x509HostnameVerifier</code>
        </td>
        <td><code class="literal">BrowserCompatHostnameVerifier</code>
        </td>
        <td><span class="bold"><strong>Camel 2.7:</strong></span> You can refer to a different <code class="literal">org.apache.http.conn.ssl.X509HostnameVerifier</code> instance in the Registry such as <code class="literal">org.apache.http.conn.ssl.StrictHostnameVerifier</code> or <code class="literal">org.apache.http.conn.ssl.AllowAllHostnameVerifier</code>. </td>
      </tr><tr>
            <td>
                <p><code class="code">maxTotalConnections</code></p>
            </td>
            <td>
                <p><code class="code">null</code></p>
            </td>
            <td>
                <p><span class="bold"><strong>Camel 2.14:</strong></span> The maximum number of total
                        connections that the connection manager has. If this option is not set,
                        camel will use the component's setting instead.</p>
            </td>
        </tr><tr>
            <td>
                <p><code class="code">connectionsPerRoute</code></p>
            </td>
            <td>
                <p><code class="code">null</code></p>
            </td>
            <td>
                <p><span class="bold"><strong>Camel 2.14:</strong></span> The maximum number of connections
                        per route. If this option is not set, camel will use the component's setting
                        instead.</p>
            </td>
        </tr><tr>
            <td>
                <p><code class="code">authenticationPreemptive</code></p>
            </td>
            <td>
                <p><code class="code">false</code></p>
            </td>
            <td>
                <p><span class="bold"><strong>Camel 2.11.3/2.12.2:</strong></span> If this option is true,
                        camel-http4 sends preemptive basic authentication to the server.</p>
            </td>
        </tr><tr>
                <td><code class="literal">eagerCheckContentAvailable</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td><span class="bold"><strong>Camel 2.15.3/2.16:</strong></span> Consumer only. Whether to
                    eager check whether the HTTP requests has content if the Content-Length header
                    is 0 or not present. This can be turned on in case HTTP clients do not send
                    streamed data. </td>
            </tr><tr>
                <td><code class="literal">copyHeaders</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td><span class="bold"><strong>Camel 2.16:</strong></span> If <code class="code">true</code>, IN exchange
                    headers will be copied to OUT exchange headers in accordance with the copy
                    strategy. If <code class="code">false</code>, only the headers from the HTTP response will be
                    included (IN headers will not be copied).</td>
            </tr><tr>
                <td><code class="literal">okStatusCodeRange</code>
                </td>
                <td><code class="literal">200-299</code>
                </td>
                <td><span class="bold"><strong>Camel 2.16:</strong></span> The status codes which are
                    considered a success response. The values are inclusive. The range must be
                    defined using the syntax,
                            <code class="code"><em class="replaceable"><code>from</code></em>-<em class="replaceable"><code>to</code></em></code>.</td>
            </tr><tr>
                <td><code class="literal">ignoreResponseBody</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td><span class="bold"><strong>Camel 2.16:</strong></span> If <code class="code">true</code>, the http
                    producer will not read the response body and cache the input stream.</td>
            </tr><tr>
                <td><code class="literal">connectionClose</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td><span class="bold"><strong>Camel 2.18:</strong></span> If this option is <span class="bold"><strong>true</strong></span>, the producer will add a <code class="literal">Connection Close</code> header to the HTTP Request.
                </td>
            </tr></table><p>The following authentication options can also be set on the HttpEndpoint:</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_SettingBasicAuthenticationandProxy"></a>Setting Basic Authentication and Proxy</h2></div></div></div><p><span class="bold"><strong>Before Camel 2.8.0</strong></span>

    </p><table id="d0e104581"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">username</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Username for authentication. </td>
      </tr><tr>
        <td><code class="literal">password</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Password for authentication. </td>
      </tr><tr>
        <td><code class="literal">domain</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The domain name for authentication. </td>
      </tr><tr>
        <td><code class="literal">host</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The host name authentication. </td>
      </tr><tr>
        <td><code class="literal">proxyHost</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy host name </td>
      </tr><tr>
        <td><code class="literal">proxyPort</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy port number </td>
      </tr><tr>
        <td><code class="literal">proxyUsername</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Username for proxy authentication </td>
      </tr><tr>
        <td><code class="literal">proxyPassword</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Password for proxy authentication </td>
      </tr><tr>
        <td><code class="literal">proxyDomain</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy domain name </td>
      </tr><tr>
        <td><code class="literal">proxyNtHost</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy Nt host name </td>
      </tr><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">authUsername</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Username for authentication </td>
      </tr><tr>
        <td><code class="literal">authPassword</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Password for authentication </td>
      </tr><tr>
        <td><code class="literal">authDomain</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The domain name for authentication </td>
      </tr><tr>
        <td><code class="literal">authHost</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The host name authentication </td>
      </tr><tr>
        <td><code class="literal">proxyAuthHost</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy host name </td>
      </tr><tr>
        <td><code class="literal">proxyAuthPort</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy port number </td>
      </tr><tr>
        <td><code class="literal">proxyAuthScheme</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy scheme, will fallback and use the scheme from the endpoint if not configured. </td>
      </tr><tr>
        <td><code class="literal">proxyAuthUsername</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Username for proxy authentication </td>
      </tr><tr>
        <td><code class="literal">proxyAuthPassword</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> Password for proxy authentication </td>
      </tr><tr>
        <td><code class="literal">proxyAuthDomain</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy domain name </td>
      </tr><tr>
        <td><code class="literal">proxyAuthNtHost</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> The proxy Nt host name </td>
      </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_MessageHeaders"></a>Message Headers</h2></div></div></div><p>

    </p><table id="d0e104927"><tr>
        <th> Name </th>
        <th> Type </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_URI</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> URI to call. Will override existing URI set directly on the endpoint. This URI is the
                    URI of the HTTP server to call. Its not the same as the Camel endpoint URI,
                    where you can configure endpoint options such as security and so on. This header
                    does not support that, its only the UTI of the HTTP server.</td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_PATH</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> Request URI's path, the header will be used to build the request URI with the HTTP_URI. </td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_QUERY</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> URI parameters. Will override existing URI parameters set directly on the endpoint. </td>
      </tr><tr>
        <td><code class="literal">Exchange.HTTP_RESPONSE_CODE</code>
        </td>
        <td><code class="literal">int</code>
        </td>
        <td> The HTTP response code from the external server. Is 200 for OK. </td>
      </tr><tr>
                <td><code class="literal">Exchange.HTTP_RESPONSE_TEXT</code>
                </td>
                <td><code class="literal">String</code>
                </td>
                <td> The HTTP response text from the external server.</td>
            </tr><tr>
        <td><code class="literal">Exchange.HTTP_CHARACTER_ENCODING</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> Character encoding. </td>
      </tr><tr>
        <td><code class="literal">Exchange.CONTENT_TYPE</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> The HTTP content type. Is set on both the IN and OUT message to provide a content type, such as <code class="literal">text/html</code>. </td>
      </tr><tr>
        <td><code class="literal">Exchange.CONTENT_ENCODING</code>
        </td>
        <td><code class="literal">String</code>
        </td>
        <td> The HTTP content encoding. Is set on both the IN and OUT message to provide a content encoding, such as <code class="literal">gzip</code>. </td>
      </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_MessageBody"></a>Message Body</h2></div></div></div><p>Camel will store the HTTP response from the external server on the OUT body. All headers from the IN message will be copied to the OUT message, so headers are preserved during routing. Additionally Camel will add the HTTP response headers as well to the OUT message headers.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_Responsecode"></a>Response code</h2></div></div></div><p>Camel will handle according to the HTTP response code:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Response code is in the range 100..299, Camel regards it as a success response.</p></li><li class="listitem"><p>Response code is in the range 300..399, Camel regards it as a redirection response and will throw a <code class="literal">HttpOperationFailedException</code> with the information.</p></li><li class="listitem"><p>Response code is 400+, Camel regards it as an external server failure and will throw a <code class="literal">HttpOperationFailedException</code> with the information.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: throwExceptionOnFailure"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">throwExceptionOnFailure</th></tr><tr><td align="left" valign="top"><p>The option, <code class="literal">throwExceptionOnFailure</code>, can be set to <code class="literal">false</code> to prevent the <code class="literal">HttpOperationFailedException</code> from being thrown for failed response codes. This allows you to get any response from the remote server.
There is a sample below demonstrating this.</p></td></tr></table></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HttpOperationFailedException"></a>HttpOperationFailedException</h2></div></div></div><p>This exception contains the following information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The HTTP status code</p></li><li class="listitem"><p>The HTTP status line (text of the status code)</p></li><li class="listitem"><p>Redirect location, if server returned a redirect</p></li><li class="listitem"><p>Response body as a <code class="literal">java.lang.String</code>, if server provided a body as response</p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_CallingusingGETorPOST"></a>Calling using GET or POST</h2></div></div></div><p>The following algorithm is used to determine whether the <code class="literal">GET</code> or <code class="literal">POST</code> HTTP method should be used:
1. Use method provided in header.
2. <code class="literal">GET</code> if query string is provided in header.
3. <code class="literal">GET</code> if endpoint is configured with a query string.
4. <code class="literal">POST</code> if there is data to send (body is not null).
5. <code class="literal">GET</code> otherwise.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HowtogetaccesstoHttpServletRequestandHttpServletResponse"></a>How to get access to HttpServletRequest and HttpServletResponse</h2></div></div></div><p>You can get access to these two using the Camel type converter system using
<span class="bold"><strong>NOTE</strong></span> You can get the request and response not just from the processor after the camel-jetty or camel-cxf endpoint.</p><pre class="programlisting">
HttpServletRequest request = exchange.getIn().getBody(HttpServletRequest.class);
HttpServletRequest response = exchange.getIn().getBody(HttpServletResponse.class);
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_ConfiguringURItocall"></a>Configuring URI to call</h2></div></div></div><p>You can set the HTTP producer's URI directly form the endpoint URI. In the route below, Camel will call out to the external server, <code class="literal">oldhost</code>, using HTTP.</p><pre class="programlisting">
from("direct:start")
	    .to("http4://oldhost");
</pre><p>And the equivalent Spring sample:</p><pre class="programlisting">
&lt;camelContext xmlns="http://activemq.apache.org/camel/schema/spring"&gt;
  &lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;to uri="http4://oldhost"/&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;
</pre><p>You can override the HTTP endpoint URI by adding a header with the key, <code class="literal">Exchange.HTTP_URI</code>, on the message.</p><pre class="programlisting">from("direct:start")
  .setHeader(Exchange.HTTP_URI, constant("http://newhost"))
  .to("http4://oldhost");</pre><p>In the sample above Camel will call the http://newhost despite the endpoint is configured with http4://oldhost. If the http4 endpoint is working in bridge
      mode, it will ignore the message header of <code class="literal">Exchange.HTTP_URI</code>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_ConfiguringURIParameters"></a>Configuring URI Parameters</h2></div></div></div><p>The <span class="bold"><strong>http</strong></span> producer supports URI parameters to be sent to the HTTP server. The URI parameters can either be set directly on the endpoint URI or as a header with the key <code class="literal">Exchange.HTTP_QUERY</code> on the message.</p><pre class="programlisting">
from("direct:start")
 .to("http4://oldhost?order=123&amp;detail=short");
</pre><p>Or options provided in a header:</p><pre class="programlisting">
from("direct:start")
  .setHeader(Exchange.HTTP_QUERY, constant("order=123&amp;detail=short"))
  .to("http4://oldhost");
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_HowtosetthehttpmethodGETPOSTPUTDELETEHEADOPTIONSTRACEtotheHTTPproducer"></a>How to set the http method (GET/POST/PUT/DELETE/HEAD/OPTIONS/TRACE) to the HTTP producer</h2></div></div></div><p>The HTTP4 component provides a way to set the HTTP request method by setting the message header. Here is an example:</p><pre class="programlisting">
from("direct:start")
  .setHeader(Exchange.HTTP_METHOD, constant(org.apache.camel.component.http4.HttpMethods.POST))
  .to("http4://www.google.com")
  .to("mock:results");
</pre><p>The method can be written a bit shorter using the string constants:</p><pre class="programlisting">
.setHeader("CamelHttpMethod", constant("POST"))
</pre><p>And the equivalent Spring sample:</p><pre class="programlisting">
&lt;camelContext xmlns="http://activemq.apache.org/camel/schema/spring"&gt;
  &lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;setHeader headerName="CamelHttpMethod"&gt;
        &lt;constant&gt;POST&lt;/constant&gt;
    &lt;/setHeader&gt;
    &lt;to uri="http4://www.google.com"/&gt;
    &lt;to uri="mock:results"/&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_UsingclienttimeoutSOTIMEOUT"></a>Using client timeout - SO_TIMEOUT</h2></div></div></div><p>See the <a class="link" href="https://svn.apache.org/repos/asf/camel/trunk/components/camel-http4/src/test/java/org/apache/camel/component/http4/HttpSOTimeoutTest.java" target="_top">HttpSOTimeoutTest</a> unit test.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_ConfiguringaProxy"></a>Configuring a Proxy</h2></div></div></div><p>The HTTP4 component provides a way to configure a proxy.</p><pre class="programlisting">
from("direct:start")
  .to("http4://oldhost?proxyAuthHost=www.myproxy.com&amp;proxyAuthPort=80");
</pre><p>There is also support for proxy authentication via the <code class="literal">proxyAuthUsername</code> and <code class="literal">proxyAuthPassword</code> options.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_UsingproxysettingsoutsideofURI"></a>Using proxy settings outside of URI</h2></div></div></div><p>To avoid System properties conflicts, you can set proxy configuration only from the CamelContext or URI.
Java DSL :</p><pre class="programlisting">
 context.getProperties().put("http.proxyHost", "172.168.18.9");
 context.getProperties().put("http.proxyPort" "8080");
</pre><p>Spring XML</p><pre class="programlisting">
   &lt;camelContext&gt;
       &lt;properties&gt;
           &lt;property key="http.proxyHost" value="172.168.18.9"/&gt;
           &lt;property key="http.proxyPort" value="8080"/&gt;
      &lt;/properties&gt;
   &lt;/camelContext&gt;
</pre><p>Camel will first set the settings from Java System or CamelContext Properties and then the endpoint proxy options if provided.
So you can override the system properties with the endpoint options.</p><p>Notice in <span class="bold"><strong>Camel 2.8</strong></span> there is also a <code class="literal">http.proxyScheme</code> property you can set to explicit configure the scheme to use.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_Configuringcharset"></a>Configuring charset</h2></div></div></div><p>If you are using <code class="literal">POST</code> to send data you can configure the <code class="literal">charset</code> using the <code class="literal">Exchange</code> property:</p><pre class="programlisting">
exchange.setProperty(Exchange.CHARSET_NAME, "ISO-8859-1");
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_Samplewithscheduledpoll"></a>Sample with scheduled poll</h2></div></div></div><p>This sample polls the Google homepage every 10 seconds and write the page to the file <code class="literal">message.html</code>:</p><pre class="programlisting">
from("timer://foo?fixedRate=true&amp;delay=0&amp;period=10000")
    .to("http4://www.google.com")
    .setHeader(FileComponent.HEADER_FILE_NAME, "message.html")
    .to("file:target/google");
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_URIParametersfromtheendpointURI"></a>URI Parameters from the endpoint URI</h2></div></div></div><p>In this sample we have the complete URI endpoint that is just what you would have typed in a web browser. Multiple URI parameters can of course be set using the <code class="literal">&amp;</code> character as separator, just as you would in the web browser. Camel does no tricks here.</p><pre class="programlisting">
// we query for Camel at the Google page
template.sendBody("http4://www.google.com/search?q=Camel", null);
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_URIParametersfromtheMessage"></a>URI Parameters from the Message</h2></div></div></div><pre class="programlisting">
Map headers = new HashMap();
headers.put(Exchange.HTTP_QUERY, "q=Camel&amp;lr=lang_en");
// we query for Camel and English language at Google
template.sendBody("http4://www.google.com/search", null, headers);
</pre><p>In the header value above notice that it should <span class="bold"><strong>not</strong></span> be prefixed with <code class="literal">?</code> and you can separate parameters as usual with the <code class="literal">&amp;</code> char.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_GettingtheResponseCode"></a>Getting the Response Code</h2></div></div></div><p>You can get the HTTP response code from the HTTP4 component by getting the value from the
            Out message header with <code class="literal">Exchange.HTTP_RESPONSE_CODE</code>.</p><pre class="programlisting">Exchange exchange = template.send("http4://www.google.com/search", new Processor() {
  public void process(Exchange exchange) throws Exception {
    exchange.getIn().setHeader(Exchange.HTTP_QUERY, constant("hl=en&amp;q=activemq"));
  }
});
Message out = exchange.getOut();
int responseCode = out.getHeader(Exchange.HTTP_RESPONSE_CODE, Integer.class);</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_DisablingCookies"></a>Disabling Cookies</h2></div></div></div><p>To disable cookies you can set the HTTP Client to ignore cookies by adding this URI option:
<code class="literal">httpClient.cookiePolicy=ignoreCookies</code>
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_AdvancedUsage"></a>Advanced Usage</h2></div></div></div><p>If you need more control over the HTTP producer you should use the <code class="literal">HttpComponent</code> where you can set various classes to give you custom behavior.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_UsingtheJSSEConfigurationUtility"></a>Using the JSSE Configuration Utility</h2></div></div></div><p>As of Camel 2.8, the HTTP4 component supports SSL/TLS configuration through the <a href="IDU-HTTP.html#IDU-HTTP_HSH_UsingtheJSSEConfigurationUtility" class="olink">Camel JSSE Configuration Utility</a>. 
          This utility greatly decreases the amount of component specific code you need to write and is configurable 
          at the endpoint and component levels.&nbsp;The following examples demonstrate how to use the utility with the HTTP4 component.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_Programmaticconfigurationofthecomponent"></a>Programmatic configuration of the component</h2></div></div></div><pre class="programlisting">KeyStoreParameters ksp = new KeyStoreParameters();
ksp.setResource("/users/home/server/keystore.jks");
ksp.setPassword("keystorePassword");

KeyManagersParameters kmp = new KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword("keyPassword");

SSLContextParameters scp = new SSLContextParameters();
scp.setKeyManagers(kmp);

HttpComponent httpComponent = getContext().getComponent("https4", HttpComponent.class);
httpComponent.setSslContextParameters(scp);</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</h2></div></div></div><pre class="programlisting">...
  &lt;camel:sslContextParameters
      id="sslContextParameters"&gt;
    &lt;camel:keyManagers
        keyPassword="keyPassword"&gt;
      &lt;camel:keyStore
          resource="/users/home/server/keystore.jks"
          password="keystorePassword"/&gt;
    &lt;/camel:keyManagers&gt;
  &lt;/camel:sslContextParameters&gt;...
...
  &lt;to uri="https4://127.0.0.1/mail/?sslContextParametersRef=sslContextParameters"/&gt;...</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_ConfiguringApacheHTTPClientDirectly"></a>Configuring Apache HTTP Client Directly</h2></div></div></div><p>Basically camel-http4 component is built on the top of <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/" target="_top">Apache HttpClient</a>.
            Please refer to <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d4e537" target="_top">SSL/TLS customization</a> for details or have a look into the
                <code class="literal">org.apache.camel.component.http4.HttpsServerTestSupport</code> unit test
            base class. You can also implement a custom
                <code class="literal">org.apache.camel.component.http4.HttpClientConfigurer</code> to do some
            configuration on the http client if you need full control of it.</p><p>However if you <span class="emphasis"><em>just</em></span> want to specify the keystore and truststore you can do this with Apache HTTP <code class="literal">HttpClientConfigurer</code>, for example:</p><pre class="programlisting">
KeyStore keystore = ...;
KeyStore truststore = ...;

SchemeRegistry registry = new SchemeRegistry();
registry.register(new Scheme("https", 443, new SSLSocketFactory(keystore, "mypassword", truststore)));
</pre><p>And then you need to create a class that implements <code class="literal">HttpClientConfigurer</code>, and registers https protocol providing a keystore or truststore per example above. Then, from your camel route builder class you can hook it up like so:</p><pre class="programlisting">
HttpComponent httpComponent = getContext().getComponent("http4", HttpComponent.class);
httpComponent.setHttpClientConfigurer(new MyHttpClientConfigurer());
</pre><p>If you are doing this using the Spring DSL, you can specify your <code class="literal">HttpClientConfigurer</code> using the URI.  For example:</p><pre class="programlisting">
&lt;bean id="myHttpClientConfigurer"
 class="my.https.HttpClientConfigurer"&gt;
&lt;/bean&gt;

&lt;to uri="https4://myhostname.com:443/myURL?httpClientConfigurer=myHttpClientConfigurer"/&gt;
</pre><p>As long as you implement the HttpClientConfigurer and configure your keystore and truststore as described above, it will work fine.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_UsingHTTPStoauthenticategotchas"></a>Using HTTPS to authenticate gotchas</h2></div></div></div><p>An end user reported that he had problem with authenticating with HTTPS. The problem was eventually resolved by providing a custom configured <code class="literal">org.apache.http.protocol.HttpContext</code>:</p><p>1. Create a (Spring) factory for HttpContexts:</p><pre class="programlisting">
public class HttpContextFactory {

  private String httpHost = "localhost";
  private String httpPort = 9001;

  private BasicHttpContext httpContext = new BasicHttpContext();
  private BasicAuthCache authCache = new BasicAuthCache();
  private BasicScheme basicAuth = new BasicScheme();

  public HttpContext getObject() {
    authCache.put(new HttpHost(httpHost, httpPort), basicAuth);

    httpContext.setAttribute(ClientContext.AUTH_CACHE, authCache);

    return httpContext;
  }

  // getter and setter
}
</pre><p>2. Declare an HttpContext in the Spring application context file:</p><pre class="programlisting">
&lt;bean id="myHttpContext" factory-bean="httpContextFactory" factory-method="getObject"/&gt;
</pre><p>3. Reference the context in the http4 URL:</p><pre class="programlisting">
&lt;to uri="https4://myhostname.com:443/myURL?httpContext=myHttpContext"/&gt;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-HTTP4_HSH_UsingdifferentSSLContextParameters"></a>Using different SSLContextParameters</h2></div></div></div><p>The <a href="IDU-HTTP4.html" class="olink">HTTP4</a> component only support one instance of <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> per component. If you need to use 2 or more different instances, then you need to setup multiple <a href="IDU-HTTP4.html" class="olink">HTTP4</a> components as shown below. Where we have 2 components, each using their own instance of <code class="literal">sslContextParameters</code> property.</p><pre class="programlisting">&lt;bean id="http4-foo" class="org.apache.camel.component.http4.HttpComponent"&gt;
   &lt;property name="sslContextParameters" ref="sslContextParams1"/&gt;
   &lt;property name="x509HostnameVerifier" ref="hostnameVerifier"/&gt;
&lt;/bean&gt;

&lt;bean id="http4-bar" class="org.apache.camel.component.http4.HttpComponent"&gt;
   &lt;property name="sslContextParameters" ref="sslContextParams2"/&gt;
   &lt;property name="x509HostnameVerifier" ref="hostnameVerifier"/&gt;
&lt;/bean&gt;</pre></div></div></body></html>
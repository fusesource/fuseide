<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Aggregate</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderRouteRef.html" title="Routing"><link rel="prev" href="RiderRouteRef.html" title="Routing"><link rel="next" href="choice.html" title="Choice"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry"><a name="aggregate"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>Aggregate &#8212; Aggregates many messages into a single message</p></div><div class="refsection"><a name="d0e27665"></a><h2>Usage</h2><p>The Aggregate pattern uses an expression to determine which messages to aggregate into a
            single message. Messages that match the expression are held until they are combined by
            the specified aggregation strategy bean.</p><p>The Aggregate pattern can be placed anywhere in the body of a route.</p></div><div class="refsection"><a name="d0e27672"></a><h2>Properties</h2><p><a class="xref" href="aggregate.html#RiderAggregateRefTbl1" title="Table&nbsp;9.&nbsp;Aggregate Properties">Table&nbsp;9</a> describes the properties you can specify 
    using the properties editor.</p><div class="table"><a name="RiderAggregateRefTbl1"></a><p class="title"><b>Table&nbsp;9.&nbsp;Aggregate Properties</b></p><div class="table-contents"><table summary="Aggregate Properties" width="100%" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><span class="property">language</span></td><td>Specifies the expression language used to process the correlation
              expression.</td></tr><tr><td><span class="property">Aggregate Controller Ref</span></td><td>Specifies a reference to a org.apache.camel.processor.aggregate.AggregateController to allow external sources to control this aggregator.</td></tr><tr><td><a name="AggRepo"></a><span class="property">Aggregation Repository Ref</span></td><td>Specifies a reference for looking up a custom
                    <code class="interfacename">AggregationRepository</code> in the registry. The
                    <code class="interfacename">AggregationRepository</code> stores the messages while they
                    are being aggregated (held).</td></tr><tr><td><span class="property">Close Correlation Key On Completion</span></td><td>Specifies the number of closed correlation keys stored in the cache used to 
              determine if an exchange should be accepted.</td></tr><tr><td><span class="property">Complete All on Stop</span></td><td>Indicates to wait to complete all current and partial (pending) aggregate exchanges when the context is stopped. When enabled, the aggregate will wait to complete all exchanges before it is stopped, when the Camel context or the route using it is stopped.</td></tr><tr><td><span class="property">Completion From Batch Consumer</span></td><td>Specifies whether aggregates can be completed based on information from a batch
                    consumer. The default is <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Completion Interval</span></td><td>Specifies an interval of time, in milliseconds, after which the 
                    aggregator completes any in process aggregate messages. This property cannot be 
                    used with <span class="property">Completion Timeout</span>.</td></tr><tr><td><span class="property">language</span></td><td>Specifies the expression language used to process the completion size
              expression.</td></tr><tr><td><span class="property">Completion Size</span></td><td>Specifies an expression used to determine when aggregation is complete based on 
              the number of exchanges processed.</td></tr><tr><td><span class="property">Completion Timeout</span></td><td>Specifies an expression used to determine when aggregation is complete based on
                    the amount of time, in milliseconds, the aggregator has been inactive.</td></tr><tr><td><span class="property">Description</span></td><td>Specifies a text description for the node.  This description is included in the
              generated XML file, but it is informational only. It is not used by Apache Camel.</td></tr><tr><td><span class="property">Discard On Completion Timeout</span></td><td>Specifies whether aggregates that are completed due to a timeout, in
                    milliseconds, are discarded. The default is
                    <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Eager Check Completion</span></td><td><p>Specifies whether the aggregator determines completion by eagerly checking the
              data as exchanges are received or by checking the data after it's been aggregated into
              a single exchange. The default is <em class="replaceable"><code>Disabled</code></em>.</p><p>This property works in conjunction with
              and influences the behavior of the <span class="property">Completion Predicate</span>
              property.</p></td></tr><tr><td><span class="property">Executor Service Ref</span></td><td>Specifies a reference for looking up the
                <code class="interfacename">executorService</code> to use for thread pool management
              when using the <span class="property">Parallel Processing</span> option or when sending out aggregated
              exchanges.</td></tr><tr><td><span class="property">Force Completion On Stop</span></td><td>Specifies whether to complete all aggregated exchanges currently in route when
              the routing context is stopped. The default is <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Group Exchanges</span></td><td>Specifies whether the aggregator groups all outgoing exchanges into a single
                    <code class="classname">GroupedExchange</code> object. The default is <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Id</span></td><td><p>Specifies a unique identifier for the endpoint.</p>
                    <p>The tooling automatically generates an id for a node when it is
                        created, but you can remove  that id or replace it with your own.
                        The Camel debugger requires all nodes with a breakpoint set to have
                        a unique id.</p>
                    <p>You can use the id to refer to endpoints in your Camel XML
                        file.</p></td></tr><tr><td><span class="property">Ignore Invalid Correlation Keys</span></td><td>Specifies whether the aggregator ignores invalid correlation keys. The default is
              <em class="replaceable"><code>Disabled</code></em>, which causes the aggregator to throw an exception when it encounters an
              invalid correlation key.</td></tr><tr><td><span class="property">Optimistic Lock Retry Policy</span></td><td>Configures the retry settings when Optimized locking is enabled. See <a class="xref" href="aggregate.html#optLockRetrySettings" title="Table&nbsp;10.&nbsp;Optimistic Lock Retry Configuration Options">Table&nbsp;10, &#8220;Optimistic Lock Retry Configuration Options&#8221;</a> for configuration details.</td></tr><tr><td><span class="property">Optimistic Locking</span></td><td>Specifies whether to use optimistic locking when aggregating messages. When
                            enabled, the <code class="interfacename">AggregationRepository</code> (see
                                <a class="xref" href="aggregate.html#AggRepo">Aggregation Repository Ref</a> must
                            support optimistic locking (which all out-of-the-box, camel-supplied
                            aggregation repositories do). The default is
                                <em class="replaceable"><code>Disabled</code></em>. </td></tr><tr><td><span class="property">Parallel Processing</span></td><td>Specifies whether the aggregator processes multiple messages concurrently. The
                    default is <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Strategy Method Allow Null</span></td><td>Specifies whether the aggregate method is used on the initial aggregation.
                            When disabled, it is not used on the initial aggregation. When enabled,
                            null values are used as the <span class="property">oldExchange</span> (on the initial aggregation)
                            when POJOs are used as the
                                <code class="interfacename">AggregationStrategy</code>. The default is
                                <em class="replaceable"><code>Disabled</code></em>.</td></tr><tr><td><span class="property">Strategy Method Name</span></td><td>Explicitly specifies the name of the method to use when using POJOs as the
                                <code class="interfacename">AggregationStrategy</code>. </td></tr><tr><td><span class="property">Strategy Ref</span></td><td>Specifies a reference for looking up the 
                    <code class="interfacename">AggregationStrategy</code> in the registry.</td></tr><tr><td><span class="property">Timeout Checker Executor Service Ref</span></td><td>Specifies a reference for looking up the
                <code class="interfacename">timeoutExecutorService</code> to use for custom thread pool
              management when using one of the options: <span class="property">Completion Timeout</span>, <span class="property">Completion Timeout
                Expression</span>, or <span class="property">Completion Interval</span>.</td></tr></tbody></table></div></div><br class="table-break"><p><a class="xref" href="aggregate.html#optLockRetrySettings" title="Table&nbsp;10.&nbsp;Optimistic Lock Retry Configuration Options">Table&nbsp;10</a> describes the
            properties used to configure how a failed optimized lock is tried.</p><div class="table"><a name="optLockRetrySettings"></a><p class="title"><b>Table&nbsp;10.&nbsp;Optimistic Lock Retry Configuration Options</b></p><div class="table-contents"><table summary="Optimistic Lock Retry Configuration Options" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th>Name</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><span class="property">Exponential Back Off</span></td><td><em class="replaceable"><code>Enabled</code></em></td><td>Enables/disables exponential back off mode, which uses an exponential
                            algorithm to calculate successive retry intervals after <span class="property">Retry
                                Delay</span>, not to exceed <span class="property">Maximum Retry
                                Delay</span>.</td></tr><tr><td><span class="property">Maximum Retries</span></td><td><em class="replaceable"><code>0</code></em></td><td>Specifies the maximum number of retries that will be attempted. When
                            reached, no further attempt will be made.</td></tr><tr><td><span class="property">Maximum Retry Delay</span></td><td><em class="replaceable"><code>0 ms</code></em></td><td>Specifies the maximum wait time, in milliseconds, between retries.</td></tr><tr><td><span class="property">Random Back Off</span></td><td><em class="replaceable"><code>Disabled</code></em></td><td>Enables/disables random back off mode, which uses  random number
                            generation to calculate successive retry intervals after <span class="property">Retry
                                Delay</span>, not to exceed <span class="property">Maximum Retry
                                Delay</span>.</td></tr><tr><td><span class="property">Retry Delay</span></td><td><em class="replaceable"><code>50 ms</code></em></td><td>Specifies the initial wait time interval, in milliseconds, between
                            retries.</td></tr></tbody></table></div></div><br class="table-break"><p>Combining retry configuration options has these effects:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>When <span class="property">Random Back Off</span> is enabled, <span class="property">Retry Delay</span>
          is ignored.</p></li><li class="listitem"><p>When <span class="property">Random Back Off</span> is enabled, but <span class="property">Maximum Retry
                        Delay</span> is not, <span class="property">Maximum Retry Delay</span> defaults
                    to <code class="literal">1000</code> ms, and the random back off delay will be between
                        <code class="literal">0</code> and <code class="literal">1000</code> ms. </p></li><li class="listitem"><p>When <span class="property">Exponential Back Off</span> is enabled and <span class="property">Maximum Retry
                Delay</span> set, the <span class="property">Retry Delay</span> keeps doubling in value
            until it reaches or exceeds <span class="property">Maximum Retry Delay</span>. At that point, the
            value of <span class="property">Maximum Retry Delay</span> is used as the  <span class="property">Retry
                Delay</span>.</p></li><li class="listitem"><p>When both <span class="property">Exponential Back Off</span> and <span class="property">Random Back
                Off</span> are enabled, <span class="property">Exponential Back Off</span> takes
              precedence.</p></li><li class="listitem"><p>When both <span class="property">Exponential Back Off</span> and <span class="property">Random Back Off</span>
                    are disabled, the value of <span class="property">Retry Delay</span> is used and remains
                    constant throughout all retry attempts.</p></li></ul></div></div><div class="refsection"><a name="d0e28080"></a><h2>Related topics</h2><table border="0" summary="Simple list" class="simplelist"><tr><td><a href="RiderExLang.html" class="olink">Expression and Predicates Languages</a></td></tr><tr><td><a href="RiderEditPrefs.html" class="olink">Configuring the route editor</a></td></tr></table></div></div></body></html>
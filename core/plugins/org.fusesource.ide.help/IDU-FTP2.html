<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>FTP2</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-FreeMarker.html" title="FreeMarker"><link rel="next" href="IDU-GAE.html" title="GAE"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-FTP2"></a>FTP2</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_FTPSFTPFTPSComponentCamel20onwards"></a>FTP/SFTP Component </h2></div></div></div><p>This component provides access to remote file systems over the FTP and SFTP
      protocols.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Consuming from remote FTP server"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Consuming from remote FTP server</th></tr><tr><td align="left" valign="top"><p>Make sure you read the section titled <span class="emphasis"><em>Default when consuming files</em></span> further below for details related to consuming files.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Absolute path is not supported. <span class="bold"><strong>Camel 2.16</strong></span>
                translates an absolute path to relative by trimming all leading slashes from
                    <code class="code">directoryname</code>. A WARN message will be printed in the logs.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e85679"></a>Camel on EAP deployment</h2></div></div></div><p>This component is supported by the Camel on EAP (Wildfly Camel) framework, which
            offers a simplified deployment model on the Red Hat JBoss Enterprise Application Platform (JBoss EAP) container.
 </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">ftp://[username@]hostname[:port]/directoryname[?options]
sftp://[username@]hostname[:port]/directoryname[?options]
ftps://[username@]hostname[:port]/directoryname[?options]</pre><p>Where <span class="bold"><strong>directoryname</strong></span> represents the underlying directory.
            Can contain nested folders. The directory name is a relative path. Absolute paths are
            not supported. The relative path can contain nested folders&#8212;for example,
                <code class="code">/inbox/us</code>. For <span class="bold"><strong>Camel 2.16</strong></span>, the
                <code class="code">autoCreate</code> option is supported. When a consumer starts (and before
            polling is scheduled), the specified directory is created automatically. The default
            value of <code class="code">autoCreate</code> is <code class="code">true</code>.</p><p>If no <span class="bold"><strong>username</strong></span> is provided, then
        <code class="literal">anonymous</code> login is attempted using no password. If no <span class="bold"><strong>port</strong></span> number is provided, Apache Camel will provide default values
        according to the protocol (ftp = 21, sftp = 22, ftps = 21).</p><p>This component uses two different libraries for the actual FTP work. FTP and FTPS use
        <a class="link" href="http://commons.apache.org/net/" target="_top">Apache Commons Net</a> while SFTP uses
        <a class="link" href="http://www.jcraft.com/jsch/" target="_top">JCraft JSCH</a>.</p><p>You can append query options to the URI in the following format,
        <code class="literal">?option=value&amp;option=value&amp;...</code>
    </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_URIOptions"></a>URI Options</h2></div></div></div><p>The options below are exclusive to the FTP
      component:</p><table id="d0e85741"><tr>
        <th> Name </th>
        <th> Default Value </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">username</code></td>
        <td><code class="literal">null</code>
        </td>
        <td> Specifies the username to use to log in to the remote file systen. </td>
      </tr><tr>
        <td><code class="literal">password</code></td>
        <td><code class="literal">null</code>
        </td>
        <td> Specifies the password to use to log in to the remote file system. </td>
      </tr><tr>
                <td><code class="literal">account</code></td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.15.2:</strong></span> Specifies the account to use to
                    login to the remote FTP server (only for FTP and FTP Secure). </td>
            </tr><tr>
        <td><code class="literal">binary</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td> Specifies the file transfer mode, BINARY or ASCII. Default is ASCII
            (<code class="literal">false</code>). </td>
      </tr><tr>
        <td><code class="literal">disconnect</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.2:</strong></span> Whether or not to disconnect from remote FTP
          server right after use. Can be used for both consumer and producer. Disconnect will only
          disconnect the current connection to the FTP server. If you have a consumer which you want
          to stop, then you need to stop the consumer/route instead. </td>
      </tr><tr>
        <td><code class="literal">localWorkDirectory</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td> When consuming, a local work directory can be used to store the remote file content
          directly in local files, to avoid loading the content into memory. This is beneficial, if
          you consume a very big remote file and thus can conserve memory. See below for more
          details. </td>
      </tr><tr>
        <td><code class="literal">passiveMode</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>FTP only</strong></span>: Specifies whether to use passive mode
          connections. Default is active mode <code class="literal">{false</code>). </td>
      </tr><tr>
        <td><code class="literal">securityProtocol</code>
        </td>
        <td><code class="literal">TLS</code>
        </td>
        <td>
          <p><span class="bold"><strong>FTPS only:</strong></span> Sets the underlying security protocol.
            The following values are defined: <code class="literal">TLS</code>: Transport Layer Security
              <code class="literal">SSL</code>: Secure Sockets Layer </p>
        </td>
      </tr><tr>
        <td><code class="literal">disableSecureDataChannelDefaults</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.4: FTPS only</strong></span>: Whether or not to disable using
                    default values for <code class="literal">execPbsz</code> and <code class="literal">execProt</code>
                    when using secure data transfer. Setting this option to <code class="literal">true</code>,
                    requires that the <code class="literal">execPbsz</code> and <code class="literal">execProt</code>
                    options are configured explicitly. </td>
      </tr><tr>
        <td><code class="literal">download</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11:</strong></span> Whether the FTP consumer should download the file.
          If this option is set to <code class="literal">false</code>, then the message body will be
          <code class="literal">null</code>, but the consumer will still trigger a Camel
          <a class="link" href="Exchange" target="_top">Exchange</a> that has details about the file such as file name,
          file size, etc. It's just that the file will not be downloaded. </td>
      </tr><tr>
        <td> streamDownload</td>
        <td> false </td>
        <td><span class="bold"><strong>Camel 2.11:</strong></span>&nbsp;hether the consumer should download the entire file up front, the default behavior, or if it should pass an InputStream&nbsp;ead from the remote resource rather than an in-memory array as the in body of the&nbsp;amel&nbsp;<a class="link" href="Exchange" target="_top">Exchange</a>. &nbsp;his option is ignored if download&nbsp;s false&nbsp;r is localWorkDirectory is provided. &nbsp;his option is useful for working with large remote files. </td>
      </tr><tr>
        <td><code class="literal">execProt</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td>
          <p><span class="bold"><strong>Camel 2.4: FTPS only</strong></span>: Will by default use option
                            <code class="literal">P</code> if secure data channel defaults hasn't been
                        disabled. Possible values are:</p>
                    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">C</code>: Clear</p></li><li class="listitem"><p><code class="literal">S</code>: Safe (TLS protocol only)</p></li><li class="listitem"><p><code class="literal">E</code>: Confidential (TLS protocol only)</p></li><li class="listitem"><p><code class="literal">P</code>: Private</p></li></ul></div>
        </td>
      </tr><tr>
        <td><code class="literal">execPbsz</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>Camel 2.4: FTPS only</strong></span>: This option specifies the buffer
          size of the secure data channel. If option <code class="literal">useSecureDataChannel</code> has
          been enabled and this option has not been explicit set, then value <code class="literal">0</code> is
          used. </td>
      </tr><tr>
        <td><code class="literal">isImplicit</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>FTPS only:</strong></span> Sets the security mode(implicit/explicit).
          Default is explicit (<code class="literal">false</code>). </td>
      </tr><tr>
        <td><code class="literal">knownHostsFile</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span> Sets the <code class="literal">known_hosts</code>
          file, so that the SFTP endpoint can do host key verification. </td>
      </tr><tr>
        <td><code class="literal">knownHostsUri</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.11.1:</strong></span> Sets the <code class="literal">known_hosts</code> file (loaded from classpath by default), so that the SFTP endpoint can do host key verification. </td>
      </tr><tr>
        <td><code class="literal">keyPair</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.12.0:</strong></span> Sets the Java KeyPair for SSH public key authentication, it supports DSA or RSA keys. </td>
      </tr><tr>
        <td><code class="literal">privateKeyFile</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span> Set the private key file to that the SFTP endpoint can do private key verification. </td>
      </tr><tr>
        <td><code class="literal">privateKeyUri</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.11.1:</strong></span> Set the private key file (loaded from classpath by default) to that the SFTP endpoint can do private key verification. </td>
      </tr><tr>
        <td><code class="literal">privateKey</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.11.1:</strong></span> Set the private key as byte[] to that the SFTP endpoint can do private key verification. </td>
      </tr><tr>
        <td><code class="literal">privateKeyFilePassphrase</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span> Set the private key file passphrase to that
          the SFTP endpoint can do private key verification. </td>
      </tr><tr>
        <td><code class="literal">privateKeyPassphrase</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.11.1:</strong></span> Set the private key file passphrase to that the SFTP endpoint can do private key verification. </td>
      </tr><tr>
        <td><code class="literal">preferredAuthentications</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.10.7, 2.11.2,2.12.0:</strong></span> set the preferred authentications which SFTP endpoint will used. Some example include:password,publickey. If not specified the default list from JSCH will be used. </td>
      </tr><tr>
        <td><code class="literal">ciphers</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>Camel 2.8.2, 2.9: SFTP only</strong></span> Set a comma separated list of ciphers that will be used in order of preference. Possible cipher names are defined by <a class="link" href="http://www.jcraft.com/jsch/" target="_top">JCraft JSCH</a>. Some examples include: aes128-ctr,aes128-cbc,3des-ctr,3des-cbc,blowfish-cbc,aes192-cbc,aes256-cbc. If not specified the default list from JSCH will be used. </td>
      </tr><tr>
        <td><code class="literal">fastExistsCheck</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.8.2, 2.9:</strong></span> If set this option to be true, camel-ftp will use the list file directly to check if the file exists. Since some FTP server may not support to list the file directly, if the option is false, camel-ftp will use the old way to list the directory and check if the file exists. Note from <span class="bold"><strong>Camel 2.10.1</strong></span> onwards this option also influences <code class="literal">readLock=changed</code> to control whether it performs a fast check to update file information or not. This can be used to speed up the process if the FTP server has a lot of files. </td>
      </tr><tr>
        <td><code class="literal">strictHostKeyChecking</code>
        </td>
        <td><code class="literal">no</code>
        </td>
        <td><span class="bold"><strong>SFTP only:</strong></span><span class="bold"><strong>Camel 2.2:</strong></span> Sets whether to use strict host key checking. Possible values are: <code class="literal">no</code>, <code class="literal">yes</code> and <code class="literal">ask</code>. <code class="literal">ask</code> does not make sense to use as Camel cannot answer the question for you as its meant for human intervention. <span class="bold"><strong>Note:</strong></span> The default in Camel 2.1 and below was <code class="literal">ask</code>. </td>
      </tr><tr>
        <td><code class="literal">maximumReconnectAttempts</code>
        </td>
        <td> 3 </td>
        <td> Specifies the maximum reconnect attempts Apache Camel performs when it tries to connect to
          the remote FTP server. Use 0 to disable this behavior. </td>
      </tr><tr>
        <td><code class="literal">reconnectDelay</code>
        </td>
        <td> 1000 </td>
        <td> Delay in millis Apache Camel will wait before performing a reconnect attempt. </td>
      </tr><tr>
        <td><code class="literal">connectTimeout</code>
        </td>
        <td><code class="literal">10000</code>
        </td>
        <td><span class="bold"><strong>Camel 2.4:</strong></span> Is the connect timeout in millis. This
          corresponds to using <code class="literal">ftpClient.connectTimeout</code> for the FTP/FTPS. For
          SFTP this option is also used when attempting to connect. </td>
      </tr><tr>
        <td><code class="literal">soTimeout</code>
        </td>
        <td><code class="literal">30000</code>
                </td>
        <td><span class="bold"><strong>FTP and FTPS Only:</strong></span><span class="bold"><strong>Camel
                        2.4:</strong></span> Is the <code class="literal">SocketOptions.SO_TIMEOUT</code> value in
                    millis. </td>
      </tr><tr>
        <td><code class="literal">timeout</code>
        </td>
        <td><code class="literal">30000</code>
        </td>
        <td><span class="bold"><strong>FTP and FTPS Only:</strong></span><span class="bold"><strong>Camel
            2.4:</strong></span> Is the data timeout in millis. This corresponds to using
            <code class="literal">ftpClient.dataTimeout</code> for the FTP/FTPS. For SFTP there is no data
          timeout. </td>
      </tr><tr>
        <td><code class="literal">throwExceptionOnConnectFailed</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.5:</strong></span> Whether or not to thrown an exception if a
          successful connection and login could not be establish. This allows a custom
            <code class="literal">pollStrategy</code> to deal with the exception, for example to stop the
          consumer or the likes. </td>
      </tr><tr>
        <td><code class="literal">siteCommand</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTP and FTPS Only:</strong></span><span class="bold"><strong>Camel
            2.5:</strong></span> To execute site commands after successful login. Multiple site commands
          can be separated using a new line character (\n). Use <code class="literal">help site</code> to see
          which site commands your FTP server supports. </td>
      </tr><tr>
        <td><code class="literal">stepwise</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td>When consuming directories, specifies whether or not to use stepwise mode for traversing
          the directory tree. Stepwise means that it will CD one directory at a time. For more
          details, see <a class="xref" href="IDU-FTP2.html#IDU-FTP2_HSH_Stepwisechangingdirectories" title="Stepwise changing directories">Stepwise changing directories</a>.</td>
      </tr><tr>
        <td><code class="literal">separator</code>
        </td>
        <td><code class="literal">UNIX</code>
                </td>
        <td><span class="bold"><strong>Camel 2.6:</strong></span> Dictates what path separator
            <code class="code">char</code> to use when uploading files. <code class="literal">Auto</code> means use the
          path provided without altering it. <code class="literal">UNIX</code> means use UNIX style path
          separators. <code class="literal">Windows</code> means use Windows style path separators. </td>
      </tr><tr>
        <td><code class="literal">chmod</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td>
                    <span class="bold"><strong>SFTP Producer Only:</strong></span>
                    <span class="bold"><strong>Camel 2.9:</strong></span> Allows you to set chmod on the
                    stored file. For example <code class="literal">chmod=640</code>. </td>
      </tr><tr>
        <td><code class="literal">compression</code></td>
        <td>
                    <code class="code">0</code></td>
        <td>
                    <span class="bold"><strong>SFTP Only:</strong></span>
                    <span class="bold"><strong>Camel 2.8.3/2.9:</strong></span> To use compression. Specify a
                    level from 1 to 10. <span class="bold"><strong>Important:</strong></span> You must
                    manually add the needed JSCH zlib JAR to the classpath for compression support. </td>
      </tr><tr>
                <td><code class="literal">receiveBufferSize</code></td>
                <td>
                    <code class="code">32768</code></td>
                <td>
                    <p><span class="bold"><strong>FTP/FTPS Only:</strong></span>
                        <span class="bold"><strong>Camel 2.15.1:</strong></span> The buffer size for
                        downloading files. The default size is 32KB.</p>
                </td>
            </tr><tr>
        <td><code class="literal">ftpClient</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTP and FTPS Only:</strong></span><span class="bold"><strong>Camel
            2.1:</strong></span> Allows you to use a custom
            <code class="literal">org.apache.commons.net.ftp.FTPClient</code> instance. </td>
      </tr><tr>
        <td><code class="literal">ftpClientConfig</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTP and FTPS Only:</strong></span><span class="bold"><strong>Camel
            2.1:</strong></span> Allows you to use a custom
            <code class="literal">org.apache.commons.net.ftp.FTPClientConfig</code> instance. </td>
      </tr><tr>
        <td><code class="literal">serverAliveInterval</code>
        </td>
        <td><code class="literal">0</code>
        </td>
        <td><span class="bold"><strong>SFTP Only:</strong></span><span class="bold"><strong>Camel 2.8</strong></span> Allows you to set the serverAliveInterval of the sftp session </td>
      </tr><tr>
        <td><code class="literal">serverAliveCountMax</code>
        </td>
        <td><code class="literal">1</code>
        </td>
        <td><span class="bold"><strong>SFTP Only:</strong></span><span class="bold"><strong>Camel 2.8</strong></span> Allows you to set the serverAliveCountMax  of the sftp session </td>
      </tr><tr>
        <td><code class="literal">ftpClient.trustStore.file</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the trust store file, so that the FTPS
          client can look up for trusted certificates. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.trustStore.type</code>
        </td>
        <td><code class="literal">JKS</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the trust store type. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.trustStore.algorithm</code>
        </td>
        <td><code class="literal">SunX509</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the trust store algorithm. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.trustStore.password</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the trust store password. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.keyStore.file</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the key store file, so that the FTPS
          client can look up for the private certificate. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.keyStore.type</code>
        </td>
        <td><code class="literal">JKS</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the key store type. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.keyStore.algorithm</code>
        </td>
        <td><code class="literal">SunX509</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the key store algorithm. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.keyStore.password</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the key store password. </td>
      </tr><tr>
        <td><code class="literal">ftpClient.keyStore.keyPassword</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span> Sets the private key password. </td>
      </tr><tr>
        <td><code class="literal">sslContextParameters</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>FTPS Only:</strong></span><span class="bold"><strong>Camel 2.9:</strong></span>
            Reference to a <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> in the
            <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.&nbsp;This
            reference overrides any configured SSL related options on ftpClient as well as the
            securityProtocol (SSL, TLS, etc.) set on FtpsConfiguration.&nbsp;See <a class="link" href="http://camel.apache.org/camel-configuration-utilities.html" target="_top">JSSE
                Utility</a>. </td>
      </tr><tr>
        <td><code class="literal">proxy</code>
        </td>
        <td><code class="literal">null</code>
        </td>
        <td><span class="bold"><strong>SFTP Only:</strong></span><span class="bold"><strong>Camel 2.10.7, 2.11.1:</strong></span> Reference to a <code class="literal">com.jcraft.jsch.Proxy</code> in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a>.&nbsp;This proxy is used to consume/send messages from the target SFTP host. </td>
      </tr><tr>
        <td><code class="literal">useList</code>
        </td>
        <td><code class="literal">true</code>
        </td>
        <td><span class="bold"><strong>FTP/FTPS Only:</strong></span><span class="bold"><strong>Camel 2.12.1:</strong></span> Whether the consumer should use FTP LIST command to retrieve directory listing to see which files exists. If this option is set to <code class="literal">false</code>, then <code class="literal">stepwise=false</code> must be configured, and also <code class="literal">fileName</code> must be configured to a fixed name, so the consumer knows the name of the file to retrieve. When doing this only that single file can be retrieved. See further below for more details. </td>
      </tr><tr>
        <td><code class="literal">ignoreFileNotFoundOrPermissionError</code>
        </td>
        <td><code class="literal">false</code>
        </td>
        <td><span class="bold"><strong>Camel 2.12.1:</strong></span> Whether the consumer should ignore when a file was attempted to be retrieved but did not exist (for some reason), or failure due insufficient file permission error. </td>
      </tr><tr>
                <td><code class="literal">sendNoop</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td><span class="bold"><strong>Camel 2.16:</strong></span> Producer only. Whether to send a
                    noop command as a pre-write check before uploading files to the FTP server. This
                    option is enabled by default in order to validate the connection and to enable
                    silent reconnection. However, if this causes any problems, you can disable this
                    option. </td>
            </tr><tr>
                <td><code class="literal">jschLoggingLevel</code>
                </td>
                <td><code class="literal">WARN</code>
                </td>
                <td>
                    <p><span class="bold"><strong>SFTP Only: Camel 2.15.3/2.16:</strong></span> The logging
                        level to use for JSCH activity logging. As JSCH is verbose by default (at
                            <code class="code">INFO</code> level) the threshold is set to <code class="code">WARN</code> by
                        default.</p>
                </td>
            </tr></table><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: FTPS component default trust store"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">FTPS component default trust store</th></tr><tr><td align="left" valign="top"><p>When using the <code class="literal">ftpClient.</code> properties related to SSL with the FTPS component, the trust store accept all certificates. If you only want trust selective certificates, you have to configure the trust store with the <code class="literal">ftpClient.trustStore.xxx</code> options or by configuring a custom <code class="literal">ftpClient</code>.</p><p>When using <code class="literal">sslContextParameters</code>, the trust store is managed by the configuration of the provided SSLContextParameters instance.</p></td></tr></table></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: More options"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">More options</th></tr><tr><td align="left" valign="top"><p>See <a href="IDU-File2.html" class="olink">File</a> for more options, as all the options from
          <a href="IDU-File2.html" class="olink">File</a> are inherited by FTP2.</p></td></tr></table></div><p>You can configure additional options on the <code class="literal">ftpClient</code> and
        <code class="literal">ftpClientConfig</code> from the URI directly by using the
        <code class="literal">ftpClient.</code> or <code class="literal">ftpClientConfig.</code> prefix.</p><p>For example to set the <code class="literal">setDataTimeout</code> on the
        <code class="literal">FTPClient</code> to 30 seconds you can do:</p><pre class="programlisting">from("ftp://foo@myserver?password=secret&amp;ftpClient.dataTimeout=30000")
    .to("bean:foo");</pre><p>You can mix and match and have use both prefixes, for example to configure date format or
      timezones.</p><pre class="programlisting">from("ftp://foo@myserver?password=secret&amp;ftpClient.dataTimeout=30000&amp;ftpClientConfig.serverLanguageCode=fr")
    .to("bean:foo");</pre><p>You can have as many of these options as you like.</p><p>See the documentation of the <a class="link" href="http://commons.apache.org/proper/commons-net/apidocs/org/apache/commons/net/ftp/FTPClientConfig.html" target="_top">Apache Commons FTP FTPClientConfig</a> for possible options and more details. And as

      well for <a class="link" href="http://commons.apache.org/proper/commons-net/apidocs/org/apache/commons/net/ftp/FTPClient.html" target="_top">Apache

        Commons FTP FTPClient</a>.</p><p>If you do not like having many and long configuration in the url you can refer to the
        <code class="literal">ftpClient</code> or <code class="literal">ftpClientConfig</code> to use by letting Camel
      lookup in the <a class="link" href="http://camel.apache.org/registry.html" target="_top">Registry</a> for it.</p><p>For example:</p><pre class="programlisting">   &lt;bean id="myConfig" class="org.apache.commons.net.ftp.FTPClientConfig"&gt;
       &lt;property name="lenientFutureDates" value="true"/&gt;
       &lt;property name="serverLanguageCode" value="fr"/&gt;
   &lt;/bean&gt;</pre><p>And then let Camel lookup this bean when you use the # notation in the url.</p><pre class="programlisting">from("ftp://foo@myserver?password=secret&amp;ftpClientConfig=#myConfig").to("bean:foo");</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_MoreURIoptions"></a>More URI options</h2></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>See <a href="IDU-File2.html" class="olink">File2</a> as all the options there also applies
        for this component.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Examples"></a>Examples</h2></div></div></div><p>Here are some examples of FTP endpoint URIs:</p><pre class="programlisting">ftp://someone@someftpserver.com/public/upload/images/holiday2008?password=secret&amp;binary=true
ftp://someoneelse@someotherftpserver.co.uk:12049/reports/2008/password=secret&amp;binary=false
ftp://publicftpserver.com/download</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: FTP Consumer does not support concurrency"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="imagesdb/warning.png"></td><th align="left">FTP Consumer does not support concurrency</th></tr><tr><td align="left" valign="top"><p>The FTP consumer (with the same endpoint) does not support concurrency (the backing FTP
        client is not thread safe). You can use multiple FTP consumers to poll from different
        endpoints. It is only a single endpoint that does not support concurrent consumers.</p><p>The FTP producer does <span class="bold"><strong>not</strong></span> have this issue, it supports
        concurrency.</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: More information"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">More information</th></tr><tr><td align="left" valign="top"><p>This component is an extension of the <a href="IDU-File2.html" class="olink">File2</a>
        component. So there are more samples and details on the <a href="IDU-File2.html" class="olink">File2</a> component page.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Defaultwhenconsumingfiles"></a>Default when consuming files</h2></div></div></div><p>The <a href="IDU-FTP2.html" class="olink">FTP</a> consumer will by default leave the consumed
      files untouched on the remote FTP server. You have to configure it explicit if you want it to
      delete the files or move them to another location. For example you can use
        <code class="literal">delete=true</code> to delete the files, or use <code class="literal">move=.done</code> to
      move the files into a hidden done sub directory.</p><p>The regular <a href="IDU-File2.html" class="olink">File</a> consumer is different as it will by
      default move files to a <code class="literal">.camel</code> sub directory. The reason Camel does
        <span class="bold"><strong>not</strong></span> do this by default for the FTP consumer is that it may
      lack permissions by default to be able to move or delete files.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_limitations"></a>limitations</h2></div></div></div><p>The option <span class="bold"><strong>readLock</strong></span> can be used to force Apache Camel
        <span class="bold"><strong>not</strong></span> to consume files that are currently in the process of
      being written. However, this option is turned off by default, as it requires that the user has
      write access. There are other solutions to avoid consuming files that are currently being
      written over FTP; for instance, you can write to a temporary destination and move the file
      after it has been written. </p><p>The ftp producer does <span class="bold"><strong>not</strong></span> support appending to existing
      files. Any existing files on the remote server will be deleted before the file is
      written.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_MessageHeaders"></a>Message Headers</h2></div></div></div><p>The following message headers can be used to affect the behavior of the component</p><table id="d0e87105"><tr>
        <th> Header </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">CamelFileName</code>
        </td>
        <td> Specifies the output file name (relative to the endpoint directory) to be used for the
          output message when sending to the endpoint. If this is not present and no expression
          either, then a generated message ID is used as the filename instead. </td>
      </tr><tr>
        <td><code class="literal">CamelFileNameProduced</code>
        </td>
        <td> The pathname of the output file that was written. This header is set automatically by
                    Apache Camel.</td>
      </tr><tr>
        <td><code class="literal">CamelFileBatchIndex</code>
        </td>
        <td> Current index out of total number of files being consumed in this batch. </td>
      </tr><tr>
        <td><code class="literal">CamelFileBatchSize</code>
        </td>
        <td> Total number of files being consumed in this batch. </td>
      </tr><tr>
        <td><code class="literal">CamelFileHost</code>
        </td>
        <td> The remote hostname. </td>
      </tr><tr>
        <td><code class="literal">CamelFileLocalWorkPath</code>
        </td>
        <td> Path to the local work file, if local work directory is used. </td>
      </tr></table><p>In addition the FTP/FTPS consumer and producer will enrich the Camel <code class="literal">Message</code> with the following headers:
    </p><table id="d0e87179"><tr>
        <th> Header </th>
        <th> Description </th>
      </tr><tr>
        <td><code class="literal">CamelFtpReplyCode</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.1:</strong></span> The FTP client reply code (the type is a integer) </td>
      </tr><tr>
        <td><code class="literal">CamelFtpReplyString</code>
        </td>
        <td><span class="bold"><strong>Camel 2.11.1:</strong></span> The FTP client reply string </td>
      </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Abouttimeouts"></a>About timeouts</h2></div></div></div><p>The two sets of libraries (see above) have different APIs for setting the timeout. You can
      use the <code class="literal">connectTimeout</code> option for both of them to set a timeout in
      milliseconds to establish a network connection. An individual <code class="literal">soTimeout</code> can
      also be set on the FTP/FTPS, which corresponds to using
      <code class="literal">ftpClient.soTimeout</code>. Notice SFTP will automatically use
        <code class="literal">connectTimeout</code> as its <code class="literal">soTimeout</code>. The
        <code class="literal">timeout</code> option only applies for FTP/FTSP as the data timeout, which
      corresponds to the <code class="literal">ftpClient.dataTimeout</code> value. All timeout values are in
      milliseconds.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_UsingLocalWorkDirectory"></a>Using Local Work Directory</h2></div></div></div><p>Apache Camel supports consuming from remote FTP servers and downloading the files directly
      into a local work directory. This avoids reading the entire remote file content into memory as
      it is streamed directly into the local file using <code class="literal">FileOutputStream</code>. </p><p>Apache Camel will store to a local file with the same name as the remote file, though with
        <code class="literal">.inprogress</code> as extension while the file is being downloaded. Afterwards,
      the file is renamed to remove the <code class="literal">.inprogress</code> suffix. And finally, when the
        <a class="link" href="Exchange" target="_top">Exchange</a> is complete the local file is deleted. </p><p>So if you want to download files from a remote FTP server and store it as files then you
      need to route to a file endpoint such as:</p><pre class="programlisting">from("ftp://someone@someserver.com?password=secret&amp;localWorkDirectory=/tmp").to("file://inbox");</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Optimization by renaming work file"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Optimization by renaming work file</th></tr><tr><td align="left" valign="top"><p>The route above is ultra efficient as it avoids reading the entire file content into
        memory. It will download the remote file directly to a local file stream. The
          <code class="literal">java.io.File</code> handle is then used as the <a class="link" href="Exchange" target="_top">Exchange</a> body. The file producer leverages this fact and can work directly on the
        work file <code class="literal">java.io.File</code> handle and perform a
          <code class="literal">java.io.File.rename</code> to the target filename. As Apache Camel knows it's a
        local work file, it can optimize and use a rename instead of a file copy, as the work file
        is meant to be deleted anyway.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Stepwisechangingdirectories"></a>Stepwise changing directories</h2></div></div></div><p>Camel <a href="IDU-FTP2.html" class="olink">FTP</a> can operate in two modes in terms of
      traversing directories when consuming files (for example, downloading) or producing files (for
      example, uploading):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>stepwise</p></li><li class="listitem"><p>not stepwise</p></li></ul></div><p>You may want to pick either one depending on your situation and security issues. Some
      Camel end users can only download files if they use stepwise, while others can only download
      if they do not. At least you have the choice to pick.</p><p>Note that stepwise changing of directory will in most cases only work when the user is
      confined to it's home directory and when the home directory is reported as
        <code class="literal">/</code>.</p><p>The difference between the two of them is best illustrated with an example. Suppose we
      have the following directory structure on the remote FTP server we need to traverse and
      download files:</p><pre class="programlisting">      /
      /one
      /one/two
      /one/two/sub-a
      /one/two/sub-b</pre><p>And that we have a file in each of <code class="code">sub-a</code> (<code class="code">a.txt</code>) and
        <code class="code">sub-b</code> (<code class="code">b.txt</code>) folder.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Usingstepwisetruedefaultmode"></a>Using stepwise=true (default mode)</h2></div></div></div><p>The following log shows the conversation between the FTP endpoint and the remote FTP
      server when the FTP endpoint is operating in <span class="emphasis"><em>stepwise</em></span> mode:</p><pre class="programlisting">
      TYPE A
      200 Type set to A
      PWD
      257 "/" is current directory.
      CWD one
      250 CWD successful. "/one" is current directory.
      CWD two
      250 CWD successful. "/one/two" is current directory.
      SYST
      215 UNIX emulated by FileZilla
      PORT 127,0,0,1,17,94
      200 Port command successful
      LIST
      150 Opening data channel for directory list.
      226 Transfer OK
      CWD sub-a
      250 CWD successful. "/one/two/sub-a" is current directory.
      PORT 127,0,0,1,17,95
      200 Port command successful
      LIST
      150 Opening data channel for directory list.
      226 Transfer OK
      CDUP
      200 CDUP successful. "/one/two" is current directory.
      CWD sub-b
      250 CWD successful. "/one/two/sub-b" is current directory.
      PORT 127,0,0,1,17,96
      200 Port command successful
      LIST
      150 Opening data channel for directory list.
      226 Transfer OK
      CDUP
      200 CDUP successful. "/one/two" is current directory.
      CWD /
      250 CWD successful. "/" is current directory.
      PWD
      257 "/" is current directory.
      CWD one
      250 CWD successful. "/one" is current directory.
      CWD two
      250 CWD successful. "/one/two" is current directory.
      PORT 127,0,0,1,17,97
      200 Port command successful
      RETR foo.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      CWD /
      250 CWD successful. "/" is current directory.
      PWD
      257 "/" is current directory.
      CWD one
      250 CWD successful. "/one" is current directory.
      CWD two
      250 CWD successful. "/one/two" is current directory.
      CWD sub-a
      250 CWD successful. "/one/two/sub-a" is current directory.
      PORT 127,0,0,1,17,98
      200 Port command successful
      RETR a.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      CWD /
      250 CWD successful. "/" is current directory.
      PWD
      257 "/" is current directory.
      CWD one
      250 CWD successful. "/one" is current directory.
      CWD two
      250 CWD successful. "/one/two" is current directory.
      CWD sub-b
      250 CWD successful. "/one/two/sub-b" is current directory.
      PORT 127,0,0,1,17,99
      200 Port command successful
      RETR b.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      CWD /
      250 CWD successful. "/" is current directory.
      QUIT
      221 Goodbye
      disconnected.                                                 
      
    </pre><p>As you can see when stepwise is enabled, it will traverse the directory structure using CD
      xxx.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Usingstepwisefalse"></a>Using stepwise=false</h2></div></div></div><p>The following log shows the conversation between the FTP endpoint and the remote FTP
      server when the FTP endpoint is operating in <span class="emphasis"><em>non-stepwise</em></span> mode:</p><pre class="programlisting">
      230 Logged on
      TYPE A
      200 Type set to A
      SYST
      215 UNIX emulated by FileZilla
      PORT 127,0,0,1,4,122
      200 Port command successful
      LIST one/two
      150 Opening data channel for directory list
      226 Transfer OK
      PORT 127,0,0,1,4,123
      200 Port command successful
      LIST one/two/sub-a
      150 Opening data channel for directory list
      226 Transfer OK
      PORT 127,0,0,1,4,124
      200 Port command successful
      LIST one/two/sub-b
      150 Opening data channel for directory list
      226 Transfer OK
      PORT 127,0,0,1,4,125
      200 Port command successful
      RETR one/two/foo.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      PORT 127,0,0,1,4,126
      200 Port command successful
      RETR one/two/sub-a/a.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      PORT 127,0,0,1,4,127
      200 Port command successful
      RETR one/two/sub-b/b.txt
      150 Opening data channel for file transfer.
      226 Transfer OK
      QUIT
      221 Goodbye
      disconnected.                              
      
    </pre><p>As you can see when not using stepwise, there are no CD operation invoked at all.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Samples"></a>Samples</h2></div></div></div><p>In the sample below we set up Apache Camel to download all the reports from the FTP server
      once every hour (60 min) as BINARY content and store it as files on the local file
      system.</p><pre class="programlisting">protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder() {
        public void configure() throws Exception {
            // we use a delay of 60 minutes (eg. once pr. hour we poll the FTP server
            long delay = 60 * 60 * 1000L;

            // from the given FTP server we poll (= download) all the files
            // from the public/reports folder as BINARY types and store this as files
            // in a local directory. Apache Camel will use the filenames from the FTPServer

            // notice that the FTPConsumer properties must be prefixed with "consumer." in the URL
            // the delay parameter is from the FileConsumer component so we should use consumer.delay as
            // the URI parameter name. The FTP Component is an extension of the File Component.
            from("ftp://tiger:scott@localhost/public/reports?binary=true&amp;consumer.delay=" + delay).
                to("file://target/test-reports");
        }
    };
}</pre><p>And the route using Spring DSL:</p><pre class="programlisting">  &lt;route&gt;
     &lt;from uri="ftp://scott@localhost/public/reports?password=tiger&amp;inary=true&amp;elay=60000"/&gt;
     &lt;to uri="file://target/test-reports"/&gt;
  &lt;/route&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_ConsumingaremoteFTPservertriggeredbyaroute"></a>Consuming a remote FTP server triggered by a route</h2></div></div></div><p>The FTP consumer is built as a scheduled consumer to be used in the <span class="bold"><strong>from</strong></span> route. However, if you want to start consuming from an FTP server triggered
      within a route, use a route like the following:</p><pre class="programlisting">from("seda:start")
   // define the file name so that only a single file is polled and deleted once retrieved
   .pollEnrich("ftp://admin@localhost:21/getme?password=admin&amp;binary=false&amp;fileName=myFile.txt&amp;delete=true")
   .to("mock:result");</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_ConsumingaremoteFTPSserverimplicitSSLandclientauthentication"></a>Consuming a remote FTPS server (implicit SSL) and client authentication</h2></div></div></div><p></p><pre class="programlisting">from("ftps://admin@localhost:2222/public/camel?password=admin&amp;securityProtocol=SSL&amp;isImplicit=true
      &amp;ftpClient.keyStore.file=./src/test/resources/server.jks
      &amp;ftpClient.keyStore.password=password&amp;ftpClient.keyStore.keyPassword=password")
  .to("bean:foo");

</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_ConsumingaremoteFTPSserverexplicitTLSandacustomtruststoreconfiguration"></a>Consuming a remote FTPS server (explicit TLS) and a custom trust store
      configuration</h2></div></div></div><p></p><pre class="programlisting">
from("ftps://admin@localhost:2222/public/camel?password=admin&amp;ftpClient.trustStore.file=./src/test/resources/server.jks&amp;ftpClient.trustStore.password=password")
  .to("bean:foo");</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_FilterusingorgapachecamelcomponentfileGenericFileFilter"></a>Filter using org.apache.camel.component.file.GenericFileFilter
    </h2></div></div></div><p>Apache Camel supports pluggable filtering strategies. You define a filter strategy by
      implementing the <code class="literal">org.apache.camel.component.file.GenericFileFilter</code>
      interface in Java. You can then configure the endpoint with the filter to skip certain
      files.</p><p>In the following sample we define a filter that only accepts files whose filename starts
      with <code class="code">report</code>.</p><pre class="programlisting">public class MyFileFilter&lt;T&gt; implements GenericFileFilter&lt;T&gt; {

    public boolean accept(GenericFile&lt;T&gt; file) {
        // we only want report files 
        return file.getFileName().startsWith("report");
    }
}</pre><p>And then we can configure our route using the <span class="bold"><strong>filter</strong></span>
      attribute to reference our filter (using <code class="literal">#</code> notation) that we have defined
      in the spring XML file:</p><pre class="programlisting">   &lt;!-- define our sorter as a plain spring bean --&gt;
   &lt;bean id="myFilter" class="com.mycompany.MyFileFilter"/&gt;

  &lt;route&gt;
    &lt;from uri="ftp://someuser@someftpserver.com?password=secret&amp;filter=#myFilter"/&gt;
    &lt;to uri="bean:processInbox"/&gt;
  &lt;/route&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_FilteringusingANTpathmatcher"></a>Filtering using ANT path matcher</h2></div></div></div><p>The ANT path matcher is a filter that is shipped out-of-the-box in the <span class="bold"><strong>camel-spring</strong></span> jar. So you need to depend on <span class="bold"><strong>camel-spring</strong></span> if you are using Maven.
      The reason is that we leverage Spring's
      <a class="link" href="http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/util/AntPathMatcher.html" target="_top">AntPathMatcher</a> to do the actual matching.</p><p>The file paths are matched with the following rules:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">?</code> matches one character</p></li><li class="listitem"><p><code class="literal">*</code> matches zero or more characters</p></li><li class="listitem"><p><code class="literal">**</code> matches zero or more directories in a path</p></li></ul></div><p>The sample below demonstrates how to use it:</p><pre class="programlisting">&lt;bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"/&gt;
&lt;camelContext xmlns="http://camel.apache.org/schema/spring"&gt;

    &lt;template id="camelTemplate"/&gt;

    &lt;!-- use myFilter as filter to allow setting ANT paths for which files to scan for --&gt;
    &lt;endpoint id="myFTPEndpoint" uri="ftp://admin@localhost:${SpringFileAntPathMatcherRemoteFileFilterTest.ftpPort}/antpath?password=admin&amp;ecursive=true&amp;elay=10000&amp;nitialDelay=2000&amp;ilter=#myAntFilter"/&gt;

    &lt;route&gt;
        &lt;from ref="myFTPEndpoint"/&gt;
        &lt;to uri="mock:result"/&gt;
    &lt;/route&gt;
&lt;/camelContext&gt;

&lt;!-- we use the AntPathMatcherRemoteFileFilter to use ant paths for includes and exclude --&gt;
&lt;bean id="myAntFilter" class="org.apache.camel.component.file.AntPathMatcherGenericFileFilter"&gt;
    &lt;!-- include any files in the sub-folder that have day in the name --&gt;
    &lt;property name="includes" value="**/subfolder/**/*day*"/&gt;
    &lt;!-- exclude all files with bad in name or .xml files. Use comma to seperate multiple excludes --&gt;
    &lt;property name="excludes" value="**/*bad*,**/*.xml"/&gt;
&lt;/bean&gt;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_UsingaproxywithSFTP"></a>Using a proxy with SFTP</h2></div></div></div><p></p><p>To use an HTTP proxy to connect to your remote host, you can configure your route in the following way:</p><pre class="programlisting">
&lt;!-- define our sorter as a plain spring bean --&gt;
&lt;bean id="proxy" class="com.jcraft.jsch.ProxyHTTP"&gt;
  &lt;constructor-arg value="localhost"/&gt;
  &lt;constructor-arg value="7777"/&gt;
&lt;/bean&gt;

&lt;route&gt;
  &lt;from uri="sftp://localhost:9999/root?username=admin&amp;password=admin&amp;proxy=#proxy"/&gt;
  &lt;to uri="bean:processFile"/&gt;
&lt;/route&gt;
</pre><p>You can also assign a user name and password to the proxy, if necessary. Please consult the documentation for <code class="literal">com.jcraft.jsch.Proxy</code> to discover all options.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scroll-bookmark-842"></a>Setting preferred SFTP authentication method</h2></div></div></div><p>If you want to explicitly specify the list of authentication methods that
            should be used by <code class="code">sftp</code> component, use
            <code class="code">preferredAuthentications</code> option. If for example you would like
            Camel to attempt to authenticate with private/public SSH key and fallback to
            user/password authentication in the case when no public key is available, use
            the following route configuration:</p><div class="informalexample"><pre class="programlisting">from("sftp://localhost:9999/root?username=admin&amp;password=admin&amp;preferredAuthentications=publickey,password")
  .to("bean:processFile");</pre></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Consumingasinglefileusingafixedname"></a>Consuming a single file using a fixed name</h2></div></div></div><p>When you want to download a single file and knows the file name, you can use <code class="literal">fileName=myFileName.txt</code> to tell Camel the name of the file to download. By default the consumer will still do a FTP LIST command to do a directory listing and then filter these files based on the <code class="literal">fileName</code> option. Though in this use-case it may be desirable to turn off the directory listing by setting <code class="literal">useList=false</code>. For example the user account used to login to the FTP server may not have permission to do a FTP LIST command. So you can turn off this with <code class="literal">useList=false</code>, and then provide the fixed name of the file to download with <code class="literal">fileName=myFileName.txt</code>, then the FTP consumer can still download the file. If the file for some reason does not exist, then Camel will by default throw an exception, you can turn this off and ignore this by setting <code class="literal">ignoreFileNotFoundOrPermissionError=true</code>.</p><p>For example to have a Camel route that pickup a single file, and delete it after use you can do</p><pre class="programlisting">
from("ftp://admin@localhost:21/nolist/?password=admin&amp;stepwise=false&amp;useList=false&amp;ignoreFileNotFoundOrPermissionError=true&amp;fileName=report.txt&amp;delete=true")
  .to("activemq:queue:report");
</pre><p>Notice that we have use all the options we talked above above.</p><p>You can also use this with <code class="literal">ConsumerTemplate</code>. For example to download a single file (if it exists) and grab the file content as a String type:</p><pre class="programlisting">
String data = template.retrieveBodyNoWait("ftp://admin@localhost:21/nolist/?password=admin&amp;stepwise=false&amp;useList=false&amp;ignoreFileNotFoundOrPermissionError=true&amp;fileName=report.txt&amp;delete=true", String.class);
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-FTP2_HSH_Debuglogging"></a>Debug logging</h2></div></div></div><p>This component has log level <span class="bold"><strong>TRACE</strong></span> that can be helpful if
      you have problems.</p></div></div></body></html>
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>To Add a Content-Based Router</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderEclipseHelp.html" title="Part&nbsp;I.&nbsp;Tooling Tutorials"><link rel="prev" href="RiderTutorialRun.html" title="To Run a Route"><link rel="next" href="RiderTutorialAddRoute.html" title="To Add Another Route to the CBR Routing Context"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="RiderTutorialCBR"></a>To Add a Content-Based Router</h2></div></div></div><p>This tutorial shows how to add a content-based router with logging to a
route.</p><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_goals_3"></a>Goals</h2></div></div></div><p>In this tutorial you will:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Add a content-based router to your route</li><li class="listitem"><p class="simpara">Configure the content-based router</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">Add a log endpoint to each output branch of the content-based router</li><li class="listitem">Add a Set Header EIP after each log endpoint</li><li class="listitem">Add an Otherwise branch to the content-based router</li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_prerequisites_4"></a>Prerequisites</h2></div></div></div><p>To complete this tutorial you will need the <span class="strong"><strong>CBRroute</strong></span>
project you created in <a class="xref" href="RiderTutorialCreate.html" title="To Create a New Route"><i>To Create a New Route</i></a>.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_adding_and_configuring_a_content_based_router"></a>Adding and configuring a content-based router</h2></div></div></div><p>To add and configure a content-based router for your route:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In <code class="literal">Project Explorer</code>, double-click <code class="literal">CBRroute/src/main/resources/OSGI-INF/blueprint/blueprint.xml</code> to
open your <code class="literal">CBRroute</code> project.</li><li class="listitem">On the canvas, select the <code class="literal">To_Others</code> node and then select
the trash can above and to the right to delete it.</li><li class="listitem"><p class="simpara">In the <code class="literal">Palette</code>, open the <code class="literal">Routing</code>
drawer and drag a <code class="literal">Choice</code> (
<span class="inlinemediaobject"><img src="images/choice.png" alt="Choice icon"></span>) pattern to the canvas and drop it in the
<code class="literal">Route_route1</code> container.</p><p class="simpara">The <code class="literal">Route_route1</code> container expands to accommodate the
<code class="literal">Choice_choice1</code> node.</p></li><li class="listitem"><p class="simpara">In the <code class="literal">Route_route1</code> container, select the
<code class="literal">From_from1</code> node
and drag its connector arrow over the <code class="literal">Choice_choice1</code> node,
then release it:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRaddChoice1.png" alt="tutCBRaddChoice1"></div></div></li><li class="listitem"><p class="simpara">In the <code class="literal">Properties</code> view, <code class="literal">_choice1</code>
appears in the <code class="literal">Id</code> field:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutRte1ChoicePropEdNew.png" alt="tutRte1ChoicePropEdNew"></div></div><p class="simpara">Leave the <code class="literal">Id</code> field as is.</p></li><li class="listitem"><p class="simpara">From the <code class="literal">Routing</code> drawer, drag a <code class="literal">When</code> (
<span class="inlinemediaobject"><img src="images/endpointdef.png" alt="When icon"></span>) pattern to the canvas and drop it on the
<code class="literal">Choice_choice1</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRaddWhen1.png" alt="tutCBRaddWhen1"></div></div><p class="simpara">The <code class="literal">Choice_choice1</code> container expands to accommodate the
<code class="literal">When_when1</code> node. The
<span class="inlinemediaobject"><img src="./images/warning_obj.gif" alt="warning icon"></span> decorating the <code class="literal">When_when1</code> node
indicates that one or more required property values must be set.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The tooling prevents you from dropping a pattern at an invalid drop point in a Route
container.</p></td></tr></table></div></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">When_when1</code> node, to open its
properties in the <code class="literal">Properties</code> view:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRWhen1OpenProps.png" alt="tutCBRWhen1OpenProps"></div></div></li><li class="listitem"><p class="simpara">Click the
<span class="inlinemediaobject"><img src="./images/popup_menu.gif" alt="drop-down menu icon"></span> button in the <code class="literal">Language</code> field to open
the list of available languages, and select
<code class="literal">xpath</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRWhen1Props.png" alt="tutCBRWhen1Props"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Once you select the expression <code class="literal">Language</code>, the
<code class="literal">Properties</code> view displays its properties in an
indented list directly below the <code class="literal">Language</code> field. The
<code class="literal">Id</code> property in this list sets the ID of the
expression. The <code class="literal">Id</code> property following the
<code class="literal">Description</code> field sets the ID of the
<code class="literal">When</code> node.</p></td></tr></table></div></li><li class="listitem"><p class="simpara">In the <code class="literal">Expression</code> field, enter
<code class="literal">/order/orderline/quantity/text() &gt;
/order/orderline/maxAllowed/text()</code>.</p><p class="simpara">This expression determines which messages will transit this path in the route.</p></li><li class="listitem"><p class="simpara">Leave each of the remaining properties as is.</p><p class="simpara">Enabling <code class="literal">Trim</code> removes any leading or trailing white
spaces and line breaks from the message.</p></li><li class="listitem">On the menu bar, click <span class="guimenu">File</span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"><code class="literal">Save</code></span> &gt; <span class="guimenuitem"></span> to save the routing context file.</li><li class="listitem"><p class="simpara">Click the <code class="literal">Source</code> tab to view the XML for the route:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRaddedSourceV.png" alt="tutCBRaddedSourceV"></div></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_adding_and_configuring_logging"></a>Adding and configuring logging</h2></div></div></div><p>To add logging to your route:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <code class="literal">Palette</code>, open the <code class="literal">Components</code>
drawer and select a <code class="literal">Log</code> (
<span class="inlinemediaobject"><img src="images/log.png" alt="Log icon"></span>) component.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">Log</code> component to the canvas and drop it on
the <code class="literal">When_when1</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRlog1Added.png" alt="tutCBRlog1Added"></div></div><p class="simpara">The <code class="literal">When_when1</code> container expands to accommodate the
<code class="literal">Log_log1</code> node.</p></li><li class="listitem">On the canvas, select the <code class="literal">Log_log1</code> node to open its properties in the
<code class="literal">Properties</code> view.</li><li class="listitem"><p class="simpara">In the <code class="literal">Message</code> field, enter <code class="literal">quantity requested
exceeds the maximum allowed - contact customer</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRlog1Properties.png" alt="tutCBRlog1Properties"></div></div></li><li class="listitem"><p class="simpara">Leave each of the remaining properties as is.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In the <code class="literal">Fuse Integration</code> perspective&#8217;s <code class="literal">Messages</code>
view, the tooling inserts the contents of the log node&#8217;s
<code class="literal">Id</code> field in the <code class="literal">Trace Node Id</code> column
for message instances, when tracing is enabled on the route
(see <a class="xref" href="RiderTutorialTrace.html" title="To Trace a Message Through a Route"><i>To Trace a Message Through a Route</i></a>). In the
<code class="literal">Console</code>, it adds the contents of the log node&#8217;s
<code class="literal">Message</code> field to the log data whenever the route
runs.</p></td></tr></table></div></li><li class="listitem">On the menu bar, click <span class="guimenu">File</span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"><code class="literal">Save</code></span> &gt; <span class="guimenuitem"></span> to save the routing context file.</li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_adding_and_configuring_message_headers"></a>Adding and configuring message headers</h2></div></div></div><p>To add and configure message headers:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <code class="literal">Palette</code>, open the
<code class="literal">Transformation</code> drawer and select a <code class="literal">Set
Header</code> (
<span class="inlinemediaobject"><img src="images/setHeader.png" alt="Set Header icon"></span>) pattern.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">Set Header</code> pattern to the canvas and drop it in
the <code class="literal">When_when1</code> container.</p><p class="simpara">The <code class="literal">When_when1</code> container expands to accommodate the
<code class="literal">SetHeader_setHeader1</code> node.</p></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">Log_log1</code> node and drag its connector arrow over
the <code class="literal">SetHeader_setHeader1</code> node, and then release it:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutSetHead1Added.png" alt="tutSetHead1Added"></div></div></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">SetHeader_setHeader1</code> node to open its
properties in the <code class="literal">Properties</code> view:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutSetHeadPropEdNew.png" alt="tutSetHeadPropEdNew"></div></div></li><li class="listitem"><p class="simpara">Click the
<span class="inlinemediaobject"><img src="./images/popup_menu.gif" alt="drop-down menu icon"></span> button in the <code class="literal">Language</code> field to open
the list of available languages, and select
<code class="literal">constant</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutSetHead1Properties2.png" alt="tutSetHead1Properties2"></div></div></li><li class="listitem">In the <code class="literal">Expression</code> field, enter
<code class="literal">InvalidOrders</code>.</li><li class="listitem">In the <code class="literal">Header Name</code> field, enter
<code class="literal">Destination</code>.</li><li class="listitem">Leave each of the remaining properties as is.</li><li class="listitem">In the <code class="literal">Palette</code>, open the <code class="literal">Components</code>
drawer and select the <code class="literal">File</code> (
<span class="inlinemediaobject"><img src="images/file.png" alt="File icon"></span>) component.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">File</code> component to the canvas and drop it
in the <code class="literal">When_when1</code> container.</p><p class="simpara">The <code class="literal">When_when1</code> container expands to accommodate the
<code class="literal">To_to1</code> node.</p></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">SetHeader_setHeader1</code> node and drag its
connector arrow over the <code class="literal">To_to1</code> node, and then release
it:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRWhen1TargetFile.png" alt="tutCBRWhen1TargetFile"></div></div></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">To_to1</code> node to open its properties in the
<code class="literal">Properties</code> view:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRNewTargetFileProps1.png" alt="tutCBRNewTargetFileProps1"></div></div></li><li class="listitem"><p class="simpara">On the <code class="literal">Details</code> tab, replace
<span class="emphasis"><em>directoryName</em></span> with
<code class="literal">target/messages/invalidOrders</code> in the
<code class="literal">Uri</code> field, and enter <code class="literal">_Invalid</code> in
the <code class="literal">Id</code> field:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRNewTargetFileProps2.png" alt="tutCBRNewTargetFileProps2"></div></div></li><li class="listitem">On the menu bar, click <span class="guimenu">File</span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"><code class="literal">Save</code></span> &gt; <span class="guimenuitem"></span> to save the routing context file.</li><li class="listitem"><p class="simpara">Click the <code class="literal">Source</code> tab to view the XML for the route:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRLogHeaderSourceV.png" alt="tutCBRLogHeaderSourceV"></div></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_adding_and_configuring_an_otherwise_branch"></a>Adding and configuring an otherwise branch</h2></div></div></div><p>To add and configure the otherwise branch of your route:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <code class="literal">Palette</code>, open the <span class="strong"><strong>Routing</strong></span> drawer and select the
<code class="literal">Otherwise</code> (
<span class="inlinemediaobject"><img src="images/endpointdef.png" alt="Otherwise icon"></span>) pattern.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">Otherwise</code> pattern to the canvas and drop
it into the <code class="literal">Choice_choice1</code> container:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRaddOtherwise.png" alt="tutCBRaddOtherwise"></div></div><p class="simpara">The <code class="literal">Choice_choice1</code> container expands to accommodate the
<code class="literal">Otherwise_otherwise1</code> node.</p></li><li class="listitem">On the canvas, select the <code class="literal">Otherwise_otherwise1</code> node to
open its properties in the <code class="literal">Properties</code>.</li><li class="listitem"><p class="simpara">In the <code class="literal">Id</code> field, enter <code class="literal">_else2</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseProps.png" alt="tutCBROtherwiseProps"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The <span class="strong"><strong>else2</strong></span> node will eventually route to the terminal
<span class="strong"><strong>file:</strong></span> node
(<code class="literal">file:target/messages/validOrders</code>) any message that does
not match the XPath expression set for the <span class="strong"><strong>When_when1</strong></span> node.</p></td></tr></table></div></li><li class="listitem">In the <code class="literal">Palette</code>, open the <code class="literal">Components</code>
drawer and select the <code class="literal">Log</code> (
<span class="inlinemediaobject"><img src="images/log.png" alt="Log icon"></span>) component.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">Log</code> component to the canvas and drop it on
the <code class="literal">Otherwise_else2</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseLogAdd.png" alt="tutCBROtherwiseLogAdd"></div></div><p class="simpara">The <code class="literal">Otherwise-else2</code> container expands to accommodate the
<code class="literal">Log_log2</code> node.</p></li><li class="listitem">On the canvas, select the <code class="literal">Log_log2</code> node to open its properties in
the <code class="literal">Properties</code> view.</li><li class="listitem"><p class="simpara">In the <code class="literal">Message</code> field, enter <code class="literal">valid order -
process</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseLog2.png" alt="tutCBROtherwiseLog2"></div></div><p class="simpara">Leave each of the remaining properties as is.</p></li><li class="listitem">In the <code class="literal">Palette</code>, open the
<code class="literal">Transformation</code> drawer and select the <code class="literal">Set
Header</code> pattern.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">Set Header</code> pattern to the canvas and drop it into the
<code class="literal">Otherwise_else2</code> container.</p><p class="simpara">The <code class="literal">Otherwise_else2</code> container expands to accommodate
the <code class="literal">SetHeader_setHeader2</code> node.</p></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">Log_log2</code> node and drag its
connector arrow over the <code class="literal">SetHeader_setHeader2</code> node, and
then release it:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRSetHead2Add.png" alt="tutCBRSetHead2Add"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You can collapse containers to free up space when the diagram becomes congested. To do so,
select the container you want to collapse, and then click its
<span class="inlinemediaobject"><img src="./images/collapse.gif" alt="collapse icon"></span> button:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRcollapseWhen1Container.png" alt="tutCBRcollapseWhen1Container"></div></div><p>To reopen the container, select it and then click its
<span class="inlinemediaobject"><img src="./images/expand.gif" alt="expand icon"></span> button:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRexpandWhen1Container.png" alt="tutCBRexpandWhen1Container"></div></div><p>Collapsing and expanding containers in the <code class="literal">Design</code>
tab does not affect the routing context file. It remains unchanged.</p></td></tr></table></div></li><li class="listitem">On the canvas, select the <code class="literal">SetHeader_setHeader2</code> node to open its
properties in the <code class="literal">Properties</code> view.</li><li class="listitem"><p class="simpara">Click the
<span class="inlinemediaobject"><img src="./images/popup_menu.gif" alt="drop-down menu icon"></span> button in the <code class="literal">Language</code> field to open
the list of available languages, and select
<code class="literal">constant</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseSetHeadProps2.png" alt="tutCBROtherwiseSetHeadProps2"></div></div></li><li class="listitem">In the <code class="literal">Expression</code> field, enter
<code class="literal">Dispatcher</code>.</li><li class="listitem">In the <code class="literal">Header Name</code> field, enter
<code class="literal">Destination</code>.</li><li class="listitem">Leave each of the remaining properties as is.</li><li class="listitem">In the <code class="literal">Palette</code>, open the <code class="literal">Components</code>
drawer and select the <code class="literal">File</code> (
<span class="inlinemediaobject"><img src="images/file.png" alt="File icon"></span>) component.</li><li class="listitem"><p class="simpara">Drag the <code class="literal">File</code> component to the canvas and drop it into the
<code class="literal">Otherwise_else2</code> container.</p><p class="simpara">The <code class="literal">Otherwise_else2</code> container expands to accommodate the
<code class="literal">To_to1</code> node.</p></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">SetHeader_setHeader2</code> node, and drag its
connector arrow over the <code class="literal">To_to1</code> node and then release
it:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseFileAdd.png" alt="tutCBROtherwiseFileAdd"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">To_to1</code> node to open its
properties in the <code class="literal">Properties</code> view.</li><li class="listitem"><p class="simpara">In the <code class="literal">URI</code> field, replace <span class="emphasis"><em>directoryName</em></span> with
<code class="literal">target/messages/validOrders</code>, and in the
<code class="literal">Id</code> field, enter
<code class="literal">_Valid</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBROtherwiseTargFile2.png" alt="tutCBROtherwiseTargFile2"></div></div></li><li class="listitem"><p class="simpara">On the menu bar, click <span class="guimenu">File</span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"></span> &gt; <span class="guisubmenu"><code class="literal">Save</code></span> &gt; <span class="guimenuitem"></span> to save the routing context file.</p><p class="simpara">This is the completed content-based router with logs and message
headers:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRfinalDesignV.png" alt="tutCBRfinalDesignV"></div></div></li><li class="listitem"><p class="simpara">Click the <code class="literal">Source</code> tab at the bottom,
left of the canvas to display the XML for the route.</p><p class="simpara">The camelContext element will
look like that shown in <a class="xref" href="RiderTutorialCBR.html#CBREx010" title="Example&nbsp;3.&nbsp;XML for content-based router">Example&nbsp;3, &#8220;XML for content-based router&#8221;</a>.</p><div class="example"><a name="CBREx010"></a><p class="title"><b>Example&nbsp;3.&nbsp;XML for content-based router</b></p><div class="example-contents"><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0
    https://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
    http://camel.apache.org/schema/blueprint
    http://camel.apache.org/schema/blueprint/camel-blueprint.xsd"&gt;

  &lt;camelContext id="_context1" xmlns="http://camel.apache.org/schema/blueprint"&gt;
    &lt;route id="_route1"&gt;
        &lt;from id="_from1" uri="file:src/data?noop=true"/&gt;
        &lt;choice id="_choice1"&gt;
           &lt;when id="_when1"&gt;
              &lt;xpath&gt;order/orderline/quantity/text() &gt; /order/orderline/maxAllowed/text()&lt;/xpath&gt;
              &lt;log id="_log1" message="quantity requested exceeds the maximum allowed - contact customer"/&gt;
              &lt;setHeader headerName="Destination" id="_setHeader1"&gt;
                  &lt;constant&gt;InvalidOrders&lt;/constant&gt;
              &lt;/setHeader&gt;
              &lt;to id="_Invalid" uri="file:target/messages/invalidOrders"/&gt;
           &lt;/when&gt;
           &lt;otherwise id="_else2"&gt;
              &lt;log id="_log2" message="valid order - process"/&gt;
              &lt;setHeader headerName="Destination" id="_setHeader2"&gt;
                  &lt;constant&gt;Dispatcher&lt;/constant&gt;
              &lt;/setHeader&gt;
              &lt;to id="_Valid" uri="file:target/messages/validOrders"/&gt;
           &lt;/otherwise&gt;
        &lt;/choice&gt;
    &lt;/route&gt;
  &lt;/camelContext&gt;
&lt;/blueprint&gt;</pre></div></div><br class="example-break"></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_next_steps_2"></a>Next steps</h2></div></div></div><p>You can run the new route as described in <a class="xref" href="RiderTutorialRun.html#RiderRunRun" title="Running the route">Running the route</a>.</p><p>After you run it, you can easily verify whether the route executed
properly by checking the target destinations in <code class="literal">Project
Explorer</code>:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Select <code class="literal">CBRroute</code>.</li><li class="listitem">Right-click it to open the context menu, then select
<code class="literal">Refresh</code>.</li><li class="listitem"><p class="simpara">Under the project root node
(<code class="literal">CBRroute</code>), locate the folder
<code class="literal">target/messages/</code> and expand it.</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutSimpCBRrouteVerify.png" alt="message destinations"></div></div></li><li class="listitem"><p class="simpara">Check that the <code class="literal">target/messages/invalidOrders</code> folder
contains <code class="literal">message2.xml</code> and
<code class="literal">message4.xml</code>.</p><p class="simpara">In these messages, the value of the
<code class="literal">quantity</code> element should
exceed the value of the
<code class="literal">maxAllowed</code>
element.</p></li><li class="listitem"><p class="simpara">Check that the <code class="literal">target/messages/validOrders</code> folder contains the four
message files that contain valid orders:
<code class="literal">message1.xml</code>,
<code class="literal">message3.xml</code> ,
<code class="literal">message5.xml</code> and
<code class="literal">message6.xml</code>.</p><p class="simpara">In these messages, the value of the
<code class="literal">quantity</code> element should
be less than or equal to the value of the
<code class="literal">maxAllowed</code>
element.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>To view message content, double-click each message to open it in the route editor&#8217;s XML
editor.</p></td></tr></table></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_further_reading_3"></a>Further reading</h2></div></div></div><p>To learn more about message enrichment see:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_JBoss_Fuse/6.3/html/Apache_Camel_Development_Guide/index.html" target="_top">Red Hat JBoss Fuse: Apache Camel Development Guide</a></li><li class="listitem"><a class="link" href="https://access.redhat.com/documentation/en/red-hat-jboss-fuse/" target="_top">Red Hat JBoss Fuse 6.3 documentation</a></li></ul></div></div></div></body></html>
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Jetty</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-JDBC.html" title="JDBC"><link rel="next" href="IDU-JGroups.html" title="JGroups"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-Jetty"></a>Jetty</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_JettyComponent"></a>Jetty Component</h2></div></div></div><p>The <span class="bold"><strong>jetty</strong></span> component provides HTTP-based <span class="phrase">endpoints</span> for consuming and producing HTTP requests. That
            is, the Jetty component behaves as a simple Web server. Jetty can also be used as a http
            client which mean you can also use it with Camel as a producer.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: Stream"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Stream</th></tr><tr><td align="left" valign="top"><p>Jetty is stream based, which means the input it receives is submitted to Camel as
                a stream. That means you will only be able to read the content of the stream
                    <span class="bold"><strong>once</strong></span>. If you find a situation where the message
                body appears to be empty or you need to access the
                    <code class="code">Exchange.HTTP_RESPONSE_CODE</code> data multiple times (for example, doing
                multicasting, or redelivery error handling) you should use Stream Caching or convert
                the message body to a <code class="literal">String</code> which is safe to be re-read multiple
                times.</p></td></tr></table></div><p>Maven users will need to add the following dependency to their
                <code class="literal">pom.xml</code> for this component:</p><pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-jetty&lt;/artifactId&gt;
    &lt;version&gt;x.x.x&lt;/version&gt;
    &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">jetty:http://hostname[:port][/resourceUri][?options]</pre><p>You can append query options to the URI in the following format,
                <code class="literal">?option=value&amp;option=value&amp;...</code>
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_Options"></a>Options</h2></div></div></div><table id="d0e107853"><tr>
                <th> Name </th>
                <th> Default Value </th>
                <th> Description </th>
            </tr><tr>
                <td><code class="literal">sessionSupport</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td> Specifies whether to enable the session manager on the server side of Jetty.
                </td>
            </tr><tr>
                <td><code class="literal">httpClient.XXX</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td> Configuration of Jetty's <a class="link" href="http://wiki.eclipse.org/Jetty/Tutorial/HttpClient" target="_top">HttpClient</a>. For example, setting
                        <code class="literal">httpClient.idleTimeout=30000</code> sets the idle timeout to 30
                    seconds. </td>
            </tr><tr>
                <td><code class="literal">httpClient</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td> To use a shared <code class="literal">org.eclipse.jetty.client.HttpClient</code> for all
                    producers created by this endpoint. This option should only be used in special
                    circumstances. </td>
            </tr><tr>
                <td><code class="literal">httpClientMinThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11:</strong></span><span class="bold"><strong>Producer
                        only</strong></span>: To set a value for minimum number of threads in
                        <code class="literal">HttpClient</code> thread pool. This setting override any setting
                    configured on component level. Notice that both a min and max size must be
                    configured. If not set it default to min 8 threads used in Jetty's thread pool.
                </td>
            </tr><tr>
                <td><code class="literal">httpClientMaxThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11:</strong></span><span class="bold"><strong>Producer
                        only</strong></span>: To set a value for maximum number of threads in
                        <code class="literal">HttpClient</code> thread pool. This setting override any setting
                    configured on component level. Notice that both a min and max size must be
                    configured. If not set it default to max 16 threads used in Jetty's thread pool. </td>
            </tr><tr>
                <td><code class="literal">httpBindingRef</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td> Reference to an <code class="literal">org.apache.camel.component.http.HttpBinding</code>
                    in the Registry. <code class="literal">HttpBinding</code>
                    can be used to customize how a response should be written for the consumer.
                </td>
            </tr><tr>
                <td><code class="literal">jettyHttpBindingRef</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.6.0+:</strong></span> Reference to an
                        <code class="literal">org.apache.camel.component.jetty.JettyHttpBinding</code> in the
                        Registry.
                        <code class="literal">JettyHttpBinding</code> can be used to customize how a response
                    should be written for the producer. </td>
            </tr><tr>
                <td><code class="literal">matchOnUriPrefix</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td> Whether or not the <code class="literal">CamelServlet</code> should try to find a target
                    consumer by matching the URI prefix if no exact match is found. See here <a class="link" href="https://camel.apache.org/how-do-i-let-jetty-match-wildcards.html" target="_top">How do I let Jetty match wildcards</a>. </td>
            </tr><tr>
                <td><code class="literal">handlers</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td> Specifies a comma-delimited set of <code class="literal">org.mortbay.jetty.Handler</code>
                    instances in your Registry (such as your Spring
                        <code class="literal">ApplicationContext</code>). These handlers are added to the
                    Jetty servlet context (for example, to add security). </td>
            </tr><tr>
                <td><code class="literal">chunked</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.2:</strong></span> If this option is false Jetty
                    servlet will disable the HTTP streaming and set the content-length header on the
                    response </td>
            </tr><tr>
                <td><code class="literal">enableJmx</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.3:</strong></span> If this option is true, Jetty JMX
                    support will be enabled for this endpoint.</td>
            </tr><tr>
                <td><code class="literal">disableStreamCache</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.3:</strong></span> Determines whether or not the raw
                    input stream from Jetty is cached or not (Camel will read the stream into a in
                    memory/overflow to file, <a class="link" href="http://camel.apache.org/stream-caching.html" target="_top">Stream caching</a>)
                    cache. By default Camel will cache the Jetty input stream to support reading it
                    multiple times to ensure it Camel can retrieve all data from the stream. However
                    you can set this option to <code class="literal">true</code> when you for example need to
                    access the raw stream, such as streaming it directly to a file or other
                    persistent store. DefaultHttpBinding will copy the request input stream into a
                    stream cache and put it into message body if this option is
                        <code class="literal">false</code> to support reading the stream multiple times. If
                    you use <a href="IDU-Jetty.html" class="olink">Jetty</a> to bridge/proxy an endpoint
                    then consider enabling this option to improve performance, in case you do not
                    need to read the message payload multiple times. </td>
            </tr><tr>
                <td><code class="literal">throwExceptionOnFailure</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td> Option to disable throwing the <code class="literal">HttpOperationFailedException</code>
                    in case of failed responses from the remote server. This allows you to get all
                    responses regardles of the HTTP status code. </td>
            </tr><tr>
                <td><code class="literal">transferException</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td><span class="bold"><strong>Camel 2.6:</strong></span> If enabled and an <a class="link" href="Exchange" target="_top">Exchange</a> failed processing on the consumer side,
                    and if the caused Exception was send back serialized in the response as a
                        <code class="literal">application/x-java-serialized-object</code> content type. On the
                    producer side the exception will be deserialized and thrown as is, instead of
                    the <code class="literal">HttpOperationFailedException</code>. The caused exception is
                    required to be serialized. </td>
            </tr><tr>
                <td><code class="literal">bridgeEndpoint</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td>
                    <p> &gt;<span class="bold"><strong>Camel 2.1:</strong></span> If the option is true ,
                        HttpProducer will ignore the Exchange.HTTP_URI header, and use the
                        endpoint's URI for request. You may also set the <span class="bold"><strong>throwExceptionOnFailure</strong></span> to be false to let the HttpProducer
                        send all the fault response back. <span class="bold"><strong>Camel
                            2.3:</strong></span> If the option is true, HttpProducer and CamelServlet
                        will skip the gzip processing if the content-encoding is "gzip". Also
                        consider setting <span class="bold"><strong>disableStreamCache</strong></span> to true
                        to optimize when bridging. </p>
                </td>
            </tr><tr>
                <td><code class="literal">enableMultipartFilter</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5:</strong></span> Whether Jetty
                        <code class="literal">org.eclipse.jetty.servlets.MultiPartFilter</code> is enabled or
                    not. You should set this value to <code class="literal">false</code> when bridging
                    endpoints, to ensure multipart requests is proxied/bridged as well. </td>
            </tr><tr>
                <td><code class="literal">multipartFilterRef</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.6:</strong></span> Allows using a custom multipart
                    filter. Note: setting <code class="literal">multipartFilterRef</code> forces the value of
                        <code class="literal">enableMultipartFilter</code> to <code class="literal">true</code>. </td>
            </tr><tr>
                <td><code class="literal">filterInit.xxx</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.17:</strong></span> Configuration for the
                        <code class="code">InitParameters</code> of filter. For example, setting
                        <code class="code">filterInit.parameter=value</code>, the parameter could be used when
                    calling the filter <code class="code">init</code> method.</td>
            </tr><tr>
                <td><code class="literal">filtersRef</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.9:</strong></span> Allows using a custom filters which
                    is putted into a list and can be find in the <a class="link" href="Registry" target="_top">Registry</a>
                </td>
            </tr><tr>
                <td><code class="literal">continuationTimeout</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.6:</strong></span> Allows to set a timeout in millis
                    when using <a href="IDU-Jetty.html" class="olink">Jetty</a> as consumer (server). By
                    default Jetty uses 30000. You can use a value of <code class="literal">&lt;= 0</code> to
                    never expire. If a timeout occurs then the request will be expired and Jetty
                    will return back a http error 503 to the client. This option is only in use when
                    using <a href="IDU-Jetty.html" class="olink">Jetty</a> with the <a class="link" href="http://camel.apache.org/asynchronous-routing-engine.html" target="_top">Asynchronous Routing Engine</a>.
                </td>
            </tr><tr>
                <td><code class="literal">useContinuation</code>
                </td>
                <td><code class="literal">true</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.6:</strong></span> Whether or not to use <a class="link" href="http://wiki.eclipse.org/Jetty/Feature/Continuations" target="_top">Jetty
                        continuations</a> for the Jetty Server. </td>
            </tr><tr>
                <td><code class="literal">sslContextParametersRef</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Deprecated:</strong></span>
                    <span class="bold"><strong>Camel 2.8:</strong></span> Reference to a
                        <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> in the
                    Registry. This reference overrides any configured SSLContextParameters at the
                    component level. See <a class="xref" href="IDU-Jetty.html#IDU-Jetty_HSH_UsingtheJSSEConfigurationUtility" title="Using the JSSE Configuration Utility">Using the JSSE Configuration Utility</a>. </td>
            </tr><tr>
                <td><code class="literal">sslContextParameters</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.17:</strong></span> Reference to a
                        <code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> in the
                    Registry. This reference overrides any configured SSLContextParameters at the
                    component level. See <a class="xref" href="IDU-Jetty.html#IDU-Jetty_HSH_UsingtheJSSEConfigurationUtility" title="Using the JSSE Configuration Utility">Using the JSSE Configuration Utility</a>. </td>
            </tr><tr>
                <td><code class="literal">traceEnabled</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td> Specifies whether to enable HTTP TRACE for this Jetty consumer. By default
                    TRACE is turned off. </td>
            </tr><tr>
                <td><code class="literal">optionsEnabled</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td><span class="bold"><strong>Camel 2.17:</strong></span> Specifies whether to enable HTTP
                    OPTIONS for this Jetty consumer. By default OPTIONS is turned off. </td>
            </tr><tr>
                <td><code class="literal">headerFilterStrategy</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11:</strong></span> Reference to a instance of
                        <code class="literal">org.apache.camel.spi.HeaderFilterStrategy</code> in the <a class="link" href="Registry" target="_top">Registry</a>. It will be used to apply the custom
                    headerFilterStrategy on the new create HttpJettyEndpoint. </td>
            </tr><tr>
                <td><p>
                        <code class="code">httpMethodRestrict</code>
                    </p></td>
                <td><p>
                        <code class="code">null</code>
                    </p></td>
                <td><p>
                        <span class="emphasis"><em>Camel 2.11: Consumer only</em></span>: Used to only allow consuming
                        if the <code class="code">HttpMethod</code> matches, such as
                            <code class="code">GET</code>/<code class="code">POST</code>/<code class="code">PUT</code> etc. From <span class="bold"><strong>Camel 2.15</strong></span> onwards multiple methods can be
                        specified separated by comma.</p></td>
            </tr><tr>
                <td><code class="literal">responseBufferSize</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.12:</strong></span> To use a custom buffer size on the
                        <code class="literal">javax.servlet.ServletResponse</code>. </td>
            </tr><tr>
                <td><p>
                        <code class="code">proxyHost</code>
                    </p></td>
                <td><p>
                        <code class="code">null</code>
                    </p></td>
                <td><p>
                        <span class="emphasis"><em>Camel 2.11: Producer only</em></span> The http proxy Host url which will be used by
                        Jetty client. </p></td>
            </tr><tr>
                <td><p>
                        <code class="code">proxyPort</code>
                    </p></td>
                <td><p>
                        <code class="code">null</code>
                    </p></td>
                <td><p>
                        <span class="emphasis"><em>Camel 2.11: Producer only</em></span> The http proxy port which will be used by
                        Jetty client. </p></td>
            </tr><tr>
                <td><p>
                        <code class="code">sendServerVersion</code>
                    </p></td>
                <td><p>
                        <code class="code">true</code>
                    </p></td>
                <td><p>
                        <span class="emphasis"><em>Camel 2.13:</em></span> if the option is true, jetty will send the
                        server header with the jetty version information to the client which sends
                        the request. NOTE please make sure there is no any other
                        camel-jetty endpoint is share the same port, otherwise this option may not
                        work as expected. </p></td>
            </tr><tr>
                <td><p>
                        <code class="code">sendDateHeader</code>
                    </p></td>
                <td><p>
                        <code class="code">false</code>
                    </p></td>
                <td><p>
                        <span class="emphasis"><em>Camel 2.14:</em></span> if the option is true, jetty server will
                        send the date header to the client which sends the request.
                            NOTE please make sure there is no any other camel-jetty
                        endpoint is share the same port, otherwise this option may not work as
                        expected.</p></td>
            </tr><tr>
                <td>
                    <p>
                        <code class="code">enableCORS</code>
                    </p>
                </td>
                <td>
                    <p>
                        <code class="code">false</code>
                    </p>
                </td>
                <td>
                    <p>
                        <span class="emphasis"><em>Camel 2.15:</em></span> if the option is <code class="code">true</code>, Jetty
                        server will set up the <code class="code">CrossOriginFilter</code> which supports the
                        CORS out of box.</p>
                </td>
            </tr><tr>
                <td>
                    <p>
                        <code class="code">okStatusCodeRange</code>
                    </p>
                </td>
                <td>
                    <p>
                        <code class="code">200-299</code>
                    </p>
                </td>
                <td>
                    <p><span class="emphasis"><em>Camel 2.16:</em></span> Producer only. The status codes which are
                        considered a success response. The values are inclusive. The range must be
                        defined using the syntax,
                                <code class="code"><em class="replaceable"><code>from</code></em>-<em class="replaceable"><code>to</code></em></code>.</p>
                </td>
            </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_MessageHeaders"></a>Message Headers</h2></div></div></div><p>Camel uses the same message headers as the <a href="IDU-HTTP.html" class="olink">HTTP</a>
            component. From Camel 2.2, it also uses (Exchange.HTTP_CHUNKED,CamelHttpChunked) header
            to turn on or turn off the chuched encoding on the camel-jetty consumer.</p><p>Camel also populates <span class="bold"><strong>all</strong></span> request.parameter and
            request.headers. For example, given a client request with the URL, <code class="literal">
                <a class="link" href="http://myserver/myserver?orderid=123" target="_top">http://myserver/myserver?orderid=123</a></code>, the exchange will
            contain a header named <code class="literal">orderid</code> with the value 123. </p><p>Starting with Camel 2.2.0, you can get the request.parameter from the message header
            not only from Get Method, but also other HTTP method.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_Usage"></a>Usage</h2></div></div></div><p>The Jetty component supports both consumer and producer endpoints. Another option for
            producing to other HTTP endpoints, is to use the <a href="IDU-HTTP.html" class="olink">HTTP
                Component</a>
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ComponentOptions"></a>Component Options</h2></div></div></div><p>The <code class="literal">JettyHttpComponent</code> provides the following options:
            
        </p><table id="d0e108707"><tr>
                <th> Name </th>
                <th> Default Value </th>
                <th> Description </th>
            </tr><tr>
                <td><code class="literal">enableJmx</code>
                </td>
                <td><code class="literal">false</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.3:</strong></span> If this option is true, Jetty JMX
                    support will be enabled for this endpoint.</td>
            </tr><tr>
                <td><code class="literal">sslKeyPassword</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Consumer only</strong></span>: The password for the keystore
                    when using SSL. </td>
            </tr><tr>
                <td><code class="literal">sslPassword</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Consumer only</strong></span>: The password when using SSL.
                </td>
            </tr><tr>
                <td><code class="literal">sslKeystore</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Consumer only</strong></span>: The path to the keystore. </td>
            </tr><tr>
                <td><code class="literal">minThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only</strong></span>: To set a value for minimum
                    number of threads in server thread pool. </td>
            </tr><tr>
                <td><code class="literal">maxThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only</strong></span>: To set a value for maximum
                    number of threads in server thread pool. </td>
            </tr><tr>
                <td><code class="literal">threadPool</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only</strong></span>: To use a custom thread pool for
                    the server. </td>
            </tr><tr>
                <td><code class="literal">sslSocketConnectors</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.3</strong></span>
                    <span class="bold"><strong>Consumer only:</strong></span> A map which contains per port
                    number specific SSL connectors. See section <span class="emphasis"><em>SSL support</em></span> for
                    more details. </td>
            </tr><tr>
                <td><code class="literal">socketConnectors</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only:</strong></span> A map which contains per port
                    number specific HTTP connectors. Uses the same principle as
                        <code class="literal">sslSocketConnectors</code> and therefore see section
                        <span class="emphasis"><em>SSL support</em></span> for more details. </td>
            </tr><tr>
                <td><code class="literal">sslSocketConnectorProperties</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only</strong></span>. A map which contains general SSL
                    connector properties. See section <span class="emphasis"><em>SSL support</em></span> for more
                    details. </td>
            </tr><tr>
                <td><code class="literal">socketConnectorProperties</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td>
                    <span class="bold"><strong>Camel 2.5</strong></span>
                    <span class="bold"><strong>Consumer only</strong></span>. A map which contains general
                    HTTP connector properties. Uses the same principle as
                        <code class="literal">sslSocketConnectorProperties</code> and therefore see section
                        <span class="emphasis"><em>SSL support</em></span> for more details. </td>
            </tr><tr>
                <td><code class="literal">httpClient</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Deprecated:</strong></span><span class="bold"><strong>Producer
                        only</strong></span>: To use a custom <code class="literal">HttpClient</code> with the
                    jetty producer. This option is removed from Camel 2.11 onwards, instead you can
                    set the option on the endpoint instead. </td>
            </tr><tr>
                <td><code class="literal">httpClientMinThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Producer only</strong></span>: To set a value for minimum
                    number of threads in <code class="literal">HttpClient</code> thread pool. Notice that both
                    a min and max size must be configured. </td>
            </tr><tr>
                <td><code class="literal">httpClientMaxThreads</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Producer only</strong></span>: To set a value for maximum
                    number of threads in <code class="literal">HttpClient</code> thread pool. Notice that both
                    a min and max size must be configured. </td>
            </tr><tr>
                <td><code class="literal">httpClientThreadPool</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Deprecated:</strong></span><span class="bold"><strong>Producer
                        only</strong></span>: To use a custom thread pool for the client. This option is
                    removed from Camel 2.11 onwards. </td>
            </tr><tr>
                <td><code class="literal">sslContextParameters</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.8:</strong></span> To configure a custom SSL/TLS
                    configuration options at the component level. For details, see <a class="xref" href="IDU-Jetty.html#IDU-Jetty_HSH_UsingtheJSSEConfigurationUtility" title="Using the JSSE Configuration Utility">Using the JSSE Configuration Utility</a>.</td>
            </tr><tr>
                <td><code class="literal">requestBufferSize</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.2:</strong></span> Allows to configure a custom
                    value of the request buffer size on the Jetty connectors. </td>
            </tr><tr>
                <td><code class="literal">requestHeaderSize</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.2:</strong></span> Allows to configure a custom
                    value of the request header size on the Jetty connectors. </td>
            </tr><tr>
                <td><code class="literal">responseBufferSize</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.2:</strong></span> Allows to configure a custom
                    value of the response buffer size on the Jetty connectors. </td>
            </tr><tr>
                <td><code class="literal">responseHeaderSize</code>
                </td>
                <td><code class="literal">null</code>
                </td>
                <td><span class="bold"><strong>Camel 2.11.2:</strong></span> Allows to configure a custom
                    value of the response header size on the Jetty connectors. </td>
            </tr><tr>
                <td><p> <code class="code">proxyHost</code> </p></td>
                <td><p> <code class="code">null</code> </p></td>
                <td><p> <span class="emphasis"><em>Camel 2.12.2/2.11.3</em></span> To use a http proxy. </p></td>
            </tr><tr>
                <td><p> <code class="code">proxyPort</code> </p></td>
                <td><p> <code class="code">null</code> </p></td>
                <td><p> <span class="emphasis"><em>Camel 2.12.2/2.11.3:</em></span> To use a http proxy. </p></td>
            </tr><tr>
                <td>
                    <p>
                        <code class="code">errorHandler</code>
                    </p>
                </td>
                <td>
                    <p>
                        <code class="code">null</code>
                    </p>
                </td>
                <td>
                    <p>
                        <span class="emphasis"><em>Camel 2.15:</em></span> This option is used to set the ErrorHandler
                        that Jetty server uses.</p>
                </td>
            </tr><tr>
                <td>
                    <p>
                        <code class="code">allowJavaSerializedObject</code>
                    </p>
                </td>
                <td>
                    <p>
                        <code class="code">false</code>
                    </p>
                </td>
                <td>
                    <p><span class="bold"><strong>Camel 2.16.1/2.15.5:</strong></span> Whether to allow
                        java serialization when a request uses
                            <code class="code">context-type=application/x-java-serialized-object</code>. This is
                        turned off by default. <span class="bold"><strong>Warning</strong></span>: If you
                        enable this option, be aware that Java will deserialize the incoming data
                        from the request to Java and that can be a potential security risk</p>
                </td>
            </tr></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ProducerExample"></a>Producer Example</h2></div></div></div><p>The following is a basic example of how to send an HTTP request to an existing HTTP
            endpoint.</p><p>in Java DSL</p><pre class="programlisting">from("direct:start").to("jetty://http://www.google.com");</pre><p>or in Spring XML</p><pre class="programlisting">&lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;to uri="jetty://http://www.google.com"/&gt;
&lt;route&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ConsumerExample"></a>Consumer Example</h2></div></div></div><p>In this sample we define a route that exposes a HTTP service at <code class="literal">
                <a class="link" href="http://localhost:8080/myapp/myservice" target="_top">http://localhost:8080/myapp/myservice</a></code>:</p><pre class="programlisting">from("jetty:http://localhost:{{port}}/myapp/myservice").process(new MyBookService());</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Usage of localhost"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Usage of localhost</th></tr><tr><td align="left" valign="top"><p>When you specify <code class="literal">localhost</code> in a URL, Camel exposes the endpoint
                only on the local TCP/IP network interface, so it cannot be accessed from outside
                the machine it operates on.</p><p>If you need to expose a Jetty endpoint on a specific network interface, the
                numerical IP address of this interface should be used as the host. If you need to
                expose a Jetty endpoint on all network interfaces, the <code class="literal">0.0.0.0</code>
                address should be used.</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>To listen across an entire URI prefix, see <a class="link" href="https://camel.apache.org/how-do-i-let-jetty-match-wildcards.html" target="_top">How
                    do I let Jetty match wildcards</a>.</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>If you actually want to expose routes by HTTP and already have a Servlet, you
                should instead refer to the <a class="link" href="https://cxf.apache.org/docs/servlet-transport.html" target="_top">Servlet
                    Transport</a>.</p></td></tr></table></div><p>Our business logic is implemented in the <code class="literal">MyBookService</code> class, which
            accesses the HTTP request contents and then returns a response. <span class="bold"><strong>Note:</strong></span> The <code class="literal">assert</code> call appears in this example,
            because the code is part of an unit test.</p><pre class="programlisting">public class MyBookService implements Processor {
    public void process(Exchange exchange) throws Exception {
        // just get the body as a string
        String body = exchange.getIn().getBody(String.class);

        // we have access to the HttpServletRequest here and we can grab it if we need it
        HttpServletRequest req = exchange.getIn().getBody(HttpServletRequest.class);
        assertNotNull(req);

        // for unit testing
        assertEquals("bookid=123", body);

        // send a html response
        exchange.getOut().setBody("&lt;html&gt;&lt;body&gt;Book 123 is Camel in Action&lt;/body&gt;&lt;/html&gt;");
    }
}</pre><p>The following sample shows a content-based route that routes all requests containing
            the URI parameter, <code class="literal">one</code>, to the endpoint, <code class="literal">mock:one</code>,
            and all others to <code class="literal">mock:other</code>.</p><pre class="programlisting">from("jetty:" + serverUri)
    .choice()
    .when().simple("${header.one}").to("mock:one")
    .otherwise()
    .to("mock:other");
</pre><p>So if a client sends the HTTP request, <code class="literal">
                <a class="link" href="http://serverUri?one=hello" target="_top">http://serverUri?one=hello</a></code>, the Jetty component will copy the HTTP
            request parameter, <code class="literal">one</code> to the exchange's
            <code class="literal">in.header</code>. We can then use the <code class="literal">simple</code> language to
            route exchanges that contain this header to a specific endpoint and all others to
            another. If we used a language more powerful than <a class="link" href="http://camel.apache.org/simple.html" target="_top">Simple</a>\-\--such as- <span class="del">
                <a class="link" href="http://camel.apache.org/el.html" target="_top">El</a></span> or <span class="del">
                <a class="link" href="https://struts.apache.org/docs/ognl.html" target="_top">OGNL</a></span>\--we could also test for the parameter
            value and do routing based on the header value as well.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_SessionSupport"></a>Session Support</h2></div></div></div><p>The session support option, <code class="literal">sessionSupport</code>, can be used to enable a
                <code class="literal">HttpSession</code> object and access the session object while processing
            the exchange. For example, the following route enables sessions:</p><pre class="programlisting">
&lt;route&gt;
    &lt;from uri="jetty:http://0.0.0.0/myapp/myservice/?sessionSupport=true"/&gt;
    &lt;processRef ref="myCode"/&gt;
&lt;route&gt;
</pre><p>The <code class="literal">myCode</code>
            <a class="link" href="Processor" target="_top">Processor</a> can be instantiated by a Spring
                <code class="literal">bean</code> element:</p><pre class="programlisting">
&lt;bean id="myCode"class="com.mycompany.MyCodeProcessor"/&gt;
</pre><p>Where the processor implementation can access the <code class="literal">HttpSession</code> as
            follows:</p><pre class="programlisting">
public void process(Exchange exchange) throws Exception {
    HttpSession session = exchange.getIn(HttpMessage.class).getRequest().getSession();
    ...
}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_UsingtheJSSEConfigurationUtility"></a>Using the JSSE Configuration Utility</h2></div></div></div><p>As of Camel 2.8, the Jetty component supports SSL/TLS configuration through the <a href="IDU-HTTP.html#IDU-HTTP_HSH_UsingtheJSSEConfigurationUtility" class="olink">Camel JSSE Configuration
            Utility</a>. This utility greatly
            decreases the amount of component specific code you need to write and is configurable at
            the endpoint and component levels.&nbsp;The following examples demonstrate how to use
            the utility with the Jetty component.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_Programmaticconfigurationofthecomponent"></a>Programmatic configuration of the component</h2></div></div></div><pre class="programlisting">
KeyStoreParameters ksp = new KeyStoreParameters();
ksp.setResource("/users/home/server/keystore.jks");
ksp.setPassword("keystorePassword");

KeyManagersParameters kmp = new KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword("keyPassword");

SSLContextParameters scp = new SSLContextParameters();
scp.setKeyManagers(kmp);

JettyComponent jettyComponent = getContext().getComponent("jetty", JettyComponent.class);
jettyComponent.setSslContextParameters(scp);
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</h2></div></div></div><pre class="programlisting">
...
  &lt;camel:sslContextParameters
      id="sslContextParameters"&gt;
    &lt;camel:keyManagers
        keyPassword="keyPassword"&gt;
      &lt;camel:keyStore
          resource="/users/home/server/keystore.jks"
          password="keystorePassword"/&gt;
    &lt;/camel:keyManagers&gt;
  &lt;/camel:sslContextParameters&gt;...
...
  &lt;to uri="jetty:https://127.0.0.1/mail/?sslContextParametersRef=sslContextParameters"/&gt;
...
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ConfiguringJettyDirectly"></a>Configuring Jetty Directly</h2></div></div></div><p>Jetty provides SSL support out of the box. To enable Jetty to run in SSL mode, simply
            format the URI with the <code class="literal">https://</code> prefix---for example:</p><pre class="programlisting">
&lt;from uri="jetty:https://0.0.0.0/myapp/myservice/"/&gt;
</pre><p>Jetty also needs to know where to load your keystore from and what passwords to use in
            order to load the correct SSL certificate. Set the following JVM System
            Properties:</p><p><span class="bold"><strong>until Camel 2.2</strong></span>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">jetty.ssl.keystore</code> specifies the location of the Java
                    keystore file, which contains the Jetty server's own X.509 certificate in a
                        <span class="emphasis"><em>key entry</em></span>. A key entry stores the X.509 certificate
                    (effectively, the <span class="emphasis"><em>public key</em></span>) and also its associated
                    private key.</p></li><li class="listitem"><p><code class="literal">jetty.ssl.password</code> the store password, which is required to
                    access the keystore file (this is the same password that is supplied to the
                        <code class="literal">keystore</code> command's <code class="literal">\-storepass</code>
                    option).</p></li><li class="listitem"><p><code class="literal">jetty.ssl.keypassword</code> the key password, which is used to
                    access the certificate's key entry in the keystore (this is the same password
                    that is supplied to the <code class="literal">keystore</code> command's
                        <code class="literal">\-keypass</code> option).</p></li></ul></div><p><span class="bold"><strong>from Camel 2.3 onwards</strong></span>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">org.eclipse.jetty.ssl.keystore</code> specifies the location of
                    the Java keystore file, which contains the Jetty server's own X.509 certificate
                    in a <span class="emphasis"><em>key entry</em></span>. A key entry stores the X.509 certificate
                    (effectively, the <span class="emphasis"><em>public key</em></span>) and also its associated
                    private key.</p></li><li class="listitem"><p><code class="literal">org.eclipse.jetty.ssl.password</code> the store password, which is
                    required to access the keystore file (this is the same password that is supplied
                    to the <code class="literal">keystore</code> command's <code class="literal">\-storepass</code>
                    option).</p></li><li class="listitem"><p><code class="literal">org.eclipse.jetty.ssl.keypassword</code> the key password, which
                    is used to access the certificate's key entry in the keystore (this is the same
                    password that is supplied to the <code class="literal">keystore</code> command's
                        <code class="literal">\-keypass</code> option).</p></li></ul></div><p>For details of how to configure SSL on a Jetty endpoint, read the following
            documentation at the Jetty Site: <a class="link" href="http://docs.codehaus.org/display/JETTY/How+to+configure+SSL" target="_top">http://docs.codehaus.org/display/JETTY/How+to+configure+SSL</a>
        </p><p>Some SSL properties aren't exposed directly by Camel, however Camel does expose the
            underlying SslSocketConnector, which will allow you to set properties like
            needClientAuth for mutual authentication requiring a client certificate or
            wantClientAuth for mutual authentication where a client doesn't need a certificate but
            can have one. There's a slight difference between the various Camel versions:</p><p><span class="bold"><strong>Up to Camel 2.2</strong></span>
        </p><pre class="programlisting">
&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="sslSocketConnectors"&gt;
        &lt;map&gt;
            &lt;entry key="8043"&gt;
                &lt;bean class="org.mortbay.jetty.security.SslSocketConnector"&gt;
                    &lt;property name="password"value="..."/&gt;
                    &lt;property name="keyPassword"value="..."/&gt;
                    &lt;property name="keystore"value="..."/&gt;
                    &lt;property name="needClientAuth"value="..."/&gt;
                    &lt;property name="truststore"value="..."/&gt;
                &lt;/bean&gt;
            &lt;/entry&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</pre><p><span class="bold"><strong>Camel 2.3, 2.4</strong></span>
        </p><pre class="programlisting">
&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="sslSocketConnectors"&gt;
        &lt;map&gt;
            &lt;entry key="8043"&gt;
                &lt;bean class="org.eclipse.jetty.server.ssl.SslSocketConnector"&gt;
                    &lt;property name="password"value="..."/&gt;
                    &lt;property name="keyPassword"value="..."/&gt;
                    &lt;property name="keystore"value="..."/&gt;
                    &lt;property name="needClientAuth"value="..."/&gt;
                    &lt;property name="truststore"value="..."/&gt;
                &lt;/bean&gt;
            &lt;/entry&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</pre><p>\*From Camel 2.5 we switch to use SslSelectChannelConnector *</p><pre class="programlisting">
&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="sslSocketConnectors"&gt;
        &lt;map&gt;
            &lt;entry key="8043"&gt;
                &lt;bean class="org.eclipse.jetty.server.ssl.SslSelectChannelConnector"&gt;
                    &lt;property name="password"value="..."/&gt;
                    &lt;property name="keyPassword"value="..."/&gt;
                    &lt;property name="keystore"value="..."/&gt;
                    &lt;property name="needClientAuth"value="..."/&gt;
                    &lt;property name="truststore"value="..."/&gt;
                &lt;/bean&gt;
            &lt;/entry&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</pre><p>The value you use as keys in the above map is the port you configure Jetty to listen
            on.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ConfiguringgeneralSSLproperties"></a>Configuring general SSL properties</h2></div></div></div><p><span class="bold"><strong>Available as of Camel 2.5</strong></span>
        </p><p>Instead of a per port number specific SSL socket connector (as shown above) you can
            now configure general properties which applies for all SSL socket connectors (which is
            not explicit configured as above with the port number as entry).</p><pre class="programlisting">
&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="sslSocketConnectorProperties"&gt;
        &lt;map&gt;
            &lt;entry key="password"value="..."/&gt;
            &lt;entry key="keyPassword"value="..."/&gt;
            &lt;entry key="keystore"value="..."/&gt;
            &lt;entry key="needClientAuth"value="..."/&gt;
            &lt;entry key="truststore"value="..."/&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_HowtoobtainreferencetotheX509Certificate"></a>How to obtain reference to the X509Certificate</h2></div></div></div><p>Jetty stores a reference to the certificate in the HttpServletRequest which you can
            access from code as follows:</p><pre class="programlisting">HttpServletRequest req = exchange.getIn().getBody(HttpServletRequest.class);
X509Certificate cert = (X509Certificate) req.getAttribute("javax.servlet.request.X509Certificate")</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_ConfiguringgeneralHTTPproperties"></a>Configuring general HTTP properties</h2></div></div></div><p><span class="bold"><strong>Available as of Camel 2.5</strong></span>
        </p><p>Instead of a per port number specific HTTP socket connector (as shown above) you can
            now configure general properties which applies for all HTTP socket connectors (which is
            not explicit configured as above with the port number as entry).</p><pre class="programlisting">&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="socketConnectorProperties"&gt;
        &lt;map&gt;
            &lt;entry key="acceptors" value="4"/&gt;
            &lt;entry key="maxIdleTime" value="300000"/&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e109541"></a>Obtaining X-Forwarded-For header with HttpServletRequest.getRemoteAddr()</h2></div></div></div><p>If the HTTP requests are handled by an Apache server and forwarded to Jetty with
                <code class="code">mod_proxy</code>, the original client IP address is in the
                <code class="code">X-Forwarded-For</code> header and the
                <code class="code">HttpServletRequest.getRemoteAddr()</code> will return the address of the
            Apache proxy. </p><p>Jetty has a forwarded property which takes the value from <code class="code">X-Forwarded-For</code>
            and places it in the <code class="code">HttpServletRequest</code>
            <code class="code">remoteAddr</code> property. This property is not available directly through the
            endpoint configuration but it can be easily added using the
                <code class="code">socketConnectors</code> property:</p><pre class="programlisting">&lt;bean id="jetty" class="org.apache.camel.component.jetty.JettyHttpComponent"&gt;
    &lt;property name="socketConnectors"&gt;
        &lt;map&gt;
            &lt;entry key="8080"&gt;
                &lt;bean class="org.eclipse.jetty.server.nio.SelectChannelConnector"&gt;
                    &lt;property name="forwarded" value="true"/&gt;
                &lt;/bean&gt;
            &lt;/entry&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>This is particularly useful when an existing Apache server handles TLS connections for
            a domain and proxies them to application servers internally.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_DefaultbehaviorforreturningHTTPstatuscodes"></a>Default behaviour for returning HTTP status codes</h2></div></div></div><p>The default behavior of HTTP status codes is defined by the
                <code class="literal">org.apache.camel.component.http.DefaultHttpBinding</code> class, which
            handles how a response is written and also sets the HTTP status code.</p><p>If the exchange was processed successfully, the 200 HTTP status code is returned. If
            the exchange failed with an exception, the 500 HTTP status code is returned, and the
            stacktrace is returned in the body. If you want to specify which HTTP status code to
            return, set the code in the <code class="literal">Exchange.HTTP_RESPONSE_CODE</code> header of the
            OUT message.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_CustomizingHttpBinding"></a>Customizing HttpBinding</h2></div></div></div><p>By default, Camel uses the
                <code class="literal">org.apache.camel.component.http.DefaultHttpBinding</code> to handle how
            a response is written. If you like, you can customize this behavior either by
            implementing your own <code class="literal">HttpBinding</code> class or by extending
                <code class="literal">DefaultHttpBinding</code> and overriding the appropriate methods.</p><p>The following example shows how to customize the <code class="literal">DefaultHttpBinding</code>
            in order to change how exceptions are returned:</p><pre class="programlisting">public class MyHttpBinding extends DefaultHttpBinding {

    @Override
    public void doWriteExceptionResponse(Throwable exception, HttpServletResponse response) throws IOException {
        // we override the doWriteExceptionResponse as we only want to alter the binding how exceptions is
        // written back to the client. 

        // we just return HTTP 200 so the client thinks its okay
        response.setStatus(200);
        // and we return this fixed text
        response.getWriter().write("Something went wrong but we dont care");
    }
}</pre><p>We can then create an instance of our binding and register it in the Spring registry
            as follows:</p><pre class="programlisting">&lt;bean id="mybinding"class="com.mycompany.MyHttpBinding"/&gt;</pre><p>And then we can reference this binding when we define the route:</p><pre class="programlisting">&lt;route&gt;&lt;from uri="jetty:http://0.0.0.0:8080/myapp/myservice?httpBindingRef=mybinding"/&gt;&lt;to uri="bean:doSomething"/&gt;&lt;/route&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_Jettyhandlersandsecurityconfiguration"></a>Jetty handlers and security configuration</h2></div></div></div><p>You can configure a list of Jetty handlers on the endpoint, which can be useful for
            enabling advanced Jetty security features. These handlers are configured in Spring XML
            as follows:</p><pre class="programlisting">&lt;-- Jetty Security handling --&gt;
&lt;bean id="userRealm" class="org.mortbay.jetty.plus.jaas.JAASUserRealm"&gt;
    &lt;property name="name" value="tracker-users"/&gt;
    &lt;property name="loginModuleName" value="ldaploginmodule"/&gt;
&lt;/bean&gt;

&lt;bean id="constraint" class="org.mortbay.jetty.security.Constraint"&gt;
    &lt;property name="name" value="BASIC"/&gt;
    &lt;property name="roles" value="tracker-users"/&gt;
    &lt;property name="authenticate" value="true"/&gt;
&lt;/bean&gt;

&lt;bean id="constraintMapping" class="org.mortbay.jetty.security.ConstraintMapping"&gt;
    &lt;property name="constraint" ref="constraint"/&gt;
    &lt;property name="pathSpec" value="/*"/&gt;
&lt;/bean&gt;

&lt;bean id="securityHandler" class="org.mortbay.jetty.security.SecurityHandler"&gt;
    &lt;property name="userRealm" ref="userRealm"/&gt;
    &lt;property name="constraintMappings" ref="constraintMapping"/&gt;
&lt;/bean&gt;</pre><p><span class="bold"><strong>And from Camel 2.3 onwards</strong></span> you can configure a list
            of Jetty handlers as follows:</p><pre class="programlisting">&lt;-- Jetty Security handling --&gt;
&lt;bean id="constraint" class="org.eclipse.jetty.http.security.Constraint"&gt;
    &lt;property name="name" value="BASIC"/&gt;
    &lt;property name="roles" value="tracker-users"/&gt;
    &lt;property name="authenticate" value="true"/&gt;
&lt;/bean&gt;

&lt;bean id="constraintMapping" class="org.eclipse.jetty.security.ConstraintMapping"&gt;
    &lt;property name="constraint" ref="constraint"/&gt;
    &lt;property name="pathSpec" value="/*"/&gt;
&lt;/bean&gt;

&lt;bean id="securityHandler" class="org.eclipse.jetty.security.ConstraintSecurityHandler"&gt;
    &lt;property name="authenticator"&gt;
        &lt;bean class="org.eclipse.jetty.security.authentication.BasicAuthenticator"/&gt;
    &lt;/property&gt;
    &lt;property name="constraintMappings"&gt;
        &lt;list&gt;
            &lt;ref bean="constraintMapping"/&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>You can then define the endpoint as:</p><pre class="programlisting">from("jetty:http://0.0.0.0:9080/myservice?handlers=securityHandler")</pre><p>If you need more handlers, set the <code class="literal">handlers</code> option equal to a
            comma-separated list of bean IDs.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_HowtoreturnacustomHTTP500replymessage"></a>How to return a custom HTTP 500 reply message</h2></div></div></div><p>You may want to return a custom reply message when something goes wrong, instead of
            the default reply message Camel <a href="IDU-Jetty.html" class="olink">Jetty</a> replies with.
            You could use a custom <code class="literal">HttpBinding</code> to be in control of the message
            mapping, but often it may be easier to use Camel's <a class="link" href="http://camel.apache.org/exception-clause.html" target="_top">Exception Clause</a> to construct the custom reply message. For example as show
            here, where we return <code class="literal">Dude something went wrong</code> with HTTP error code
            500:</p><pre class="programlisting">from("jetty://http://localhost:{{port}}/myserver")
    // use onException to catch all exceptions and return a custom reply message
    .onException(Exception.class)
        .handled(true)
        // create a custom failure response
        .transform(constant("Dude something went wrong"))
        // we must remember to set error code 500 as handled(true)
        // otherwise would let Camel thing its a OK response (200)
        .setHeader(Exchange.HTTP_RESPONSE_CODE, constant(500))
    .end()
    // now just force an exception immediately
    .throwException(new IllegalArgumentException("I cannot do this"));</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_MultipartFormsupport"></a>Multi-part Form support</h2></div></div></div><p>From Camel 2.3.0, camel-jetty support to multipart form post out of box. The submitted
            form-data are mapped into the message header. Camel-jetty creates an attachment for each
            uploaded file. The file name is mapped to the name of the attachment. The content type
            is set as the content type of the attachment file name. You can find the example
            here.</p><pre class="programlisting">// Set the jetty temp directory which store the file for multi part form
// camel-jetty will clean up the file after it handled the request.
// The option works rightly from Camel 2.4.0
getContext().getProperties().put("CamelJettyTempDir", "target");

from("jetty://http://localhost:{{port}}/test").process(new Processor() {

    public void process(Exchange exchange) throws Exception {
        Message in = exchange.getIn();
        assertEquals("Get a wrong attachement size", 1, in.getAttachments().size());
        // The file name is attachment id
        DataHandler data = in.getAttachment("NOTICE.txt");

        assertNotNull("Should get the DataHandle NOTICE.txt", data);
        // This assert is wrong, but the correct content-type (application/octet-stream)
        // will not be returned until Jetty makes it available - currently the content-type
        // returned is just the default for FileDataHandler (for the implentation being used)
        //assertEquals("Get a wrong content type", "text/plain", data.getContentType());
        assertEquals("Got the wrong name", "NOTICE.txt", data.getName());

        assertTrue("We should get the data from the DataHandle", data.getDataSource()
            .getInputStream().available() &gt; 0);

        // The other form date can be get from the message header
        exchange.getOut().setBody(in.getHeader("comment"));
    }

});</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="IDU-Jetty_HSH_JettyJMXsupport"></a>Jetty JMX support</h2></div></div></div><p>From Camel 2.3.0, camel-jetty supports the enabling of Jetty's JMX capabilities at the
            component and endpoint level with the endpoint configuration taking priority. Note that
            JMX must be enabled within the Camel context in order to enable JMX support in this
            component as the component provides Jetty with a reference to the MBeanServer registered
            with the Camel context. Because the camel-jetty component caches and reuses Jetty
            resources for a given protocol/host/port pairing, this configuration option will only be
            evaluated during the creation of the first endpoint to use a protocol/host/port pairing.
            For example, given two routes created from the following XML fragments, JMX support
            would remain enabled for all endpoints listening on "https://0.0.0.0".</p><pre class="programlisting">&lt;from uri="jetty:https://0.0.0.0/myapp/myservice1/?enableJmx=true"/&gt;</pre><pre class="programlisting">&lt;from uri="jetty:https://0.0.0.0/myapp/myservice2/?enableJmx=false"/&gt;</pre><p>The camel-jetty component also provides for direct configuration of the Jetty
            MBeanContainer. Jetty creates MBean names dynamically. If you are running another
            instance of Jetty outside of the Camel context and sharing the same MBeanServer between
            the instances, you can provide both instances with a reference to the same
            MBeanContainer in order to avoid name collisions when registering Jetty MBeans.</p><p>
            
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                    <a href="IDU-HTTP.html" class="olink">HTTP</a>
                </p></li></ul></div></div></div></body></html>
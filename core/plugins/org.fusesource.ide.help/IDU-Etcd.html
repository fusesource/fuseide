<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Etcd</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Apache Camel Component Reference"><link rel="prev" href="IDU-EJB.html" title="EJB"><link rel="next" href="IDU-ElasticSearch.html" title="ElasticSearch"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="IDU-Etcd"></a>Etcd</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e72901"></a>Etcd Component</h2></div></div></div><p><a class="link" href="https://coreos.com/etcd/" target="_top">Etcd</a> is a distributed key value store that provides a reliable way to store data across a cluster of machines. </p><p>Maven users will need to add the following dependency to their <code class="code">pom.xml</code> for this component.</p><pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-etcd&lt;/artifactId&gt;
    &lt;!-- use the same version as your Camel core version --&gt;
    &lt;version&gt;x.y.z&lt;/version&gt;
&lt;/dependency&gt;
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e72915"></a>URI format</h2></div></div></div><pre class="programlisting">etcd:namespace[/path][?options]</pre><p>Where <span class="bold"><strong>namespace</strong></span> represents the etcd context to which the etcd-component should operate and path is an optional attribute to define which node is being impacted. </p><p>Supported namespaces are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="code">keys</code></p></li><li class="listitem"><p><code class="code">watch</code></p></li><li class="listitem"><p><code class="code">stats</code></p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e72940"></a>Options</h2></div></div></div><table id="d0e72943"><tbody><tr><th><p>Name</p></th><th><p>Default Value</p></th><th><p>Description</p></th></tr><tr><td><p><code class="code">uris</code></p></td><td><p><a class="link" href="http://localhost:2379,http:" target="_top">http://localhost:2379,http://localhost:4001</a></p></td><td><p>Defines the URIs the component should connect to.</p></td></tr><tr><td><code class="code">sslContextParameters</code></td><td><code class="code">null</code></td><td>To use a custom <code class="code">org.apache.camel.util.jsse.SSLContextParameters</code>. See <a class="link" href="https://cwiki.apache.org/confluence/display/CAMEL/http4#HTTP4-UsingtheJSSEConfigurationUtility" target="_top">Using the JSSE Configuration Utility</a></td></tr><tr><td><code class="code">userName</code></td><td><code class="code">null</code></td><td>The user name to use for basic authentication</td></tr><tr><td><code class="code">password</code></td><td><code class="code">null</code></td><td>The password to use for basic authentication</td></tr><tr><td><code class="code">sendEmptyExchangeOnTimeout</code></td><td><code class="code">false</code></td><td>To send an empty message in case of timeout watching for a key (consumer only)</td></tr><tr><td><code class="code">recursive</code></td><td><code class="code">false</code></td><td>To apply an action recursively</td></tr><tr><td><code class="code">timeToLive</code></td><td><code class="code">null</code></td><td>To set the lifespan of a key in milliseconds</td></tr><tr><td><code class="code">timeout</code></td><td><code class="code">null</code></td><td>To set the maximum time an action could take to complete.</td></tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e73035"></a>Headers</h2></div></div></div><table id="d0e73038"><tbody><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td><code class="code">CamelEtcdAction</code></td><td><code class="code">java.lang.String</code></td><td>The action to perform, supported values are set, delete, deleteDir, get</td></tr><tr><td><code class="code">CamelEtcdNamespace</code></td><td><code class="code">java.lang.String</code></td><td><p>The etcd context an exchange was generated/processed from</p></td></tr><tr><td><code class="code">CamelEtcdPath</code></td><td><code class="code">java.lang.String</code></td><td><p>For keys namespace, it is used to determine the node subject the the action, if not set the path from URI endpoint is used. For stats and watch namespaces it contains the path of the node beign processed</p></td></tr><tr><td><code class="code">CamelEtcdTimeout</code></td><td><code class="code">java.lang.Long</code></td><td>To set the maximum time an action could take to complete. If not present, the <code class="code">timeout</code> option is taken into account</td></tr><tr><td><code class="code">CamelEtcdTtl</code></td><td><code class="code">java.lang.Integer</code></td><td>To set the lifespan of a key in milliseconds.  If not present, the <code class="code">timeToLive</code> option is taken into account</td></tr><tr><td><code class="code">CamelEtcdRecursive</code></td>
    <td><code class="code">java.lang.Boolean</code></td>
    <td>To apply an action recursively. If not present, the <code class="code">recursive</code> option is taken into account.</td></tr></tbody></table></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e73114"></a>Keys namespace example:</h2></div></div></div><p> </p><pre class="programlisting">CamelContext context = new DefaultCamelContext();
context.addRoutes(new RouteBuilder() {
    public void configure() {
       from("direct:keys-set")
            .to("etcd:keys")
                .to("log:camel-etcd?level=INFO");
    }
});

Map&lt;String, Object&gt; headers = new HashMap&lt;&gt;();
headers.put(EtcdConstants.ETCD_ACTION, EtcdConstants.ETCD_KEYS_ACTION_SET);
headers.put(EtcdConstants.ETCD_PATH, "/camel/etcd/myKey");
 
ProducerTemplate template = context.createProducerTemplate();
template.sendBodyAndHeaders("direct:keys-set", "camel-etcd", headers); </pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e73121"></a>Stats namespace example:</h2></div></div></div><pre class="programlisting">CamelContext context = new DefaultCamelContext();
context.addRoutes(new RouteBuilder() {
    public void configure() {
       from("etcd:stats/leader?consumer.delay=50&amp;consumer.initialDelay=0")
           .to("log:etcd-leader-stats?level=INFO");
       from("etcd:stats/self?consumer.delay=50&amp;consumer.initialDelay=0")
           .to("log:etcd-self-stats?level=INFO");
       from("etcd:stats/store?consumer.delay=50&amp;consumer.initialDelay=0")
           .to("log:etcd-store-stats?level=INFO");
    }
}); </pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e73126"></a>Watch namespace example:</h2></div></div></div><pre class="programlisting">CamelContext context = new DefaultCamelContext();
context.addRoutes(new RouteBuilder() {
    public void configure() {
       from("etcd:watch/recursive?recursive=true")
        .marshall().json()
        .to("log:etcd-event?level=INFO")
    }
});</pre></div></div></body></html>
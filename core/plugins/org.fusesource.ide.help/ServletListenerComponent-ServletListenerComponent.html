<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>ServletListener Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="SERVLET-ServletComponent.html" title="Servlet Component"><link rel="next" href="SFTPComponent.html" title="SFTP Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="ServletListenerComponent-ServletListenerComponent"></a>ServletListener Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Using">Using</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Options">Options</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Examples">Examples</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-AccessingthecreatedCamelContext">Accessing the created CamelContext</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Configuringroutes">Configuring routes</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-JNDIorSimpleasCamel">JNDI or Simple as Camel Registry</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-SeeAlso">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.11</strong></span></p><p>This component is used for bootstrapping Camel applications in web
applications. For example beforehand people would have to find their own
way of bootstrapping Camel, or rely on 3rd party frameworks such as
Spring to do it.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Sidebar</strong></span>
This component supports Servlet 2.x onwards, which mean it works also in
older web containers; which is the goal of this component.
Though Servlet 2.x requires to use a web.xml file as configuration.
For Servlet 3.x containers you can use annotation driven configuration
to boostrap Camel using the @WebListener, and implement your own class,
where you boostrap Camel. Doing this still puts the challenge how to let
end users easily configure Camel, which you get for free with the old
school web.xml file.</p></td></tr></table></div><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-servletlistener<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-Using"></a>Using</h2></div></div></div><p>You would need to chose one of the following implementations of the
abstract class
<code class="literal">org.apache.camel.component.servletlistener.CamelServletContextListener</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">JndiCamelServletContextListener</code> which uses the <code class="literal">JndiRegistry</code> to
leverage JNDI for its registry.</li><li class="listitem"><code class="literal">SimpleCamelServletContextListener</code> which uses the <code class="literal">SimpleRegistry</code> to
leverage a <code class="literal">java.util.Map</code> as its registry.</li></ul></div><p>To use this you need to configure the
<code class="literal">org.apache.camel.component.servletlistener.CamelServletContextListener</code>
in the <code class="literal">WEB-INF/web.xml</code> file as shown below:</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-Options"></a>Options</h2></div></div></div><p>The
<code class="literal">org.apache.camel.component.servletlistener.CamelServletContextListener</code>
supports the following options which can be configured as context-param
in the web.xml file.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="20%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Option</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>propertyPlaceholder.XXX</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>To configure <a class="link" href="using-propertyplaceholder.html" target="_top">property placeholders</a>
in Camel. You should prefix the option with "propertyPlaceholder.", for
example to configure the location, use propertyPlaceholder.location as
name. You can configure all the options from the
<a class="link" href="properties.html" target="_top">Properties</a> component.</p></td></tr><tr><td align="left" valign="top"><p>jmx.XXX</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>To configure <a class="link" href="camel-jmx.html" target="_top">JMX</a>. You should prefix the option with
"jmx.", for example to disable JMX, use jmx.disabled as name. You can
configure all the options from <code class="literal">org.apache.camel.spi.ManagementAgent</code>.
As well the options mentioned on the <a class="link" href="camel-jmx.html" target="_top">JMX</a> page.</p></td></tr><tr><td align="left" valign="top"><p>name</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>To configure the name of the <a class="link" href="camelcontext.html" target="_top">CamelContext</a>.</p></td></tr><tr><td align="left" valign="top"><p>messageHistory</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Camel 2.12.2:</strong></span> Whether to enable or disable
<a class="link" href="message-history.html" target="_top">Message History</a> (enabled by default).</p></td></tr><tr><td align="left" valign="top"><p>streamCache</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to enable <a class="link" href="stream-caching.html" target="_top">Stream caching</a>.</p></td></tr><tr><td align="left" valign="top"><p>trace</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to enable <a class="link" href="tracer.html" target="_top">Tracer</a>.</p></td></tr><tr><td align="left" valign="top"><p>delayer</p></td><td align="left" valign="top"><p><code class="literal">Long</code></p></td><td align="left" valign="top"><p>To set a delay value for <a class="link" href="delay-interceptor.html" target="_top">Delay Interceptor</a>.</p></td></tr><tr><td align="left" valign="top"><p>handleFault</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to enable handle fault.</p></td></tr><tr><td align="left" valign="top"><p>errorHandlerRef</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Refers to a context scoped <a class="link" href="error-handler.html" target="_top">Error Handler</a> to be
used.</p></td></tr><tr><td align="left" valign="top"><p>autoStartup</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to start all routes when starting Camel.</p></td></tr><tr><td align="left" valign="top"><p>useMDCLogging</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to use <a class="link" href="mdc-logging.html" target="_top">MDC logging</a>.</p></td></tr><tr><td align="left" valign="top"><p>useBreadcrumb</p></td><td align="left" valign="top"><p><code class="literal">Boolean</code></p></td><td align="left" valign="top"><p>Whether to use <a class="link" href="mdc-logging.html" target="_top">breadcrumb</a>.</p></td></tr><tr><td align="left" valign="top"><p>managementNamePattern</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>To set a custom naming pattern for JMX MBeans.</p></td></tr><tr><td align="left" valign="top"><p>threadNamePattern</p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>To set a custom naming pattern for threads.</p></td></tr><tr><td align="left" valign="top"><p>properties.XXX</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>To set custom properties on <code class="literal">CamelContext.getProperties</code>. This is seldom
in use.</p></td></tr><tr><td align="left" valign="top"><p>routebuilder.XXX</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>To configure routes to be used. See below for more details.</p></td></tr><tr><td align="left" valign="top"><p>CamelContextLifecycle</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>Refers to a FQN classname of an implementation of
<code class="literal">org.apache.camel.component.servletlistener.CamelContextLifecycle</code>.
Which allows to execute custom code before and after
<a class="link" href="camelcontext.html" target="_top">CamelContext</a> has been started or stopped. See
below for further details.</p></td></tr><tr><td align="left" valign="top"><p>XXX</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p>To set any option on <a class="link" href="camelcontext.html" target="_top">CamelContext</a>.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-Examples"></a>Examples</h2></div></div></div><p>See <a class="link" href="servlet-tomcat-no-spring-example.html" target="_top">Servlet Tomcat No Spring
Example</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-AccessingthecreatedCamelContext"></a>Accessing the created CamelContext</h2></div></div></div><p><span class="strong"><strong>Available as of Camel 2.14/2.13.3/2.12.5</strong></span></p><p>The created&nbsp;<code class="literal">CamelContext</code> is stored on the&nbsp;<code class="literal">ServletContext</code> as an
attribute with the key "CamelContext". You can get hold of the
CamelContext if you can get hold of the&nbsp;<code class="literal">ServletContext</code> as shown below:</p><pre class="programlisting">ServletContext sc = ...
CamelContext camel = (CamelContext) sc.getAttribute(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"CamelContext"</em></strong>);</pre><p>&nbsp;</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-Configuringroutes"></a>Configuring routes</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-UsingaRouteBuilderclass">Using a RouteBuilder class</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Usingpackagescanning">Using package scanning</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-UsingaXMLfile">Using a XML file</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-Configuringpropertplaceholders">Configuring propert placeholders</a></span></dt><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-ConfiguringJMX">Configuring JMX</a></span></dt></dl></div><p>You need to configure which routes to use in the web.xml file. You can
do this in a number of ways, though all the parameters must be prefixed
with "routeBuilder".</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-UsingaRouteBuilderclass"></a>Using a RouteBuilder class</h3></div></div></div><p>By default Camel will assume the param-value is a FQN classname for a
Camel <a class="link" href="routebuilder.html" target="_top">RouteBuilder</a> class, as shown below:</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>routeBuilder-MyRoute<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>org.apache.camel.component.servletlistener.MyRoute<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre><p>You can specify multiple classes in the same param-value as shown below:</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>routeBuilder-routes<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- we can define multiple values separated by comma --&gt;</em>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>
      org.apache.camel.component.servletlistener.MyRoute,
      org.apache.camel.component.servletlistener.routes.BarRouteBuilder
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre><p>The name of the parameter does not have a meaning at runtime. It just
need to be unique and start with "routeBuilder". In the example above we
have "routeBuilder-routes". But you could just as well have named it
"routeBuilder.foo".</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-Usingpackagescanning"></a>Using package scanning</h3></div></div></div><p>You can also tell Camel to use package scanning, which mean it will look
in the given package for all classes of
<a class="link" href="routebuilder.html" target="_top">RouteBuilder</a> types and automatic adding them as
Camel routes. To do that you need to prefix the value with
"packagescan:" as shown below:</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>routeBuilder-MyRoute<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- define the routes using package scanning by prefixing with packagescan: --&gt;</em>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>packagescan:org.apache.camel.component.servletlistener.routes<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-UsingaXMLfile"></a>Using a XML file</h3></div></div></div><p>You can also define Camel routes using XML DSL, though as we are not
using Spring or Blueprint the XML file can only contain Camel route(s).</p><p>In the web.xml you refer to the XML file which can be from "classpath",
"file" or a "http" url, as shown below:</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>routeBuilder-MyRoute<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>classpath:routes/myRoutes.xml<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre><p>And the XML file is:</p><p><span class="strong"><strong>routes/myRoutes.xml</strong></span></p><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- the xmlns="http://camel.apache.org/schema/spring" is needed --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;routes</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"foo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:foo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:foo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"bar"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:bar"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:bar"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/routes&gt;</strong></pre><p>Notice that in the XML file the root tag is &lt;routes&gt; which must use the
namespace "http://camel.apache.org/schema/spring". This namespace is
having the spring in the name, but that is because of historical
reasons, as Spring was the first and only XML DSL back in the time. At
runtime no Spring JARs is needed. Maybe in Camel 3.0 the namespace can
be renamed to a generic name.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-Configuringpropertplaceholders"></a>Configuring propert placeholders</h3></div></div></div><p>Here is a snippet of a web.xml configuration for setting up property
placeholders to load <code class="literal">myproperties.properties</code> from the classpath</p><pre class="programlisting">  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- setup property placeholder to load properties from classpath --&gt;</em>
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- we do this by setting the param-name with propertyPlaceholder. as prefix and then any options such as location, cache etc --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>propertyPlaceholder.location<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>classpath:myproperties.properties<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong>
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- for example to disable cache on properties component, you do --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>propertyPlaceholder.cache<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>false<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-ConfiguringJMX"></a>Configuring JMX</h3></div></div></div><p>Here is a snippet of a web.xml configuration for configuring JMX, such
as disabling JMX.</p><pre class="programlisting">  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- configure JMX by using names that is prefixed with jmx. --&gt;</em>
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- in this example we disable JMX --&gt;</em>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>jmx.disabled<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>true<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-JNDIorSimpleasCamel"></a>JNDI or Simple as Camel <a class="link" href="registry.html" target="_top">Registry</a></h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ServletListenerComponent-ServletListenerComponent.html#ServletListenerComponent-UsingcustomCamelContextLifecycle">Using custom CamelContextLifecycle</a></span></dt></dl></div><p>This component uses either JNDI or Simple as the
<a class="link" href="registry.html" target="_top">Registry</a>.
 This allows you to lookup <a class="link" href="bean.html" target="_top">Bean</a>s and other services in
JNDI, and as well to bind and unbind your own <a class="link" href="bean.html" target="_top">Bean</a>s.</p><p>This is done from Java code by implementing the
<code class="literal">org.apache.camel.component.servletlistener.CamelContextLifecycle</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ServletListenerComponent-UsingcustomCamelContextLifecycle"></a>Using custom CamelContextLifecycle</h3></div></div></div><p>In the code below we use the callbacks <code class="literal">beforeStart</code> and <code class="literal">afterStop</code> to
enlist our custom bean in the Simple <a class="link" href="registry.html" target="_top">Registry</a>, and
as well to cleanup when we stop.</p><p>Then we need to register this class in the web.xml file as shown below,
using the parameter name "CamelContextLifecycle". The value must be a
FQN which refers to the class implementing the
<code class="literal">org.apache.camel.component.servletlistener.CamelContextLifecycle</code>
interface.</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;context-param&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-name&gt;</strong>CamelContextLifecycle<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-name&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;param-value&gt;</strong>org.apache.camel.component.servletlistener.MyLifecycle<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/param-value&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/context-param&gt;</strong></pre><p>As we enlisted our HelloBean <a class="link" href="bean.html" target="_top">Bean</a> using the name
"myBean" we can refer to this <a class="link" href="bean.html" target="_top">Bean</a> in the Camel routes
as shown below:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> MyBeanRoute <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">extends</strong> RouteBuilder {
    <em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
        from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"seda:foo"</em></strong>).routeId(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"foo"</em></strong>)
            .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"bean:myBean"</em></strong>)
            .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:foo"</em></strong>);
    }
}</pre><p><span class="strong"><strong>Important:</strong></span> If you use
<code class="literal">org.apache.camel.component.servletlistener.JndiCamelServletContextListener</code>
then the <code class="literal">CamelContextLifecycle</code> must use the <code class="literal">JndiRegistry</code> as well.
And likewise if the servlet is
<code class="literal">org.apache.camel.component.servletlistener.SimpleCamelServletContextListener</code>
then the <code class="literal">CamelContextLifecycle</code> must use the <code class="literal">SimpleRegistry</code></p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ServletListenerComponent-SeeAlso"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="servlet.html" target="_top">SERVLET</a></li><li class="listitem"><a class="link" href="servlet-tomcat-example.html" target="_top">Servlet Tomcat Example</a></li><li class="listitem"><a class="link" href="servlet-tomcat-no-spring-example.html" target="_top">Servlet Tomcat No Spring
Example</a></li></ul></div></div></div></body></html>
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>HTTP4 Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="HTTP-HTTPComponent.html" title="HTTP Component"><link rel="next" href="iBATIS-iBATIS.html" title="iBATIS Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="HTTP4-HTTP4Component"></a>HTTP4 Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-URIformat">URI format</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-HttpOptions">Http4 Component Options</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-MessageHeaders">Message Headers</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-MessageBody">Message Body</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-UsingSystemProperties">Using System Properties</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-Responsecode">Response code</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-HttpOperationFailedException">HttpOperationFailedException</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-CallingusingGETorPOST">Calling using GET or POST</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-HowtogetaccesstoHttpServletRequestandHttpServletResponse">How to get access to HttpServletRequest and HttpServletResponse</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-ConfiguringURItocall">Configuring URI to call</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-ConfiguringURIParameters">Configuring URI Parameters</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-HowtosetthehttpmethodtotheHTTPproducer">How to set the http method (GET/PATCH/POST/PUT/DELETE/HEAD/OPTIONS/TRACE) to the HTTP producer</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-Usingclienttimeout-SO_TIMEOUT">Using client timeout - SO_TIMEOUT</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-ConfiguringaProxy">Configuring a Proxy</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-Configuringcharset">Configuring charset</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-DisablingCookies">Disabling Cookies</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-AdvancedUsage">Advanced Usage</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.3</strong></span></p><p>The <span class="strong"><strong>http4:</strong></span> component provides HTTP based <a class="link" href="endpoint.html" target="_top">endpoints</a>
for calling external HTTP resources (as a client to call external
servers using HTTP).</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-http4<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p><span class="strong"><strong>camel-http4 vs camel-http</strong></span></p><p>Camel-http4 uses <a class="link" href="http://hc.apache.org/httpcomponents-client-ga/" target="_top">Apache
HttpClient 4.x</a> while camel-http uses
<a class="link" href="http://hc.apache.org/httpclient-3.x/" target="_top">Apache HttpClient 3.x</a>.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">http4:hostname[:port][/resourceUri][?options]</pre><p>Will by default use port 80 for HTTP and 443 for HTTPS.</p><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p><p><span class="strong"><strong>camel-http4 vs camel-jetty</strong></span></p><p>You can only produce to endpoints generated by the HTTP4 component.
Therefore it should never be used as input into your Camel Routes. To
bind/expose an HTTP endpoint via a HTTP server as input to a Camel
route, use the <a class="link" href="jetty.html" target="_top">Jetty Component</a> instead.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-HttpOptions"></a>Http4 Component Options</h2></div></div></div><p>The HTTP4 component supports 13 options which are listed below.</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="11%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>httpClientConfigurer</p></td><td align="left" valign="top"><p><code class="literal">HttpClientConfigurer</code></p></td><td align="left" valign="top"><p>To use the custom HttpClientConfigurer to perform configuration of the HttpClient that will be used.</p></td></tr><tr><td align="left" valign="top"><p>clientConnectionManager</p></td><td align="left" valign="top"><p><code class="literal">HttpClientConnectionManager</code></p></td><td align="left" valign="top"><p>To use a custom HttpClientConnectionManager to manage connections</p></td></tr><tr><td align="left" valign="top"><p>httpBinding</p></td><td align="left" valign="top"><p><code class="literal">HttpBinding</code></p></td><td align="left" valign="top"><p>To use a custom HttpBinding to control the mapping between Camel message and HttpClient.</p></td></tr><tr><td align="left" valign="top"><p>httpConfiguration</p></td><td align="left" valign="top"><p><code class="literal">HttpConfiguration</code></p></td><td align="left" valign="top"><p>To use the shared HttpConfiguration as base configuration.</p></td></tr><tr><td align="left" valign="top"><p>allowJavaSerializedObject</p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to allow java serialization when a request uses context-type=application/x-java-serialized-object This is by default turned off. If you enable this then be aware that Java will deserialize the incoming data from the request to Java and that can be a potential security risk.</p></td></tr><tr><td align="left" valign="top"><p>httpContext</p></td><td align="left" valign="top"><p><code class="literal">HttpContext</code></p></td><td align="left" valign="top"><p>To use a custom org.apache.http.protocol.HttpContext when executing requests.</p></td></tr><tr><td align="left" valign="top"><p>sslContextParameters</p></td><td align="left" valign="top"><p><code class="literal">SSLContextParameters</code></p></td><td align="left" valign="top"><p>To configure security using SSLContextParameters. Important: Only one instance of org.apache.camel.util.jsse.SSLContextParameters is supported per HttpComponent. If you need to use 2 or more different instances you need to define a new HttpComponent per instance you need.</p></td></tr><tr><td align="left" valign="top"><p>x509HostnameVerifier</p></td><td align="left" valign="top"><p><code class="literal">X509HostnameVerifier</code></p></td><td align="left" valign="top"><p>To use a custom X509HostnameVerifier such as org.apache.http.conn.ssl.StrictHostnameVerifier or org.apache.http.conn.ssl.AllowAllHostnameVerifier.</p></td></tr><tr><td align="left" valign="top"><p>maxTotalConnections</p></td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>The maximum number of connections.</p></td></tr><tr><td align="left" valign="top"><p>connectionsPerRoute</p></td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>The maximum number of connections per route.</p></td></tr><tr><td align="left" valign="top"><p>connectionTimeToLive</p></td><td align="left" valign="top"><p><code class="literal">long</code></p></td><td align="left" valign="top"><p>The time for connection to live the time unit is millisecond the default value is always keep alive.</p></td></tr><tr><td align="left" valign="top"><p>cookieStore</p></td><td align="left" valign="top"><p><code class="literal">CookieStore</code></p></td><td align="left" valign="top"><p>To use a custom org.apache.http.client.CookieStore. By default the org.apache.http.impl.client.BasicCookieStore is used which is an in-memory only cookie store. Notice if bridgeEndpoint=true then the cookie store is forced to be a noop cookie store as cookie shouldn&#8217;t be stored as we are just bridging (eg acting as a proxy).</p></td></tr><tr><td align="left" valign="top"><p>headerFilterStrategy</p></td><td align="left" valign="top"><p><code class="literal">HeaderFilterStrategy</code></p></td><td align="left" valign="top"><p>To use a custom HeaderFilterStrategy to filter header to and from Camel message.</p></td></tr></tbody></table></div><p>{% endraw %}</p><p>The HTTP4 component supports 31 endpoint options which are listed below:</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="10%" class="col_2"><col width="11%" class="col_3"><col width="10%" class="col_4"><col width="50%" class="col_5"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Group</th><th align="left" valign="top">Default</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>httpUri</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">URI</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The url of the HTTP endpoint to call.</p></td></tr><tr><td align="left" valign="top"><p>disableStreamCache</p></td><td align="left" valign="top"><p>common</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Determines whether or not the raw input stream from Servlet is cached or not (Camel will read the stream into a in memory/overflow to file Stream caching) cache. By default Camel will cache the Servlet input stream to support reading it multiple times to ensure it Camel can retrieve all data from the stream. However you can set this option to true when you for example need to access the raw stream such as streaming it directly to a file or other persistent store. DefaultHttpBinding will copy the request input stream into a stream cache and put it into message body if this option is false to support reading the stream multiple times. If you use Servlet to bridge/proxy an endpoint then consider enabling this option to improve performance in case you do not need to read the message payload multiple times. The http/http4 producer will by default cache the response body stream. If setting this option to true then the producers will not cache the response body stream but use the response stream as-is as the message body.</p></td></tr><tr><td align="left" valign="top"><p>authenticationPreemptive</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true camel-http4 sends preemptive basic authentication to the server.</p></td></tr><tr><td align="left" valign="top"><p>authMethodPriority</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Authentication method for proxy either as Basic Digest or NTLM.</p></td></tr><tr><td align="left" valign="top"><p>bridgeEndpoint</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If the option is true HttpProducer will ignore the Exchange.HTTP_URI header and use the endpoint&#8217;s URI for request. You may also set the option throwExceptionOnFailure to be false to let the HttpProducer send all the fault response back.</p></td></tr><tr><td align="left" valign="top"><p>chunked</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is false the Servlet will disable the HTTP streaming and set the content-length header on the response</p></td></tr><tr><td align="left" valign="top"><p>clearExpiredCookies</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to clear expired cookies before sending the HTTP request. This ensures the cookies store does not keep growing by adding new cookies which is newer removed when they are expired.</p></td></tr><tr><td align="left" valign="top"><p>connectionClose</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Specifies whether a Connection Close header must be added to HTTP Request. By default connectionClose is false.</p></td></tr><tr><td align="left" valign="top"><p>cookieStore</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">CookieStore</code></p></td><td align="left" valign="top"><p>To use a custom org.apache.http.client.CookieStore. By default the org.apache.http.impl.client.BasicCookieStore is used which is an in-memory only cookie store. Notice if bridgeEndpoint=true then the cookie store is forced to be a noop cookie store as cookie shouldn&#8217;t be stored as we are just bridging (eg acting as a proxy).</p></td></tr><tr><td align="left" valign="top"><p>copyHeaders</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true then IN exchange headers will be copied to OUT exchange headers according to copy strategy. Setting this to false allows to only include the headers from the HTTP response (not propagating IN headers).</p></td></tr><tr><td align="left" valign="top"><p>headerFilterStrategy</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HeaderFilterStrategy</code></p></td><td align="left" valign="top"><p>To use a custom HeaderFilterStrategy to filter header to and from Camel message.</p></td></tr><tr><td align="left" valign="top"><p>httpBinding</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpBinding</code></p></td><td align="left" valign="top"><p>To use a custom HttpBinding to control the mapping between Camel message and HttpClient.</p></td></tr><tr><td align="left" valign="top"><p>ignoreResponseBody</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true The http producer won&#8217;t read response body and cache the input stream</p></td></tr><tr><td align="left" valign="top"><p>okStatusCodeRange</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">200-299</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The status codes which is considered a success response. The values are inclusive. The range must be defined as from-to with the dash included.</p></td></tr><tr><td align="left" valign="top"><p>preserveHostHeader</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If the option is true HttpProducer will set the Host header to the value contained in the current exchange Host header useful in reverse proxy applications where you want the Host header received by the downstream server to reflect the URL called by the upstream client this allows applications which use the Host header to generate accurate URL&#8217;s for a proxied service</p></td></tr><tr><td align="left" valign="top"><p>proxyHost</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The proxy host name</p></td></tr><tr><td align="left" valign="top"><p>proxyPort</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>The proxy port number</p></td></tr><tr><td align="left" valign="top"><p>throwExceptionOnFailure</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Option to disable throwing the HttpOperationFailedException in case of failed responses from the remote server. This allows you to get all responses regardless of the HTTP status code.</p></td></tr><tr><td align="left" valign="top"><p>transferException</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If enabled and an Exchange failed processing on the consumer side and if the caused Exception was send back serialized in the response as a application/x-java-serialized-object content type. On the producer side the exception will be deserialized and thrown as is instead of the HttpOperationFailedException. The caused exception is required to be serialized. This is by default turned off. If you enable this then be aware that Java will deserialize the incoming data from the request to Java and that can be a potential security risk.</p></td></tr><tr><td align="left" valign="top"><p>urlRewrite</p></td><td align="left" valign="top"><p>producer (advanced)</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">UrlRewrite</code></p></td><td align="left" valign="top"><p>Refers to a custom org.apache.camel.component.http.UrlRewrite which allows you to rewrite urls when you bridge/proxy endpoints. See more details at <a class="link" href="http://camel.apache.org/urlrewrite.html" target="_top">http://camel.apache.org/urlrewrite.html</a></p></td></tr><tr><td align="left" valign="top"><p>clientBuilder</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpClientBuilder</code></p></td><td align="left" valign="top"><p>Provide access to the http client request parameters used on new RequestConfig instances used by producers or consumers of this endpoint.</p></td></tr><tr><td align="left" valign="top"><p>clientConnectionManager</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpClientConnectionManager</code></p></td><td align="left" valign="top"><p>To use a custom HttpClientConnectionManager to manage connections</p></td></tr><tr><td align="left" valign="top"><p>httpClient</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpClient</code></p></td><td align="left" valign="top"><p>Gets the HttpClient to be used by org.apache.camel.component.http4.HttpProducer</p></td></tr><tr><td align="left" valign="top"><p>httpClientConfigurer</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpClientConfigurer</code></p></td><td align="left" valign="top"><p>Register a custom configuration strategy for new HttpClient instances created by producers or consumers such as to configure authentication mechanisms etc</p></td></tr><tr><td align="left" valign="top"><p>httpClientOptions</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">Map</code></p></td><td align="left" valign="top"><p>To configure the HttpClient using the key/values from the Map.</p></td></tr><tr><td align="left" valign="top"><p>httpContext</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">HttpContext</code></p></td><td align="left" valign="top"><p>To use a custom HttpContext instance</p></td></tr><tr><td align="left" valign="top"><p>mapHttpMessageBody</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true then IN exchange Body of the exchange will be mapped to HTTP body. Setting this to false will avoid the HTTP mapping.</p></td></tr><tr><td align="left" valign="top"><p>mapHttpMessageFormUrlEncodedBody</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true then IN exchange Form Encoded body of the exchange will be mapped to HTTP. Setting this to false will avoid the HTTP Form Encoded body mapping.</p></td></tr><tr><td align="left" valign="top"><p>mapHttpMessageHeaders</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If this option is true then IN exchange Headers of the exchange will be mapped to HTTP headers. Setting this to false will avoid the HTTP Headers mapping.</p></td></tr><tr><td align="left" valign="top"><p>synchronous</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used or Camel is allowed to use asynchronous processing (if supported).</p></td></tr><tr><td align="left" valign="top"><p>useSystemProperties</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>To use System Properties as fallback for configuration</p></td></tr></tbody></table></div><p>{% endraw %}</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-MessageHeaders"></a>Message Headers</h2></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="20%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_URI</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>URI to call. Will override existing URI set directly on the endpoint.
This uri is the uri of the http server to call. Its not the same as the
Camel endpoint uri, where you can configure endpoint options such as
security etc. This header does not support that, its only the uri of the
http server.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_PATH</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Request URI&#8217;s path, the header will be used to build the request URI
with the HTTP_URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_QUERY</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>URI parameters. Will override existing URI parameters set directly on
the endpoint.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_RESPONSE_CODE</code></p></td><td align="left" valign="top"><p><code class="literal">int</code></p></td><td align="left" valign="top"><p>The HTTP response code from the external server. Is 200 for OK.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_RESPONSE_TEXT</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The HTTP response text from the external server.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.HTTP_CHARACTER_ENCODING</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Character encoding.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.CONTENT_TYPE</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The HTTP content type. Is set on both the IN and OUT message to provide
a content type, such as <code class="literal">text/html</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Exchange.CONTENT_ENCODING</code></p></td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>The HTTP content encoding. Is set on both the IN and OUT message to
provide a content encoding, such as <code class="literal">gzip</code>.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-MessageBody"></a>Message Body</h2></div></div></div><p>Camel will store the HTTP response from the external server on the OUT
body. All headers from the IN message will be copied to the OUT message,
so headers are preserved during routing. Additionally Camel will add the
HTTP response headers as well to the OUT message headers.</p><p>&nbsp;</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-UsingSystemProperties"></a>Using System Properties</h2></div></div></div><p>When setting useSystemProperties to true, the HTTP Client will look for
the following System Properties and it will use it:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">ssl.TrustManagerFactory.algorithm</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.trustStoreType</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.trustStore</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.trustStoreProvider</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.trustStorePassword</li><li class="listitem">java.home</li><li class="listitem">ssl.KeyManagerFactory.algorithm</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.keyStoreType</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.keyStore</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.keyStoreProvider</li><li class="listitem"><a class="link" href="http://javax.net/" target="_top">javax.net</a>.ssl.keyStorePassword</li><li class="listitem">http.proxyHost</li><li class="listitem">http.proxyPort</li><li class="listitem">http.nonProxyHosts</li><li class="listitem">http.keepAlive</li><li class="listitem">http.maxConnections</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-Responsecode"></a>Response code</h2></div></div></div><p>Camel will handle according to the HTTP response code:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Response code is in the range 100..299, Camel regards it as a success
response.</li><li class="listitem">Response code is in the range 300..399, Camel regards it as a
redirection response and will throw a <code class="literal">HttpOperationFailedException</code>
with the information.</li><li class="listitem">Response code is 400+, Camel regards it as an external server failure
and will throw a <code class="literal">HttpOperationFailedException</code> with the information.</li></ul></div><p><span class="strong"><strong>throwExceptionOnFailure</strong></span>
The option, <code class="literal">throwExceptionOnFailure</code>, can be set to <code class="literal">false</code> to prevent
the <code class="literal">HttpOperationFailedException</code> from being thrown for failed response
codes. This allows you to get any response from the remote server.
There is a sample below demonstrating this.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-HttpOperationFailedException"></a>HttpOperationFailedException</h2></div></div></div><p>This exception contains the following information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">The HTTP status code</li><li class="listitem">The HTTP status line (text of the status code)</li><li class="listitem">Redirect location, if server returned a redirect</li><li class="listitem">Response body as a <code class="literal">java.lang.String</code>, if server provided a body as
response</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-CallingusingGETorPOST"></a>Calling using GET or POST</h2></div></div></div><p>The following algorithm is used to determine whether the <code class="literal">GET</code> or <code class="literal">POST</code>
HTTP method should be used:
 1. Use method provided in header.
 2. <code class="literal">GET</code> if query string is provided in header.
 3. <code class="literal">GET</code> if endpoint is configured with a query string.
 4. <code class="literal">POST</code> if there is data to send (body is not null).
 5. <code class="literal">GET</code> otherwise.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-HowtogetaccesstoHttpServletRequestandHttpServletResponse"></a>How to get access to HttpServletRequest and HttpServletResponse</h2></div></div></div><p>You can get access to these two using the Camel type converter system
using
 <span class="strong"><strong>NOTE</strong></span> You can get the request and response not just from the processor
after the camel-jetty or camel-cxf endpoint.</p><pre class="programlisting">HttpServletRequest request = exchange.getIn().getBody(HttpServletRequest.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);
HttpServletRequest response = exchange.getIn().getBody(HttpServletResponse.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-ConfiguringURItocall"></a>Configuring URI to call</h2></div></div></div><p>You can set the HTTP producer&#8217;s URI directly form the endpoint URI. In
the route below, Camel will call out to the external server, <code class="literal">oldhost</code>,
using HTTP.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
        .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://oldhost"</em></strong>);</pre><p>And the equivalent Spring sample:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://activemq.apache.org/camel/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http4://oldhost"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre><p>You can override the HTTP endpoint URI by adding a header with the key,
<code class="literal">Exchange.HTTP_URI</code>, on the message.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
  .setHeader(Exchange.HTTP_URI, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http://newhost"</em></strong>))
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://oldhost"</em></strong>);</pre><p>In the sample above Camel will call the <a class="link" href="http://newhost" target="_top">http://newhost</a> despite the
endpoint is configured with http4://oldhost.
If the http4 endpoint is working in bridge mode, it will ignore the
message header of <code class="literal">Exchange.HTTP_URI</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-ConfiguringURIParameters"></a>Configuring URI Parameters</h2></div></div></div><p>The <span class="strong"><strong>http</strong></span> producer supports URI parameters to be sent to the HTTP
server. The URI parameters can either be set directly on the endpoint
URI or as a header with the key <code class="literal">Exchange.HTTP_QUERY</code> on the message.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://oldhost?order=123&amp;detail=short"</em></strong>);</pre><p>Or options provided in a header:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
  .setHeader(Exchange.HTTP_QUERY, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"order=123&amp;detail=short"</em></strong>))
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://oldhost"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-HowtosetthehttpmethodtotheHTTPproducer"></a>How to set the http method (GET/PATCH/POST/PUT/DELETE/HEAD/OPTIONS/TRACE) to the HTTP producer</h2></div></div></div><p><span class="strong"><strong>Using the http PATCH method</strong></span></p><p>The http PATCH method is supported starting with Camel 2.11.3 / 2.12.1.</p><p>The HTTP4 component provides a way to set the HTTP request method by
setting the message header. Here is an example:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
  .setHeader(Exchange.HTTP_METHOD, constant(org.apache.camel.component.http4.HttpMethods.POST))
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://www.google.com"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:results"</em></strong>);</pre><p>The method can be written a bit shorter using the string constants:</p><pre class="programlisting">.setHeader(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"CamelHttpMethod"</em></strong>, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"POST"</em></strong>))</pre><p>And the equivalent Spring sample:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://activemq.apache.org/camel/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;setHeader</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">headerName</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"CamelHttpMethod"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constant&gt;</strong>POST<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constant&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/setHeader&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http4://www.google.com"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:results"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-Usingclienttimeout-SO_TIMEOUT"></a>Using client timeout - SO_TIMEOUT</h2></div></div></div><p>See the
<a class="link" href="https://svn.apache.org/repos/asf/camel/trunk/components/camel-http4/src/test/java/org/apache/camel/component/http4/HttpSOTimeoutTest.java" target="_top">HttpSOTimeoutTest</a>
unit test.</p><p><span class="strong"><strong>Since Camel 2.13.0</strong></span>: See the updated
<a class="link" href="https://github.com/apache/camel/blob/master/components/camel-http4/src/test/java/org/apache/camel/component/http4/HttpSOTimeoutTest.java" target="_top">HttpSOTimeoutTest</a>
unit test.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-ConfiguringaProxy"></a>Configuring a Proxy</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-UsingproxysettingsoutsideofURI">Using proxy settings outside of URI</a></span></dt></dl></div><p>The HTTP4 component provides a way to configure a proxy.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://oldhost?proxyAuthHost=www.myproxy.com&amp;proxyAuthPort=80"</em></strong>);</pre><p>There is also support for proxy authentication via the
<code class="literal">proxyAuthUsername</code> and <code class="literal">proxyAuthPassword</code> options.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-UsingproxysettingsoutsideofURI"></a>Using proxy settings outside of URI</h3></div></div></div><p>To avoid System properties conflicts, you can set proxy configuration
only from the CamelContext or URI.
 Java DSL :</p><pre class="programlisting"> context.getProperties().put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http.proxyHost"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"172.168.18.9"</em></strong>);
 context.getProperties().put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http.proxyPort"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"8080"</em></strong>);</pre><p>Spring XML</p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext&gt;</strong>
       <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;properties&gt;</strong>
           <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">key</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http.proxyHost"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"172.168.18.9"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
           <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">key</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http.proxyPort"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"8080"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/properties&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre><p>Camel will first set the settings from Java System or CamelContext
Properties and then the endpoint proxy options if provided.
 So you can override the system properties with the endpoint options.</p><p>Notice in <span class="strong"><strong>Camel 2.8</strong></span> there is also a <code class="literal">http.proxyScheme</code> property you
can set to explicit configure the scheme to use.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-Configuringcharset"></a>Configuring charset</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-Samplewithscheduledpoll">Sample with scheduled poll</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-URIParametersfromtheendpointURI">URI Parameters from the endpoint URI</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-URIParametersfromtheMessage">URI Parameters from the Message</a></span></dt><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-GettingtheResponseCode">Getting the Response Code</a></span></dt></dl></div><p>If you are using <code class="literal">POST</code> to send data you can configure the <code class="literal">charset</code>
using the <code class="literal">Exchange</code> property:</p><pre class="programlisting">exchange.setProperty(Exchange.CHARSET_NAME, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"ISO-8859-1"</em></strong>);</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-Samplewithscheduledpoll"></a>Sample with scheduled poll</h3></div></div></div><p>This sample polls the Google homepage every 10 seconds and write the
page to the file <code class="literal">message.html</code>:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"timer://foo?fixedRate=true&amp;delay=0&amp;period=10000"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://www.google.com"</em></strong>)
  .setHeader(FileComponent.HEADER_FILE_NAME, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"message.html"</em></strong>)
  .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"file:target/google"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-URIParametersfromtheendpointURI"></a>URI Parameters from the endpoint URI</h3></div></div></div><p>In this sample we have the complete URI endpoint that is just what you
would have typed in a web browser. Multiple URI parameters can of course
be set using the <code class="literal">&amp;</code> character as separator, just as you would in the
web browser. Camel does no tricks here.</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// we query for Camel at the Google page</em>
template.sendBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://www.google.com/search?q=Camel"</em></strong>, null);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-URIParametersfromtheMessage"></a>URI Parameters from the Message</h3></div></div></div><pre class="programlisting">Map headers = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HashMap();
headers.put(Exchange.HTTP_QUERY, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"q=Camel&amp;lr=lang_en"</em></strong>);
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// we query for Camel and English language at Google</em>
template.sendBody(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://www.google.com/search"</em></strong>, null, headers);</pre><p>In the header value above notice that it should <span class="strong"><strong>not</strong></span> be prefixed with
<code class="literal">?</code> and you can separate parameters as usual with the <code class="literal">&amp;</code> char.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-GettingtheResponseCode"></a>Getting the Response Code</h3></div></div></div><p>You can get the HTTP response code from the HTTP4 component by getting
the value from the Out message header with
<code class="literal">Exchange.HTTP_RESPONSE_CODE</code>.</p><pre class="programlisting">Exchange exchange = template.send(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4://www.google.com/search"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Processor() {
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> process(Exchange exchange) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
    exchange.getIn().setHeader(Exchange.HTTP_QUERY, constant(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"hl=en&amp;q=activemq"</em></strong>));
  }
});
Message out = exchange.getOut();
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">int</strong> responseCode = out.getHeader(Exchange.HTTP_RESPONSE_CODE, Integer.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-DisablingCookies"></a>Disabling Cookies</h2></div></div></div><p>To disable cookies you can set the HTTP Client to ignore cookies by
adding this URI option:
 <code class="literal">httpClient.cookiePolicy=ignoreCookies</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="HTTP4-AdvancedUsage"></a>Advanced Usage</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="HTTP4-HTTP4Component.html#HTTP4-SettingupSSLforHTTPClient">Setting up SSL for HTTP Client</a></span></dt></dl></div><p>If you need more control over the HTTP producer you should use the
<code class="literal">HttpComponent</code> where you can set various classes to give you custom
behavior.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="HTTP4-SettingupSSLforHTTPClient"></a>Setting up SSL for HTTP Client</h3></div></div></div><p><a name="HTTP4-UsingtheJSSEConfigurationUtility"></a>Using the JSSE Configuration Utility</p><p>As of Camel 2.8, the HTTP4 component supports SSL/TLS configuration
through the <a class="link" href="camel-configuration-utilities.html" target="_top">Camel JSSE
Configuration Utility</a>.&nbsp; This utility greatly decreases the amount of
component specific code you need to write and is configurable at the
endpoint and component levels.&nbsp; The following examples demonstrate how
to use the utility with the HTTP4 component.</p><p><a name="HTTP4-Programmaticconfigurationofthecomponent"></a>Programmatic configuration of the component</p><pre class="programlisting">KeyStoreParameters ksp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
ksp.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"/users/home/server/keystore.jks"</em></strong>);
ksp.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystorePassword"</em></strong>);

KeyManagersParameters kmp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyPassword"</em></strong>);

SSLContextParameters scp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SSLContextParameters();
scp.setKeyManagers(kmp);

HttpComponent httpComponent = getContext().getComponent(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"https4"</em></strong>, HttpComponent.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);
httpComponent.setSslContextParameters(scp);</pre><p><a name="HTTP4-SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</p><pre class="programlisting">...
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:sslContextParameters</strong>
      <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:keyManagers</strong>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">keyPassword</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyPassword"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:keyStore</strong>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/users/home/server/keystore.jks"</span>
          <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keystorePassword"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:keyManagers&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:sslContextParameters&gt;</strong>...
...
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"https4://127.0.0.1/mail/?sslContextParametersRef=sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>...</pre><p><a name="HTTP4-ConfiguringApacheHTTPClientDirectly"></a>Configuring Apache HTTP Client Directly</p><p>Basically camel-http4 component is built on the top of
<a class="link" href="http://hc.apache.org/httpcomponents-client-ga/" target="_top">Apache HttpClient</a>.
Please refer to
<a class="link" href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d4e537" target="_top">SSL/TLS
customization</a> for details or have a look into the
<code class="literal">org.apache.camel.component.http4.HttpsServerTestSupport</code> unit test base
class.
 You can also implement a custom
<code class="literal">org.apache.camel.component.http4.HttpClientConfigurer</code> to do some
configuration on the http client if you need full control of it.</p><p>However if you <span class="emphasis"><em>just</em></span> want to specify the keystore and truststore you
can do this with Apache HTTP <code class="literal">HttpClientConfigurer</code>, for example:</p><pre class="programlisting">KeyStore keystore = ...;
KeyStore truststore = ...;

SchemeRegistry registry = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SchemeRegistry();
registry.register(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> Scheme(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"https"</em></strong>, <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">443</span>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SSLSocketFactory(keystore, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mypassword"</em></strong>, truststore)));</pre><p>And then you need to create a class that implements
<code class="literal">HttpClientConfigurer</code>, and registers https protocol providing a
keystore or truststore per example above. Then, from your camel route
builder class you can hook it up like so:</p><pre class="programlisting">HttpComponent httpComponent = getContext().getComponent(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"http4"</em></strong>, HttpComponent.<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>);
httpComponent.setHttpClientConfigurer(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MyHttpClientConfigurer());</pre><p>If you are doing this using the Spring DSL, you can specify your
<code class="literal">HttpClientConfigurer</code> using the URI. For example:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"myHttpClientConfigurer"</span>
 <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"my.https.HttpClientConfigurer"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"https4://myhostname.com:443/myURL?httpClientConfigurer=myHttpClientConfigurer"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><p>As long as you implement the HttpClientConfigurer and configure your
keystore and truststore as described above, it will work fine.</p><p><a name="HTTP4-UsingHTTPStoauthenticategotchas"></a>Using HTTPS to authenticate gotchas</p><p>An end user reported that he had problem with authenticating with HTTPS.
The problem was eventually resolved by providing a custom configured
<code class="literal">org.apache.http.protocol.HttpContext</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">1. Create a (Spring) factory for HttpContexts:</li></ul></div><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong> HttpContextFactory {

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> String httpHost = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"localhost"</em></strong>;
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> String httpPort = <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">9001</span>;

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> BasicHttpContext httpContext = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicHttpContext();
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> BasicAuthCache authCache = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicAuthCache();
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">private</strong> BasicScheme basicAuth = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BasicScheme();

  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> HttpContext getObject() {
    authCache.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HttpHost(httpHost, httpPort), basicAuth);

    httpContext.setAttribute(ClientContext.AUTH_CACHE, authCache);

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">return</strong> httpContext;
  }

  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// getter and setter</em>
}</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">2. Declare an HttpContext in the Spring application context file:</li></ul></div><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"myHttpContext"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">factory-bean</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"httpContextFactory"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">factory-method</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"getObject"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">3. Reference the context in the http4 URL:</li></ul></div><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"https4://myhostname.com:443/myURL?httpContext=myHttpContext"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><p><a name="HTTP4-UsingdifferentSSLContextParameters"></a>Using different SSLContextParameters</p><p>The <a class="link" href="http4.html" target="_top">HTTP4</a> component only support one instance of
<code class="literal">org.apache.camel.util.jsse.SSLContextParameters</code> per component. If you
need to use 2 or more different instances, then you need to setup
multiple <a class="link" href="http4.html" target="_top">HTTP4</a> components as shown below. Where we have
2 components, each using their own instance of <code class="literal">sslContextParameters</code>
property.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http4-foo"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.http4.HttpComponent"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParams1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"x509HostnameVerifier"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"hostnameVerifier"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http4-bar"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.http4.HttpComponent"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParams2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"x509HostnameVerifier"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"hostnameVerifier"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong></pre></div></div></div></body></html>
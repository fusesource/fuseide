<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Adding another route to the routing context</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling"><link rel="up" href="RiderTT.html" title="Part&nbsp;I.&nbsp;Tooling Tutorials"><link rel="prev" href="RiderTutorialCBR.html" title="Adding a Content-Based Router"><link rel="next" href="RiderTutorialDebug.html" title="Debugging a routing context"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="RiderTutorialAddRoute"></a>Adding another route to the routing context</h2></div></div></div><p>This tutorial shows you how to add a second route to the camel context in the <code class="literal">ZooOrderApp</code> project&#8217;s <code class="literal">blueprint.xml</code> file. The second route:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Takes messages (valid orders) directly from the terminal end of the first route&#8217;s <span class="strong"><strong>otherwise</strong></span> branch.</li><li class="listitem">Sorts the valid messages according to the customer&#8217;s country.</li><li class="listitem">Sends each message to the corresponding <code class="literal">country</code> folder in the <code class="literal">ZooOrderApp/target/messages</code> folder. For example, an order from the Chicago zoo is copied to the USA folder.</li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_goals_5"></a>Goals</h2></div></div></div><p>In this tutorial you complete the following tasks:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Reconfigure the existing route for direct connection to a second route</li><li class="listitem">Add a second route to your Camel context</li><li class="listitem">Configure the second route to take messages directly from the otherwise branch of the first route</li><li class="listitem">Add a content-based router to the second route</li><li class="listitem">Add and configure a message header, logging, and target destination to each output branch of the second  route&#8217;s content-based router</li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_prerequisites_4"></a>Prerequisites</h2></div></div></div><p>To start this tutorial, you need the <span class="strong"><strong>ZooOrderApp</strong></span> project resulting from one of the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">Complete the <a class="xref" href="RiderTutorialCBR.html" title="Adding a Content-Based Router"><i>Adding a Content-Based Router</i></a> tutorial.</p><p class="simpara">or</p></li><li class="listitem">Complete the <a class="xref" href="RiderTutorialSetup.html" title="Setting up your environment"><i>Setting up your environment</i></a>  tutorial and replace your project&#8217;s <code class="literal">blueprint.xml</code> file with the provided <code class="literal">blueprintContexts/blueprint2.xml</code> file, as described in <a class="xref" href="RiderTutorialIntro.html#AboutResourceFiles" title="About the resource files">About the resource files</a>.</li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_reconfiguring_the_existing_route_s_endpoint"></a>Reconfiguring the existing route&#8217;s endpoint</h2></div></div></div><p>The existing route sends all valid orders to the <code class="literal">target/messages/validOrders</code> folder.</p><p>In this section, you reconfigure the endpoint of the existing route&#8217;s <span class="strong"><strong>Otherwise _elseValid</strong></span> branch to instead connect to a second route (which you create in the next section).</p><p>To configure the existing route for direct connection with the second route:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Open your <code class="literal">ZooOrderApp/src/main/resources/OSGI-INF/blueprint/blueprint.xml</code> in
the route editor.</li><li class="listitem">On the canvas, select the <span class="strong"><strong>Route_route1</strong></span> container to open its properties
in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem">Scroll down to the <span class="strong"><strong>Shutdown Route</strong></span> property and then select <span class="strong"><strong>Default</strong></span>.</li><li class="listitem">On the canvas, select the terminal file node <span class="strong"><strong>To_Valid</strong></span> to
display its properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem">In the <span class="strong"><strong>Uri</strong></span> field, delete the existing text, and then enter <code class="literal"><span class="strong"><strong>direct:OrderFulfillment</strong></span></code>.</li><li class="listitem">In the <span class="strong"><strong>Id</strong></span> field, enter <code class="literal"><span class="strong"><strong>_Fulfill</strong></span></code>.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Instead of repurposing the existing <code class="literal">To_Valid</code> terminal file node, you could have replaced it with a <span class="strong"><strong>Components</strong></span> &#8594; <span class="strong"><strong>Direct</strong></span> component, configuring it with the same property values as the repurposed <code class="literal">To_Valid</code> node.</p><p>To learn more about the <span class="strong"><strong>Direct</strong></span> component see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_fuse/7.4/html-single/apache_camel_component_reference/index" target="_top">Apache Camel Component Reference</a>.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_adding_the_second_route"></a>Adding the second route</h2></div></div></div><p>To add another route to the routing context:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Routing</strong></span> drawer and then click the <span class="strong"><strong>Route</strong></span> (
<span class="inlinemediaobject"><img src="images/route.png" alt="Route icon"></span>) pattern.</li><li class="listitem"><p class="simpara">In the canvas, click to the right of the <code class="literal">Route_route1</code> container:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutRte2DropOnCanvas.png" alt="tutRte2DropOnCanvas"></div></div><p class="simpara">The <span class="strong"><strong>Route</strong></span> pattern becomes the <code class="literal">Route_route2</code> container node on the canvas.</p></li><li class="listitem">Click the <code class="literal">Route_route2</code> container node to display its properties in the <span class="strong"><strong>Properties</strong></span> view. Leave the properties as they are.</li><li class="listitem"><span class="strong"><strong>Save</strong></span> the file.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>As your routing context grows in complexity, you might want to focus the route editor
on an individual route while you work on it. To do so, in <span class="strong"><strong>Project Explorer</strong></span>, double-click the route that you want the route editor to display on the canvas; for example <code class="literal">Route_route2</code>:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutProjExSwitchRtesOnCanvas.png" alt="tutProjExSwitchRtesOnCanvas"></div></div><p>To display all routes in the routing context on the canvas, double-click the
project&#8217;s <code class="literal">.xml</code> context file entry
(<code class="literal">src/main/resources/OSGI-INF/&#8230;&#8203;</code>) at
the top of the <code class="literal">Camel Contexts</code> folder.</p></td></tr></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_a_choice_branch_to_process_usa_orders"></a>Configuring a Choice branch to process USA orders</h2></div></div></div><p>In this section, you add a Choice branch to the route and configure the route to send USA orders to a new <code class="literal">target/messages/validOrders/USA</code> folder. You also set a message header and a log file component.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Components</strong></span> drawer and then select the <span class="strong"><strong>Direct</strong></span> component (
<span class="inlinemediaobject"><img src="images/endpoint.png" alt="Direct icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">Route_route2</code> container:</p><p class="simpara">The <code class="literal">Route_route2</code> container expands to accommodate the <span class="strong"><strong>Direct</strong></span> component (the <code class="literal">From_from2</code> node):</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2From2Add.png" alt="tutCBRrte2From2Add"></div></div></li><li class="listitem">On the canvas, click the <code class="literal">From_from2</code> node to open its properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Uri</strong></span> field, replace <code class="literal">name</code> (following <code class="literal">direct:</code>) with <code class="literal"><span class="strong"><strong>OrderFulfillment</strong></span></code>, and in the <span class="strong"><strong>Id</strong></span> field, enter <code class="literal"><span class="strong"><strong>_direct:OrderFulfillment</strong></span></code>.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2From2Props.png" alt="tutCBRrte2From2Props"></div></div></li><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Routing</strong></span> drawer and then select the <span class="strong"><strong>Choice</strong></span> (
<span class="inlinemediaobject"><img src="images/choice.png" alt="Choice icon"></span>) pattern.</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">From _direct:OrderFulfillment</code> node.</p><p class="simpara">The <code class="literal">Route_route2</code> container expands to accommodate the
<code class="literal">Choice_choice2</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2Choice2Added.png" alt="tutCBRrte2Choice2Added"></div></div><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view, leave the <code class="literal">Choice_choice2</code> node&#8217;s properties as they are.</p></li><li class="listitem">In the Palette, open the <span class="strong"><strong>Routing</strong></span> drawer and then select the <span class="strong"><strong>When</strong></span> (
<span class="inlinemediaobject"><img src="images/endpointdef.png" alt="When icon"></span>) pattern.</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">Choice_choice2</code> node.</p><p class="simpara">The <code class="literal">Choice_choice2</code> container expands to accommodate the <code class="literal">When_when2</code> node.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2When2Added.png" alt="tutCBRrte2When2Added"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">When_when2</code> node to open its properties in the
<span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">Set the <code class="literal">When_when2</code> node&#8217;s properties as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Select <span class="strong"><strong>xpath</strong></span> from the <span class="strong"><strong>Expression</strong></span> drop-down list.</li><li class="listitem">In the indented <span class="strong"><strong>Expression</strong></span> field, type <code class="literal"><span class="strong"><strong>/order/customer/country = 'USA'</strong></span></code>.</li><li class="listitem">Leave <span class="strong"><strong>Trim</strong></span> enabled.</li><li class="listitem"><p class="simpara">In the second <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_when/usa</strong></span></code></p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2WhenUSAprops.png" alt="tutCBRrte2WhenUSAprops"></div></div></li></ul></div></li><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Components</strong></span> drawer and then select the <span class="strong"><strong>File</strong></span> component (
<span class="inlinemediaobject"><img src="images/file.png" alt="File icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">When_when/usa</code> container.</p><p class="simpara">The <code class="literal">When_when/usa</code> container expands to accommodate the <code class="literal">To_to1</code> node.</p></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutRte2EndptUSA.png" alt="tutRte2EndptUSA"></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">In the <span class="strong"><strong>Uri</strong></span> field, replace <code class="literal">directoryName</code> with
<code class="literal"><span class="strong"><strong>target/messages/validOrders/USA</strong></span></code> .</li><li class="listitem">In the <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_US</strong></span></code>.</li></ul></div></li><li class="listitem"><span class="strong"><strong>Save</strong></span> the file.</li></ol></div><p>To set a message header and add a log component:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Transformation</strong></span> drawer and then select the <span class="strong"><strong>Set Header</strong></span> pattern.</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">When_when/usa</code> node.</p><p class="simpara">The <code class="literal">When_when/usa</code> container expands to accommodate the <code class="literal">SetHeader_setHeader3</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2SetHeadUSAadd.png" alt="tutCBRrte2SetHeadUSAadd"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">SetHeader_setHeader3</code> node to open its
properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">Set the node&#8217;s properties as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">From the <span class="strong"><strong>Expression</strong></span> drop-down menu, select <span class="strong"><strong>constant</strong></span>.</li><li class="listitem">In the indented <span class="strong"><strong>Expression</strong></span> field, type: <code class="literal"><span class="strong"><strong>USA</strong></span></code></li><li class="listitem">Leave <span class="strong"><strong>Trim</strong></span> enabled.</li><li class="listitem">In the <span class="strong"><strong>Header Name</strong></span> field, type: <code class="literal"><span class="strong"><strong>Destination</strong></span></code></li><li class="listitem"><p class="simpara">In the second <span class="strong"><strong>Id</strong></span> field, type: <code class="literal"><span class="strong"><strong>_setHead_usa</strong></span></code></p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCRErte2SetHeadusaProps.png" alt="tutCRErte2SetHeadusaProps"></div></div></li></ul></div></li><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Components</strong></span> drawer and then select the <span class="strong"><strong>Log</strong></span> component (
<span class="inlinemediaobject"><img src="images/log.png" alt="Log icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click above the <code class="literal">SetHeader</code> node.</p><p class="simpara">The <code class="literal">When_when/usa</code> container expands to accommodate the <code class="literal">Log_log3</code> node.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2Log3Added.png" alt="tutCBRrte2Log3Added"></div></div></li><li class="listitem"><p class="simpara">On the canvas, select the <code class="literal">Log_log3</code> node to open its properties in the
<span class="strong"><strong>Properties</strong></span> view:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrteLog3Props.png" alt="tutCBRrteLog3Props"></div></div></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">In the <span class="strong"><strong>Message</strong></span> field, type <code class="literal"><span class="strong"><strong>Valid order - ship animals to USA customer</strong></span></code> .</li><li class="listitem">In the <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_usa</strong></span></code>.</li><li class="listitem"><p class="simpara">Leave <span class="strong"><strong>Logging Level</strong></span> as is.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2Log3usaAdded.png" alt="tutCBRrte2Log3usaAdded"></div></div></li></ul></div></li><li class="listitem"><p class="simpara"><span class="strong"><strong>Save</strong></span> the file.</p><p class="simpara">The USA branch of <code class="literal">Route_route2</code> should look like this:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutUSAbranchRte2.png" alt="tutUSAbranchRte2"></div></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_an_otherwise_branch_to_process_germany_orders"></a>Configuring an Otherwise branch to process Germany orders</h2></div></div></div><p>With <code class="literal">Route_route2</code> displayed on the canvas:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Routing</strong></span> drawer and then select the <span class="strong"><strong>Otherwise</strong></span> pattern (<span class="inlinemediaobject"><img src="images/endpointdef.png" alt="Otherwise icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">Choice_choice2</code> container.</p><p class="simpara">The <code class="literal">Choice_choice2</code> container expands to accommodate the <code class="literal">Otherwise_otherwise1</code> node.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2WhenGERAdd.png" alt="tutCBRrte2WhenGERAdd"></div></div></li><li class="listitem">Select the <code class="literal">Otherwise_otherwise1</code> node to open its properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem">In the <span class="strong"><strong>Properties</strong></span> view, enter <code class="literal"><span class="strong"><strong>_else/ger</strong></span></code> for the <span class="strong"><strong>Id</strong></span> field.</li><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Transformation</strong></span> drawer and then select the <span class="strong"><strong>Set Header</strong></span> pattern (
<span class="inlinemediaobject"><img src="images/setHeader.png" alt="Set Header icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click the <code class="literal">Otherwise_else/ger</code> node.</p><p class="simpara">The <code class="literal">Otherwise_else/ger</code> container expands to accommodate the <code class="literal">SetHeader_setHeader3</code> node.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2SetHeadGERAdd.png" alt="tutCBRrte2SetHeadGERAdd"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">SetHeader_setHeader3</code> node to open its properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">From the <span class="strong"><strong>Expression</strong></span> drop-down list, select <span class="strong"><strong>constant</strong></span>.</li><li class="listitem">In the second <span class="strong"><strong>Expression</strong></span> field, type <code class="literal"><span class="strong"><strong>Germany</strong></span></code>.</li><li class="listitem">Leave <span class="strong"><strong>Trim</strong></span> as is.</li><li class="listitem">In the <span class="strong"><strong>Header Name</strong></span> field, type <code class="literal"><span class="strong"><strong>Destination</strong></span></code>.</li><li class="listitem">In the second <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_setHead_ger</strong></span></code>.</li></ul></div></li><li class="listitem">In the <span class="strong"><strong>Palette</strong></span>, open the <span class="strong"><strong>Components</strong></span> drawer and then select the <span class="strong"><strong>Log</strong></span> pattern (
<span class="inlinemediaobject"><img src="images/log.png" alt="Log icon"></span>).</li><li class="listitem"><p class="simpara">In the canvas, click below the <code class="literal">SetHeader_setHead_ger</code> node.</p><p class="simpara">The <code class="literal">Otherwise_else/ger</code> container expands to accommodate the <code class="literal">Log_log3</code> node. If needed, drag the connector error from the <code class="literal">Log_log3</code> node to the <code class="literal">SetHeader_setHead_ger</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2LogGERAdd.png" alt="tutCBRrte2LogGERAdd"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">Log_log3</code> node to open its properties in the <span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">In the <span class="strong"><strong>Message</strong></span> field, type <code class="literal"><span class="strong"><strong>Valid order - ship animals to Germany customer</strong></span></code>.</li><li class="listitem">In the <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_ger</strong></span></code>.</li><li class="listitem">Leave the <span class="strong"><strong>Logging Level</strong></span> as is.</li></ul></div></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Components</strong></span> drawer, select a <span class="strong"><strong>File</strong></span> pattern (<span class="inlinemediaobject"><img src="images/file.png" alt="File icon"></span>) and then click below the <code class="literal">Log_ger</code> node.</p><p class="simpara">The <code class="literal">Otherwise_else/ger</code> container expands to accommodate the <code class="literal">To_to1</code> node. If needed, drag the connector error from the <code class="literal">SetHeader_setHead_ger</code> node to the <code class="literal">To_to1</code> node:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2GERtermFile.png" alt="tutCBRrte2GERtermFile"></div></div></li><li class="listitem">On the canvas, select the <code class="literal">To_to1</code> node to open its properties in the
<span class="strong"><strong>Properties</strong></span> view.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Properties</strong></span> view:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">In the <span class="strong"><strong>Uri</strong></span> field, replace <code class="literal">directoryName</code> with <code class="literal"><span class="strong"><strong>target/messages/validOrders/Germany</strong></span></code></li><li class="listitem">In the <span class="strong"><strong>Id</strong></span> field, type <code class="literal"><span class="strong"><strong>_GER</strong></span></code>.</li></ul></div></li><li class="listitem"><span class="strong"><strong>Save</strong></span> the file.</li></ol></div><p>The Germany branch of <code class="literal">Route_route2</code> should look like this:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutGERbranchRte2.png" alt="tutGERbranchRte2"></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_verifying_the_second_route"></a>Verifying the second route</h2></div></div></div><p>The routes on the canvas should look like this:</p><p>Completed route1</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRRte1Completed.png" alt="Completed first route in the ZooOrderApp routing context"></div></div><p>Completed route2</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRRte2Completed.png" alt="Completed second route in the ZooOrderApp routing context"></div></div><p>In the <span class="strong"><strong>Source</strong></span> tab at the bottom of the canvas, the XML for the camelContext element should look like that
shown in <a class="xref" href="RiderTutorialAddRoute.html#CBREx011" title="Example&nbsp;1.&nbsp;XML for dual-route content-based router">Example&nbsp;1, &#8220;XML for dual-route content-based router&#8221;</a>:</p><div class="example"><a name="CBREx011"></a><p class="title"><b>Example&nbsp;1.&nbsp;XML for dual-route content-based router</b></p><div class="example-contents"><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0
    https://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
    http://camel.apache.org/schema/blueprint
    https://camel.apache.org/schema/blueprint/camel-blueprint.xsd"&gt;

    &lt;camelContext id="_context1" xmlns="http://camel.apache.org/schema/blueprint"&gt;
       &lt;route id="_route1" shutdownRoute="Default"&gt;
           &lt;from id="_from1" uri="file:src/data?noop=true"/&gt;
           &lt;choice id="_choice1"&gt;
               &lt;when id="_when1"&gt;
                   &lt;xpath&gt;/order/orderline/quantity/text() &amp;gt; 10&lt;/xpath&gt;
                   &lt;log id="_log1" message="The quantity requested exceeds the maximum allowed - contact customer."/&gt;
                   &lt;setHeader headerName="Destination" id="_setHeader1"&gt;
                       &lt;constant&gt;Invalid&lt;/constant&gt;
                   &lt;/setHeader&gt;
                   &lt;to id="_Invalid" uri="file:target/messages/invalidOrders"/&gt;
               &lt;/when&gt;
               &lt;otherwise id="_elseValid"&gt;
                   &lt;log id="_log2" message="This is a valid order - OK to process."/&gt;
                   &lt;setHeader headerName="Destination" id="_setHeader2"&gt;
                       &lt;constant&gt;ReadyForDispatcher&lt;/constant&gt;
                   &lt;/setHeader&gt;
                   &lt;to id="_Fulfill" uri="direct:OrderFulfillment"/&gt;
               &lt;/otherwise&gt;
           &lt;/choice&gt;
       &lt;/route&gt;
       &lt;route id="_route2"&gt;
           &lt;from id="_direct:OrderFulfillment" uri="direct:OrderFulfillment"/&gt;
           &lt;choice id="_choice2"&gt;
               &lt;when id="when/usa"&gt;
                   &lt;xpath&gt;/order/customer/country = 'USA'&lt;/xpath&gt;
                   &lt;log id="_usa" message="Valid order - ship animals to USA customer"/&gt;
                   &lt;setHeader headerName="Destination" id="_setHead_usa"&gt;
                       &lt;constant&gt;USA&lt;/constant&gt;
                   &lt;/setHeader&gt;
                   &lt;to id="_US" uri="file:target/messages/validOrders/USA"/&gt;
               &lt;/when&gt;
               &lt;otherwise id="_else/ger"&gt;
                   &lt;log id="_ger" message="Valid order - ship animals to Germany customer"/&gt;
                   &lt;setHeader headerName="Destination" id="_setHead_ger"&gt;
                       &lt;constant&gt;Germany&lt;/constant&gt;
                   &lt;/setHeader&gt;
                   &lt;to id="_GER" uri="file:target/messages/validOrders/Germany"/&gt;
               &lt;/otherwise&gt;
           &lt;/choice&gt;
       &lt;/route&gt;
   &lt;/camelContext&gt;
&lt;/blueprint&gt;</pre></div></div><br class="example-break"><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>If the tooling added the attribute <code class="literal">shutdownRoute=" "</code> to the second route element (<code class="literal">&lt;route id="route2"&gt;</code>), delete that attribute.
Otherwise, the <code class="literal">ZooOrderApp</code> project might fail to run.</p></td></tr></table></div><p>To make sure that your updated project works as expected, follow these steps:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Run the <code class="literal">ZooOrderApp/Camel Contexts/blueprint.xml</code> as a local Camel Context (without tests).</li><li class="listitem"><p class="simpara">Check the end of the Console&#8217;s output. You should see these lines:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/tutCBRrte2Console.png" alt="tutCBRrte2Console"></div></div></li><li class="listitem"><p class="simpara">Check the target destination folders to verify that the routes executed properly:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">In <span class="strong"><strong>Project Explorer</strong></span>, right-click <code class="literal">ZooOrderApp</code> and then select <span class="strong"><strong>Refresh</strong></span>.</li><li class="listitem"><p class="simpara">Expand the <code class="literal">target/messages/</code> folder.</p><p class="simpara">The <code class="literal">message*.xml</code> files should be dispersed in your the destinations as shown:</p><div class="figure"><a name="tutDualCBRTarget"></a><p class="title"><b>Figure&nbsp;1.&nbsp;Target message destinations in Project Explorer</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/tutDualCBRrteVerify.png" alt="message destinations"></div></div></div><br class="figure-break"></li></ol></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_next_steps_5"></a>Next steps</h2></div></div></div><p>In the next tutorial, <a class="xref" href="RiderTutorialDebug.html" title="Debugging a routing context"><i>Debugging a routing context</i></a>, you learn how to use the Fuse Tooling debugger.</p></div></div></body></html>
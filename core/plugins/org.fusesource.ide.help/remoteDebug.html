<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Debugging a remotely running routing context</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="ESB, Apache ServiceMix, Open Source, open source, integration, OSGi, enterprise service bus, Apache ServiceMix documentation, Apache Karaf, Red Hat JBoss Fuse, Red Hat JBoss Fuse documentation"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="startDebugger.html" title="Running the Camel Debugger"><link rel="prev" href="localDebug.html" title="Debugging a locally running routing context"><link rel="next" href="stopDebugger.html" title="Stopping the Camel Debugger"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="remoteDebug"></a>Debugging a remotely running routing context</h2></div></div></div><p></p><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8984"></a>Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Have access to a JBoss Fuse runtime </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Install a JBoss Fuse server on your local machine and edit its
                                            <code class="literal">[<em class="replaceable"><code>FUSE_HOME</code></em>]/etc/users.properties</code>
                                    file to activate the <code class="literal">admin</code> user. For details,
                                    see <a href="FIDEAddServer.html" class="olink">Adding a Server</a>.
                                </p></li><li class="listitem"><p>Have access to a JBoss Fuse server installed on a remote
                                    machine and know its connection details, including the
                                    credentials of the admin user.</p></li></ul></div></li><li class="listitem"><p>Create a New Fuse Integration project (for details, see <a href="RiderNewProject.html#nfpProjBasics" class="olink">Configuring project basics</a>)</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Select the Camel version that matches the version of the JBoss
                                    Fuse server runtime.</p></li><li class="listitem"><p>Create an empty Blueprint DSL project or use one of the 
                                        JBoss Fuse pre-defined templates with Blueprint DSL.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Though not a requirement, it is a good idea to verify that
                                        you can run the project's routing context successfully as a
                                            <span class="guimenuitem">Local Camel Context</span>. For
                                        details, see <a href="RiderRunningProfile.html" class="olink">Running routes as a local Camel context</a>. </p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The examples in <a class="xref" href="remoteDebug.html#setuoRemoteDebugging" title="Setting up and starting remote debugging">Setting up and starting remote debugging</a>
                                    are based on the <span class="guimenu">JBoss
                                        Fuse</span> &gt; <span class="guimenuitem">Content
                                            Based Router</span> pre-defined template and a Red Hat JBoss Fuse
                                        6.3.0 runtime. </p></td></tr></table></div></li></ul></div></li><li class="listitem"><p>In Red Hat JBoss Developer Studio, 
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Add the JBoss Fuse server to <span class="guilabel">Servers</span> view. For details, see
                        <a href="FIDEAddServer.html" class="olink">Adding a Server</a>.
                    </p></li><li class="listitem"><p>Start the JBoss Fuse server. For details, see <a href="FIDEStartServer.html" class="olink">Starting a Server</a>.</p></li><li class="listitem"><p>Publish your project to the JBoss Fuse Runtime server. For details, see <a href="FIDEDeployingContainer.html#autoPublish" class="olink">Publishing Fuse projects automatically when resources change</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You cannot deploy a Fuse Integration project to a JBoss Fuse server running on a remote host
                                        from inside JBoss Developer Studio. Instead, you deploy the
                                        project's bundle directly on the remote host using one of
                                        two supported deployment methods (for details, see <span class="phrase"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_fuse/6.3/html-single/deploying_into_apache_karaf/#DeployBundle" target="_top">Deploying an OSGi Bundle</a></span>).</p></td></tr></table></div></li><li class="listitem"><p>Verify that the project's bundle is deployed and active. For details, see
                        <a href="FIDEDeployingContainer.html#verifyPublished" class="olink">Verifying the project was published to the server</a>.</p></li><li class="listitem"><p>Stop the JBoss Fuse Runtime server. For details, see
                        <a href="FIDEStopServer.html" class="olink">Stopping a Server</a>.</p></li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="setuoRemoteDebugging"></a>Setting up and starting remote debugging</h3></div></div></div><p>With the project deployed on JBoss Fuse and the server stopped, you need to set up
            and start remote debugging, which consists of these tasks:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="listitem_flp_bvl_wz"></a>Start up JBoss Fuse in debug mode outside of JBoss Developer Studio</p></li><li class="listitem"><p>In JBoss Developer Studio set breakpoints on nodes in the project's routing context, open in
                        the route editor</p></li><li class="listitem"><p>Create a remote Camel context debug configuration and run it</p></li><li class="listitem"><p>Connect to JBoss Fuse runtime in JMX Navigator</p></li><li class="listitem"><p>Drop test messages in JMX Navigator on the input node of the Camel route running inside the
                        JBoss Fuse runtime</p></li><li class="listitem"><p>Use any of the Camel debugger's tools for debugging routes.</p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9103"></a>Procedure</h3></div></div></div><p>To set up and start remote debugging:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Open a terminal outside of JBoss Developer Studio, and enter
                        </p><pre class="programlisting">$ [FUSE_HOME]/bin/fuse debug</pre></li><li class="step"><p>Wait for the JBoss Fuse splash screen to appear, and then return to
                            <span class="guilabel">Fuse Integration</span> perspective in JBoss Developer
                        Studio.</p></li><li class="step"><p>In the project's routing context, open in the tooling's route editor, set
                        breakpoints on the nodes of interest. For details, see <a href="setBreakpoints.html" class="olink"><i>Setting Breakpoints</i></a>.</p></li><li class="step"><p>In <span class="guilabel">Project Explorer</span>, right-click the project's root and
                        select <span class="guisubmenu">Debug As</span> &gt; <span class="guimenuitem">Debug Configurations</span> to open the <span class="guilabel">Debug Configurations</span>
                        wizard:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/NewRemoteDBLaunchCnfg.png" width="378.40000000000003"></div></div></li><li class="step"><p>In the configuration type pane, select either <span class="guimenuitem">Remote Camel
                            Context</span> or <span class="guimenuitem">Remote Camel Context and
                            Java</span> , and then click <span class="inlinemediaobject"><img src="./images/NewRunConfigButton.jpg" align="middle" width="14.299999999999999" alt="New Configuration button"></span>:</p><div class="mediaobject"><img src="./images/CCJdbNewLaunchCnfg.png" width="405.34999999999997"></div><p>For both the <span class="guimenuitem">Remote Camel Context</span> and
                            <span class="guimenuitem">Remote Camel Context and Java</span> options, you
                        need to specify configuration details on the <span class="guilabel">Camel</span> and
                            <span class="guilabel">JMX</span> tabs.</p><p>For the <span class="guimenuitem">Remote Camel Context and Java</span> option
                        only, you also need to specify configuration details on the
                            <span class="guilabel">Connect</span> tab.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Unless your project contains Java code that you want to debug using the standard Eclipse Java
                            debugging tools, select the <span class="guimenuitem">Remote Camel
                                Context</span> option.</p></td></tr></table></div></li><li class="step"><p>Enter a name for the new launch configuration in the <span class="guibutton">Name</span> field.</p></li><li class="step"><p>On the <span class="guilabel">Camel</span> tab, click the
                            <span class="guibutton">Browse</span> button to locate the project's routing
                        context <code class="literal">.XML</code> file in the <span class="guilabel">Open
                            Resources</span> dialog: </p><div class="informalfigure"><div class="mediaobject"><img src="./images/CCdbSelCamelCntxt.png" width="297.05"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When you select a file in the <span class="guilabel">Matching items</span> pane, the tooling displays
                            the file's location relative to the project root, at the bottom of the
                            pane.</p></td></tr></table></div></li><li class="step"><p>In the <span class="guilabel">Matching items</span> pane, select your project's
                        routing context file from the list, and then click
                        <span class="guibutton">OK</span>.</p><p>The tooling inserts the file's path into the <span class="guilabel">Select Camel
                            Context</span> file field:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/CCJDbugCamelTabNew.png" width="323.05"></div></div></li><li class="step"><p>Click the <span class="guilabel">JMX</span> tab:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/RemoteDBJMXtabDefaults.png" width="312"></div></div><p>Edit the JMX connection details this way:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="guilabel">JMX Uri</span>&#8212;change
                                        <code class="literal">:9011/jmxrmi</code> to
                                        <code class="literal">:1099/karaf-root</code></p><p>If the JBoss Fuse server is running on a remote host, replace <code class="literal">localhost</code>
                                        with the DNS name or IP address of the remote host.</p></li><li class="listitem"><p><span class="guilabel">JMX User</span>&#8212;enter
                                            <strong class="userinput"><code><code class="literal">admin</code></code></strong></p></li><li class="listitem"><p><span class="guilabel">JMX Password</span>&#8212;enter
                                            <strong class="userinput"><code><code class="literal">admin</code></code></strong></p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="imagesdb/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>The values shown for <span class="guilabel">JMX User</span> and <span class="guilabel">JMX Password</span> are
                            the JBoss Fuse <span class="italic">admin</span> user defaults,
                            stored in the
                                <code class="literal">[<em class="replaceable"><code>FUSE_HOME</code></em>]/etc/users.properties</code>
                            file. If your setup is different, enter the values specific to it. </p></td></tr></table></div><p>If you are creating a <span class="italic">Remote Camel
                            Context</span> debug launch configuration, you are done. Skip to
                            <a class="xref" href="remoteDebug.html#debugCfgGo" title="Step 11">Step 11</a>.</p></li><li class="step"><p>Click the <span class="guilabel">Connect</span> tab:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/RemoteDBConnectTabDefaults.png" width="319.15000000000003"></div></div><p>Change the <span class="guilabel">Port</span> value from <code class="literal">8000</code> to
                                <strong class="userinput"><code><code class="literal">5005</code></code></strong>. Leave each of the
                        other properties as is.</p></li><li class="step"><a name="debugCfgGo"></a><p>Click <span class="guibutton">Apply</span> and then click <span class="guibutton">Debug</span>.</p></li><li class="step"><p>In <span class="guilabel">JMX Navigator</span>, double-click <code class="filename">JBoss Fuse
                            [xxx] [Disconnected]</code> to connect to it, and then expand its
                        tree:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/RemoteDBJBFCnctedJMX.png" width="174.85"></div></div></li><li class="step"><p>In <span class="guilabel">Project Explorer</span>, drag a test message from
                            <code class="filename">src/test/resources/data</code> and drop it on the
                            <code class="filename">cbr-example-context/Endpoints/file/work/cbr/input</code>
                        folder in <span class="guilabel">JMX Navigator</span>.</p><p>When the message hits the first breakpoint set in the routing context, the
                        tooling asks you to switch to <span class="guilabel">Debug</span> perspective:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/DBCnfrmSwitchToDBView.png" width="285.45000000000005"></div></div></li><li class="step"><p>Click <span class="guilabel">Yes</span>.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/RemoteDBPerspOpen.png" width="495"></div></div><p>At this point, you can use any of the Camel debugger's tools to debug your
                        routing context.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In remote debugging sessions, <span class="guilabel">Console</span> view does not display log
                            output.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When one message reaches the end of the routing context, the debugger is suspended. To
                            continue debugging, switch back to <span class="guilabel">Fuse Integration</span>
                            perspective and drop another message on the input node in <span class="guilabel">JMX
                                Navigator</span>. Each time you do so, the tooling asks you to
                            confirm the switch to <span class="guilabel">Debug</span> perspective.</p></td></tr></table></div></li></ol></div></div></div></body></html>
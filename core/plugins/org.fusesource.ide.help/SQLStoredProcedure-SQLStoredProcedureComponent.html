<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>SQL Stored Procedure Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="SQLComponent-SQLComponent.html" title="SQL Component"><link rel="next" href="SSH-SSH.html" title="SSH Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="SQLStoredProcedure-SQLStoredProcedureComponent"></a>SQL Stored Procedure Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="SQLStoredProcedure-SQLStoredProcedureComponent.html#SQLStoredProcedure-URIformat">URI format</a></span></dt><dt><span class="section"><a href="SQLStoredProcedure-SQLStoredProcedureComponent.html#SQLStoredProcedure-Options">Options</a></span></dt><dt><span class="section"><a href="SQLStoredProcedure-SQLStoredProcedureComponent.html#SQLStoredProcedure-Declaringthestoredproceduretemplate">Declaring the stored procedure template</a></span></dt><dt><span class="section"><a href="SQLStoredProcedure-SQLStoredProcedureComponent.html#SQLStoredProcedure-SeeAlso">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel 2.17</strong></span></p><p>The <span class="strong"><strong>sql-stored:</strong></span> component allows you to work with databases using JDBC
Stored Procedure queries. This component is an extension to
the&nbsp;<a class="link" href="sql-component.html" target="_top">SQL Component</a> but specialized for calling
stored procedures.</p><p>This component uses <code class="literal">spring-jdbc</code> behind the scenes for the actual SQL
handling.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-sql<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SQLStoredProcedure-URIformat"></a>URI format</h2></div></div></div><p>The SQL component uses the following endpoint URI notation:</p><pre class="programlisting">sql-stored:template[?options]</pre><p>Where template is the stored procedure template, where you declare the
name of the stored procedure and the IN and OUT arguments.&nbsp;</p><p>You can also refer to the template in a external file on the file system
or classpath such as:</p><pre class="programlisting">sql-stored:classpath:sql/myprocedure.sql[?options]</pre><p>Where sql/myprocedure.sql is a plain text file in the classpath with the
template, as show:</p><pre class="programlisting">SUBNUMBERS(
  INTEGER ${headers.num1},
  INTEGER ${headers.num2},
  OUT INTEGER resultofsub
)</pre><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SQLStoredProcedure-Options"></a>Options</h2></div></div></div><p>The SQL StoredProcedure component supports 1 options which are listed below.</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="11%" class="col_2"><col width="70%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>dataSource</p></td><td align="left" valign="top"><p><code class="literal">DataSource</code></p></td><td align="left" valign="top"><p>Sets the DataSource to use to communicate with the database.</p></td></tr></tbody></table></div><p>{% endraw %}</p><p>The SQL StoredProcedure component supports 8 endpoint options which are listed below:</p><p>{% raw %}</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="10%" class="col_2"><col width="11%" class="col_3"><col width="10%" class="col_4"><col width="50%" class="col_5"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Group</th><th align="left" valign="top">Default</th><th align="left" valign="top">Java Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>template</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> Sets the StoredProcedure template to perform</p></td></tr><tr><td align="left" valign="top"><p>batch</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Enables or disables batch mode</p></td></tr><tr><td align="left" valign="top"><p>dataSource</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">DataSource</code></p></td><td align="left" valign="top"><p>Sets the DataSource to use to communicate with the database.</p></td></tr><tr><td align="left" valign="top"><p>function</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether this call is for a function.</p></td></tr><tr><td align="left" valign="top"><p>noop</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>If set will ignore the results of the template and use the existing IN message as the OUT message for the continuation of processing</p></td></tr><tr><td align="left" valign="top"><p>outputHeader</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top">&nbsp;</td><td align="left" valign="top"><p><code class="literal">String</code></p></td><td align="left" valign="top"><p>Store the template result in a header instead of the message body. By default outputHeader == null and the template result is stored in the message body any existing content in the message body is discarded. If outputHeader is set the value is used as the name of the header to store the template result and the original message body is preserved.</p></td></tr><tr><td align="left" valign="top"><p>useMessageBodyForTemplate</p></td><td align="left" valign="top"><p>producer</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Whether to use the message body as the template and then headers for parameters. If this option is enabled then the template in the uri is not used.</p></td></tr><tr><td align="left" valign="top"><p>synchronous</p></td><td align="left" valign="top"><p>advanced</p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td><td align="left" valign="top"><p><code class="literal">boolean</code></p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used or Camel is allowed to use asynchronous processing (if supported).</p></td></tr></tbody></table></div><p>{% endraw %}</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SQLStoredProcedure-Declaringthestoredproceduretemplate"></a>Declaring the stored procedure template</h2></div></div></div><p>The template is declared using a syntax that would be similar to a Java
method signature. The name of the stored procedure, and then the
arguments enclosed in parenthesis. An example explains this well:</p><pre class="programlisting">&lt;to uri=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"sql-stored:SUBNUMBERS(INTEGER ${headers.num1},INTEGER ${headers.num2},OUT INTEGER resultofsub)"</em></strong>/&gt;</pre><p>The arguments is declared by a type and then the mapping to the Camel
message using simple expression. So in this example the first two
parameters are IN values that are INTEGER type, that maps to the message
headers. The last parameter is the OUT value, also an INTEGER type.</p><p>In SQL term the stored procedure could be declared as:</p><pre class="programlisting">CREATE PROCEDURE SUBNUMBERS(VALUE1 INTEGER, VALUE2 INTEGER,OUT RESULT INTEGER)</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SQLStoredProcedure-SeeAlso"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="configuring-camel.html" target="_top">Configuring Camel</a></li><li class="listitem"><a class="link" href="component.html" target="_top">Component</a></li><li class="listitem"><a class="link" href="endpoint.html" target="_top">Endpoint</a></li><li class="listitem"><a class="link" href="getting-started.html" target="_top">Getting Started</a></li><li class="listitem"><a class="link" href="sql-component.html" target="_top">SQL Component</a></li></ul></div></div></div></body></html>
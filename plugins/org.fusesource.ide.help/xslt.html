<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>XSLT</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><meta name="keywords" content="Apache Camel, Open Source, open source, Fuse, Red Hat, EIP, Enterprise Integration Patterns"><link rel="home" href="index.html" title="Red Hat JBoss Fuse Tooling for Eclipse"><link rel="up" href="RiderCompRef.html" title="Endpoint Reference"><link rel="prev" href="xquery.html" title="XQuery Endpoint"><link rel="copyright" href="tmdisclaim.html" title="Trademark Disclaimer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="xslt"></a>XSLT</h1></div></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_XSLT"></a>XSLT</h2></div></div></div><p>The <span class="bold"><strong>xslt:</strong></span> component allows you to process a message
            using an <a class="link" href="http://www.w3.org/TR/xslt" target="_top">XSLT</a> template. This can be
            ideal when using <a class="link" href="Templating" target="_top">Templating</a> to generate respopnses for
            requests.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_URIformat"></a>URI format</h2></div></div></div><pre class="programlisting">xslt:templateName[?options]</pre><p>Where <span class="bold"><strong>templateName</strong></span> is the classpath-local URI of the
            template to invoke; or the complete URL of the remote template. Refer to the <a class="link" href="http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/core/io/DefaultResourceLoader.html" target="_top">Spring Documentation for more detail of the URI syntax</a>
        </p><p>You can append query options to the URI in the following format,
                <code class="literal">?option=value&amp;option=value&amp;...</code>
        </p><p>Here are some example URIs:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th>URI </th><th>Description </th></tr></thead><tbody><tr><td>
                            <code class="code">xslt:com/acme/mytransform.xs</code>
                        </td><td> Refers to the file, <code class="code">com/acme/mytransform.xsl</code>, on the
                            classpath. </td></tr><tr><td>
                            <code class="code">xslt:file:///foo/bar.xs</code>
                        </td><td> Refers to the file, <code class="code">/foo/bar.xsl</code>.</td></tr><tr><td>
                            <code class="code">xslt:http://acme.com/cheese/foo.xsl</code>
                        </td><td> Refers to the remote HTTP resource.</td></tr></tbody></table></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_Options"></a>Options</h2></div></div></div><p><a class="xref" href="xslt.html#_IDU_XSLT_UriOpts" title="Table&nbsp;75.&nbsp;URI options">Table&nbsp;75</a> lists the XSLT uri options:</p><div class="table"><a name="_IDU_XSLT_UriOpts"></a><p class="title"><b>Table&nbsp;75.&nbsp;URI options</b></p><div class="table-contents"><table summary="URI options" width="100%" border="1"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th>Name </th><th>Default </th><th>Description </th></tr></thead><tbody><tr><td><code class="literal">converter</code></td><td><code class="literal">null</code></td><td>Option to override default <a class="link" href="http://camel.apache.org/maven/camel-core/apidocs/org/apache/camel/converter/jaxp/XmlConverter.html" target="_top">XmlConverter</a>. Will lookup for the converter in the Registry.
                            The provided converted must be of type
                            org.apache.camel.converter.jaxp.XmlConverter.</td></tr><tr><td><code class="literal">transformerFactory</code></td><td><code class="literal">null</code></td><td><span class="bold"><strong>New added in Apache Camel 1.6</strong></span> Option
                            to override default <a class="link" href="http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/TransformerFactory.html" target="_top">TransformerFactory</a>. Will lookup for the transformerFactory
                            in the Registry. The provided transformer factory must be of type
                                <code class="code">javax.xml.transform.TransformerFactory</code>.</td></tr><tr><td><code class="literal">transformerFactoryClass</code></td><td><code class="literal">null</code></td><td><span class="bold"><strong>New added in Apache Camel 1.6</strong></span> Option
                            to override default <a class="link" href="http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/TransformerFactory.html" target="_top">TransformerFactory</a>. Will create a
                                <code class="code">TransformerFactoryClass</code> instance and set it to the
                            converter.</td></tr><tr><td><code class="literal">uriResolver</code></td><td><code class="literal">null</code></td><td><span class="bold"><strong>Apache Camel 2.3</strong></span>: Allows you to use
                            a custom <code class="literal">javax.xml.transformation.URIResolver</code>. Camel
                            will by default use its own implementation
                                <code class="literal">org.apache.camel.builder.xml.XsltUriResolver</code>
                            which is capable of loading from classpath.</td></tr><tr><td><code class="literal">resultHandlerFactory</code></td><td><code class="literal">null</code></td><td><span class="bold"><strong>Apache Camel 2.3:</strong></span> Allows you to use
                            a custom
                                <code class="literal">org.apache.camel.builder.xml.ResultHandlerFactory</code>
                            which is capable of using custom
                                <code class="literal">org.apache.camel.builder.xml.ResultHandler</code>
                            types.</td></tr><tr><td><code class="literal">failOnNullBody</code></td><td><code class="literal">true</code></td><td><span class="bold"><strong>Apache Camel 2.3:</strong></span> Whether or not to
                            throw an exception if the input body is null.</td></tr><tr><td><code class="literal">output</code></td><td><code class="literal">string</code></td><td><span class="bold"><strong>Apache Camel 2.3:</strong></span> Option to specify
                            which output type to use. Possible values are: <code class="literal">string, bytes,
                                DOM, file</code>. The first three options are all in memory
                            based, where as <code class="literal">file</code> is streamed directly to a
                                <code class="literal">java.io.File</code>. For <code class="literal">file</code> you
                                <span class="bold"><strong>must</strong></span> specify the filename in the IN
                            header with the key <code class="literal">Exchange.XSLT_FILE_NAME</code> which is
                            also <code class="literal">CamelXsltFileName</code>. Also any paths leading to the
                            filename must be created beforehand, otherwise an exception is thrown at
                            runtime.</td></tr><tr><td><code class="literal">contentCache</code></td><td><code class="literal">true</code></td><td><span class="bold"><strong>Apache Camel 2.6:</strong></span> Cache for the
                            resource content (the stylesheet file) when it is loaded. If set to
                                <code class="literal">false</code> Camel will reloader the stylesheet file on
                            each message processing. This is good for development.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_UsingXSLTendpoints"></a>Using XSLT endpoints</h2></div></div></div><p>For example you could use something like</p><pre class="programlisting">from("activemq:My.Queue").
  to("xslt:com/acme/mytransform.xsl");</pre><p>To use an XSLT template to forumulate a response for a message for InOut message
            exchanges (where there is a <code class="literal">JMSReplyTo</code> header).</p><p>If you want to use InOnly and consume the message and send it to another destination
            you could use the following route:</p><pre class="programlisting">from("activemq:My.Queue").
  to("xslt:com/acme/mytransform.xsl").
  to("activemq:Another.Queue");</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_GettingParametersintotheXSLTtoworkwith"></a>Getting Parameters into the XSLT to work with</h2></div></div></div><p>By default, all headers are added as parameters which are available in the XSLT. To do
            this you will need to declare the parameter so it is then
            <span class="emphasis"><em>useable</em></span>.</p><pre class="programlisting">&lt;setHeader headerName="myParam"&gt;&lt;constant&gt;42&lt;/constant&gt;&lt;/setHeader&gt;
&lt;to uri="xslt:MyTransform.xsl"/&gt;</pre><p>And the XSLT just needs to declare it at the top level for it to be available:</p><pre class="programlisting">&lt;xsl: ...... &gt;

   &lt;xsl:param name="myParam"/&gt;
  
    &lt;xsl:template ...&gt;</pre></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_SpringXMLversions"></a>XML versions</h2></div></div></div><p>To use the above examples in XML you would use something like</p><pre class="programlisting">  &lt;camelContext xmlns="http://activemq.apache.org/camel/schema/spring"&gt;
    &lt;route&gt;
      &lt;from uri="activemq:My.Queue"/&gt;
      &lt;to uri="xslt:org/apache/camel/spring/processor/example.xsl"/&gt;
      &lt;to uri="activemq:Another.Queue"/&gt;
    &lt;/route&gt;
  &lt;/camelContext&gt;</pre><p>There is a <a class="link" href="http://svn.apache.org/repos/asf/camel/trunk/components/camel-spring/src/test/java/org/apache/camel/spring/processor/XsltTest.java" target="_top">test case</a> along with <a class="link" href="http://svn.apache.org/repos/asf/camel/trunk/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/XsltTest-context.xml" target="_top">its Spring XML</a> if you want a concrete example.</p></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_IDU_XSLT_HSH_Usingxslinclude"></a>Using xsl:include</h2></div></div></div><p></p><p><span class="bold"><strong>Apache Camel 1.6.2/2.2 or older</strong></span> If you use
            xsl:include in your XSL files then in Camel 2.2 or older it uses the default
                <code class="literal">javax.xml.transform.URIResolver</code> which means it can only lookup
            files from file system, and its does that relative from the JVM starting folder.</p><p>For example this include:</p><pre class="programlisting">&lt;xsl:include href="staff_template.xsl"/&gt;</pre><p>Will lookup the <code class="literal">staff_tempkalte.xsl</code> file from the starting folder
            where the application was started.</p><p><span class="bold"><strong>Apache Camel 1.6.3/2.3 or newer</strong></span> Now Camel provides
            its own implementation of <code class="literal">URIResolver</code> which allows Camel to load
            included files from the classpath and more intelligent than before.</p><p>For example this include:</p><pre class="programlisting">&lt;xsl:include href="staff_template.xsl"/&gt;</pre><p>Will now be located relative from the starting endpoint, which for example could
            be:</p><pre class="programlisting">.to("xslt:org/apache/camel/component/xslt/staff_include_relative.xsl")</pre><p>Which means Camel will locate the file in the <span class="bold"><strong>classpath</strong></span> as
                <code class="literal">org/apache/camel/component/xslt/staff_template.xsl</code>. This allows
            you to use xsl include and have xsl files located in the same folder such as we do in
            the example <code class="literal">org/apache/camel/component/xslt</code>.</p><p>You can use the following two prefixes <code class="literal">classpath:</code> or
                <code class="literal">file:</code> to instruct Camel to look either in classpath or file
            system. If you omit the prefix then Camel uses the prefix from the endpoint
            configuration. If that neither has one, then classpath is assumed.</p><p>You can also refer back in the paths such as</p><pre class="programlisting">    &lt;xsl:include href="../staff_other_template.xsl"/&gt;</pre><p>Which then will resolve the xsl file under
                <code class="literal">org/apache/camel/component</code>.</p></div></div></body></html>